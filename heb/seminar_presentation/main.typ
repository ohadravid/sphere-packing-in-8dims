

// Take a look at the file `template.typ` in the file panel
// to customize this template and discover how it works.

#import "template.typ": *

#show: project.with()

#show: slides.with(
  title: "אריזת כדורים במימד 8",
  subtitle: "סמינר במתמטיקה",
  date: "05.11.2024",
  authors: ("אוהד רביד", "מנחה: ד\"ר שוני גלבוע"),

  // Optional Styling
  ratio: 16/9,
  layout: "medium",
  title-color: green.darken(26%),
  footer: true,
  counter: false,
  
)

#set text(
  size: 14pt
)


// Remove the prefix before the equation number when referencing it.
#set ref(supplement: "")

#let CnE = [Cohn ו- Elkies]

#let Viaz = [Viazovska]

#let show-notes-slides = false;

#let speaker-notes-slide(mode: "typ", setting: it => it, note) = {
  if show-notes-slides {
    [
      == notes
      #note
    ]
  } else {
    none
  }
}

#speaker-notes-slide[
ריק
]


== בעיית אריזת הכדורים

אריזת כדורים
(Sphere Packing) 
היא בעיה גיאומטרית העוסקת בשאלה פשוטה לכאורה:


#align(center)[
מה היא הדרך היעילה ביותר למקם כדורים במרחב?
]

// wine: https://www.flickr.com/photos/webmoof/5082984598
// golf: https://www.pexels.com/photo/close-up-of-pyramid-of-golf-balls-15877131/

#grid(
  columns: (1fr, 1fr),
  [
    #align(center)[
      #image("golf.jpg", width: 80%)
    ]
  ],
  [
    #align(center)[
      #image("wine.jpg", width: 80%)
    ]
  ]
)


#speaker-notes-slide[

היי,

אני אוהד, אני לומד בפתוחה מאז 2018 והיום אני רוצה להציג את הסימנר שלי במתמטיקה בנושא אריזת כדורים במימד 8.

בעיית אריזת הכדורים היא בעיה גיאומטרית שנשמעת יחסית פשוטה: איך הכי טוב לסדר כדורים במרחב?

במקרה הדו מימדי והתלת מימדי הפתרון האינטואיטיבי הוא גם הנכון, ולמרות זאת קשה להוכיח שזה הוא הפתרון הטוב ביותר האפשרי.

היום, אני אציג את ההוכחה לפתרון במימד 8, שהוא אחד מבין שני המימדים הגבוהים היחידים שבהם התשובה ידועה.

]

= סְרִיגִים ואריזות


#speaker-notes-slide[

ריק
]

== הגדרות ראשונות


#let vol = math.op("vol", limits: true)
#let Pkg = math.cal([P])
#let Ball = $ B_r^n $
#let HalfBall = $ B_(r \/ 2)^n $

אנו נסמן ב-
$Ball(x)$
כדור סגור ברדיוס
$r$
שמרכזו ב-
$x$.

/ *_אריזת כדורים_ (_sphere packing_)*: #[
  תת קבוצה לא ריקה של
$RR^n$ 
של כדורים בעלי רדיוס שווה, שהפנימים שלהם זרים זה לזה
]

_הצפיפות העליונה_
(_upper density_)
של אריזה כלשהי
$Pkg$
היא 

$ limsup_(r->infinity) vol(Ball(0) sect Pkg) / vol(Ball(0)) $

כאשר אנו משתמשים במרחב האוקלידי הרגיל ו
$vol$
הינה מידת לבג.

#let spherepackingdensity = $Delta_(RR^n)$

_
צפיפות אריזת הכדורים ב-
$RR^n$
_
, אותה נסמן ב-
$spherepackingdensity$,
היא הסופרימום של כל הצפיפויות העליונות.#footnote[
הגדרה זו אינה מבטיחה כי צפיפות זו אכן מתקבלת על ידי אריזה כולשהי, אך ניתן להוכיח זאת
(Groemer, 1963).
]

/// #footnote[Groemer, Helmut. "Existenzsätze für Lagerungen im Euklidischen Raum" \ Mathematische Zeitschrift 81 (1963): 260-278. http://eudml.org/doc/170152].

#speaker-notes-slide[

המושג הראשון שאנחנו צריכים להגדיר הוא אריזה של כדורים,
שהיא קבוצה לא ריקה של כדורים בעלי רדיוס שווה בעלי פנימים זרים.

כדי למדוד את הצפיפות העליונה של אריזה, אנחנו לוקחים כדור ברדיוס הולך וגדל,
ומסתכלים על הגבול (העליון) של היחס בין הנפח של כדורי האריזה בחיתוך הכדור.
לנפח הכדור,

אנחנו רוצים לדעת מה היא הצפיפות הגבוהה ביותר האפשרית במימד מסויים, שמסומנת
DELTA-R-N.
]

== סְרִיגִים ואריזות מחזוריות

#import "./packings_figures.typ": p1, p2, p1withsquares

/ *
סָרִיג
(_lattice_)*: #[
 תת חבורה מדרגה
$n$
המורכבת מבסיס של
$RR^n$
בתוספת כל צירוף לינארי בעל מקדמים שלמים שלו
]

#speaker-note[
(לצירוף כזה נקרא גם _צירוף אינטגרלי_, ולבסיס נקרא _בסיס אינטגרלי_).
]

אם 
$B$
הוא בסיס מסוים של 
$RR^n$,
אז הסריג
$Lambda$
ניתן להצגה בצורה הבאה:

$ Lambda := {a_1 v_1 + ... + a_n v_n | a_i in ZZ , v_i in B} $


/ *
אריזת כדורים _מחזורית_
(_periodic_)*: #[
  אריזת כדורים שקיים עבורה סריג
$Lambda$
כך שהיא
נשמרת תחת הזזה בכל איבר של הסריג

$ Pkg = Pkg + v,  forall v in Lambda $
]


#speaker-notes-slide[

אריזות כלליות יכולות להיות מורכבות מאוד, ולכן אנחנו נתמקד בכמה סוגים פשוטים יותר.

סריג, הוא תת חבורה מדרגה
N
שמורכב מבסיס של המרחב, יחד עם כל צירוף לינארי _בעל מקדמים שלמים_ של הבסיס.

באמצעות סריגים, אפשר להגדיר שני סוגים של אריזות: אריזות _מחזוריות_, שהן אריזות שנשמרות תחת הזזה בסריג, ואריזות סריג (קליק)
]

==

/ *
_אריזת סריג_ (_lattice packing_)*: #[
אריזה מחזורית בה כל מרכזי הכדורים נמצאים על סריג, עד כדי הזזה 

$ Pkg = Lambda + x_0, x_0 in RR^n $
]

#let packs-examples = [

ניקח את הבסיס
$B = {(0,4), (4,0)}$.
נקבל את הסריג
$Lambda = {(4n, 4m) | n,m in ZZ}$.

אז
$Pkg_1 = {B^2_(1\/2)(x) | x in Lambda}$
היא אריזת סריג, בעוד ש-
\
$Pkg_2 = {B^2_(1\/2)(x) | x in Lambda union (Lambda + (1,1))}$
הינה אריזה מחזורית שאינה אריזת סריג. 
]

#grid(
  columns: (2fr, 1fr,  1fr),
  [
    #packs-examples
  ],
  [
    #align(left + horizon)[#p1]
  ],
  [
    #align(left + horizon)[#p2]
  ]
)





#speaker-notes-slide[

[אריזות סריג (קליק)]
שהן אריזות בהן כל מרכזי הכדורים נמצאים ממש על סריג (עד כדי הזזה).

אם ניקח למשל בסיס עם הווקטורים אפס-ארבע וארבע-אפס, נקבל את הסריג הכולל כל ווקטור ששתי הקורדינאטות שלו מתחלקות ב4, ואם נמקם כדור ברדיוס 1 בקצה של כל ווקטור כזה, נקבל אריזת סריג.

אריזות מחזוריות הן מקרה כללי יותר, ולמשל P שלוש כאן היא אריזה מחזורית אבל לא אריזת סריג.
]

== צפיפות של אריזת סריג


#grid(
  columns: (2fr, 1fr),
  [
    

נחשוב על הסריג כריצוף של המרחב באמצעות מקבילונים.


_התא היסודי_ (_fundamental cell_)
של אריזת כדורים המבוססת על סריג
$Lambda$
שהבסיס שלו הוא
$B$
ניתן להצגה כך:

$ C := {x_1 v_1 + ... + x_n v_n | 0 <= x_i <= 1 , v_i in B} $

הזזות של התא היסודי באמצעות איברים של
$Lambda$
מרצפת את המרחב, ואריזת הסריג הינה מיקום של כדורים בכל צומת של ריצוף זה.
  ],
  [

    #align(left + horizon)[#p1withsquares]
  ],
)

מכיוון שבמרחב ישנו כדור אחד לכל עותק של התא, הצפיפות מתקבלת על ידי
$vol(Ball) \/ vol(C)$.
נשתמש בכך ש-
$vol(C) = vol(RR^n \/ Lambda)$,
ונקבל שהצפיפות של אריזת סריג היא:

$ vol(Ball) / vol(RR^n \/ Lambda) $ <packing-vol>

#speaker-notes-slide[

אחד היתרונות של אריזות סריג הוא שקל יחסית לחשב את הצפיפות שלהן.

אנחנו יכולים לחשוב על הסריג כריצוף של המרחב במקבילונים שנקראים "התא היסודי" של האריזה, שהוא שהמקבילון שמתקבל על ידי הבסיס.

יש לנו כדור אחד לכל עותק של התא, ולכן נוכל לקבל כי הצפיפות של האריזה היא היחס בין נפח כדור ברדיוס המתאים, לבין הנפח של התא.

נפח התא שווה לנפח של המנה של המרחב והסריג,
ולכן נקבל שהצפיפות של אריזה שווה ל:

נפח הכדור ברדיוס R,
חלקי נפח המנה.

]

== הגדרה ותכונות בסיסיות של $E_8$

אנו נעסוק באריזה
$E_8$,
שהיא אריזת כדורים במימד
$RR^8$.
נציג את הסריג עליו היא מבוססת,
$Lambda_8$:

$ Lambda_8 = { (x_1, ... , x_8) in ZZ^8 union (ZZ + 1/2)^8 mid(|) sum^8_(i=1)x_i equiv 0 (mod 2) } $


$Lambda_8$
הוא _סריג אינטגרלי_
(_integral lattice_),
כלומר כל המכפלות הפנימיות בין אברי הבסיס שלו שלמות.
\
$Lambda_8$
הוא _סריג זוגי_
(_even lattice_),
כלומר ריבוע האורך של כל ווקטור בו הוא שלם וזוגי.
\
בפרט, המרחק בין כל שתי נקודות ב-
$Lambda_8$
הוא מהצורה
$sqrt(2k)$, 
ובין שתי נקודות סמוכות
הוא
$sqrt(2)$.

נבחר אריזת סריג בעלת
$r=sqrt(2) / 2$,
אותה נסמן ב-
$E_8$.
הצפיפות המתקבלת היא:

$ vol(RR^8 \/ Lambda_8) = 1, #h(3em) vol(B^8_(sqrt(2) \/ 2)) / vol(RR^8 \/ Lambda_8) =  pi^4 / 384 = 0.2538 ...  $


#speaker-notes-slide[

אנחנו נעסוק באריזה שנקראת
E8.
היא מבוססת על הסריג
LAMBDA-8, המגודר כך:

כלומר, הסריג שמכיל את כל הווקטורים שכל מקדמיהם שלמים או שכל מקדמיהם נבדלים בחצי משלם, ושסכומם זוגי.

ללאמבדה-8 יש כמה תכונות מעניינות:
הוא אינטגרלי, זוגי, והמרחק בין כל שתי נקודות סמוכות בו הוא
$sqrt(2)$.


זה אומר שנוכל לבנות מעליו אריזת סריג של כדורים ברדיוס
$sqrt(2)$
חלקי-2, וזו
$E_8$.


ניתן לחשב את נפח המנה של המרחב והסריג, ולקבל כי היא שווה 1.
כלומר, הצפיפות של 
$E_8$
היא

$  pi^4 / 384 = 0.2538 ...  $

]

== הדואליות של $Lambda_8$

אנו זקוקים לתכונה אחת נוספת של
$Lambda_8$:
הוא _הסריג הדואלי_
של עצמו.


עבור סריג
$Lambda$
בעל בסיס מסוים
${ v_1, ..., v_n }$
נגדיר:

/ *
_הסריג הדואלי_
(_dual lattice_)
של
$Lambda$
*: #[
הסריג בעל הבסיס
${ v^*_1, ..., v^*_n }$
כך ש- 
$
angle.l v_i, v^*_j angle.r = cases(
  1 "if" i = j "," "and",
  0 "otherwise"
)
$
]

את הסריג הדואלי נסמן ב-
$Lambda^*$,
ואם
$Lambda = Lambda^*$
אז נאמר ש
$Lambda$
הוא הסריג הדואלי של עצמו.


#speaker-notes-slide[

יש עוד תכונה אחת שאנחנו צריכים: ש
$Lambda_8$
יהיה הדואלי של עצמו.

הסריג הדואלי הוא הסריג בעל הבסיס 
V1-סטאר, V2-סאטר, 
וכו,

כך שהמכפלות הן 1 כאשר האינדקסים שווים, ו0 אחרת.

בדומה לדרך בה מגדירים מרחב דואלי.

וכמובן,
אם
$Lambda = Lambda^*$
אז נאמר ש
$Lambda$
הוא הסריג הדואלי של עצמו.
]

= שימוש באנליזה הרמונית \ למציאת חסמים לצפיפות <harmonic-analysis-and-enc>



#speaker-notes-slide[

ריק
]

== 

אם נוכל להוכיח כי הצפיפות הגבוהה ביותר האפשרית ב
$RR^8$
שווה לצפיפות של
$E_8$,
הרי שבכך נוכיח כי היא אריזה אופטימאלית במימד זה.

בעיה זו מקבלת מענה בעבודתם של 
$CnE$,
שהוכיחו כי ניתן להשתמש בפונקציות עזר בעלות תכונות מסוימות, אותן נפרט מיד, כדי לחסום את הצפיפות המירבית האפשרית במימד מסוים.

התובנה העיקרית נמצאת בקשר הקיים בין פונקציה והתמרת פורייה שלה, באמצעות #[_נוסחת הסכימה של פואסון_].


#speaker-notes-slide[

כוהן ואלקיס

מה שאנחנו רוצים לעשות זה להוכיח שהצפיפות הגבוהה ביותר ב
R8
שווה לצפיפות של 
E8,

וככה להוכיח שהיא (אחת מ-) האריזות האופטימלאיות במרחב זה.

הדרך להוכיח זאת מתבססת על תוצאה של כוהן ואלקיס, שאומרת שאם ישנה פונקציית עזר בעלת תכונות מסויימות, ניתן להשתמש בה כדי לחסום את הצפיפות.

התוצאה מתבססת על הקשר בין פונקציה והתמרת פורייה שלה, באמצעות נוסחת הסכימה של פאסון.
]

== פונקציות שוורץ

אנו נעסוק בפונקציות מ-
$RR^n$
ל-
$RR$
(ולעתים בפונקציות מרוכבות של משתנה ממשי).

#let Sw = $cal(S)(RR^n)$

/ * _פונקציות שוורץ_
(_Schwartz functions_) - $Sw$ *: #[
כל הפונקציות הניתנות לגזירה אינסוף פעמים, ושמקיימות

$ sup_(x in RR^n) lr(| x^beta (diff / (diff x) )^alpha f(x) |) < infinity $

לכל
$alpha,beta in NN$,
כאשר
$(diff / (diff x) )^alpha$ היא סדרה של
$alpha$
גזירות חלקיות (לפי סדרה כולשהי של משתנים).
]
כלומר, קבוצת הפונקציות הזו הינה מרחב הפונקציות שערכן, והערך של כל נגזרת שלהן, \ פוחת "מהר מאוד", כלומר מהר יותר מכל פולינום.

#speaker-note[  
התוצאות שנוכיח מתקיימות גם בתנאים מחמירים פחות, אך בכך שנגביל את עצמנו לעיסוק בפונקציות שוורץ נוכל להימנע מקשיים טכנים רבים,
ומכיוון שההוכחה של #Viaz, בה יעסקו הפרקים הבאים, הינה בנייה של פונקציות שוורץ - תוצאות אלו יספיקו לנו בהחלט.
]


#speaker-notes-slide[

אנחנו נתמקד במשפחה של פונקצייות הנקראות פונקציות שוורץ.

אלו הן כל הפונקציות, הניתנות לגזירה אינסוף פעמים, ושערכן, והערך של כל נגזרת שלהן, פוחת "מהר מאוד", כלומר מהר יותר מכל פולינום.

התוצאות שנוכיח מתקיימות גם בתנאים מחמירים פחות, אבל פונקציות שוורץ יעזרו לנו להימנע מקשיים טכנים רבים,
ומכיוון שההוכחה של
#Viaz,
הינה בנייה של פונקציות שוורץ - תוצאות אלו יספיקו לנו בהחלט.
]

== התמרת פורייה ב- $RR^n$ של פונקציות שוורץ

נגדיר את התמרת פורייה של פונקציית שוורץ
$f$
כך:

$ hat(f)(xi) = integral_(RR^n) f(x) e^(-2pi i x dot xi) dif x , "for" xi in RR^n $

#speaker-note[  
אנו מבצעים אינטגרציה על המרחב כולו, כאשר
$x dot xi$
מסמן את המכפלה הפנימית בין שני הווקטורים.
]

אנו נשתמש גם בסימון המקובל
$f(x) -> g(xi)$
כדי לציין ש-
$g$
היא התמרת פורייה של
$f$.

#speaker-note[
  // TODO: לדבר באופן כללי?
תהי
$f in Sw$, אז

1. $f(x + h) -> hat(f)(xi)e^(2pi i xi dot h)$ כאשר $h in RR^n$.
2. $f(x) e^(-2pi i x dot h) -> hat(f)(xi + h)$ כאשר $h in RR^n$.
3. $f(delta x) -> delta^(-n) hat(f)(delta^(-1) xi)$ כאשר $delta > 0$.
4. $(diff / (diff x) )^alpha f(x) -> (2pi i xi)^alpha hat(f)(xi)$.
5. $(-2pi i x)^alpha f(x) ->  (diff / (diff xi) )^alpha hat(f)(xi)$.
]

עבור פונקציות שוורץ מתקיימת גם  _התמרת פורייה ההפוכה_:

$ f(x) = integral_(RR^n) hat(f)(xi) e^(2pi i x dot xi) dif xi $ <fourier-inversion-formula>



#speaker-notes-slide[

התמרת פורייה של פונקציות שוורץ במימד
N
מוגדרת כך:
 
אנו מבצעים אינטגרציה על המרחב כולו, כאשר
$x dot xi$
(איקס דוט קסיי)
מסמן את המכפלה הפנימית בין שני הווקטורים.

עבור פונקצייות שוורץ, מתקיימת גם התמרת פרוייה ההפוכה, שמאפשרת לנו "לשחזר" את הפונקציה באמצעות ההתמרה שלה.
]

==

/ *פונקציה
_רַדְיָאלִית_
(_radial_)*: #[
פונקציה התלויה אך ורק ב
$|x|$
]

תכונה חשובה של פונקציות רדיאליות היא שהן מקיימות 
$hat(hat(f)) = f$:

#speaker-note[  
כפי שנובע מהתמרת פורייה ההפוכה
]

$ 
hat(hat(f))(y) &= integral_(RR^n) hat(f)(xi) e^(-2pi i xi dot y) dif xi \
&= integral_(RR^n) hat(f)(xi) e^(2pi i xi dot (-y)) dif xi \
&= f(-y) \
&= f_0(|-y|)
&= f(y)
$


#speaker-notes-slide[

מכיוון שבעיית הצפיפות הינה בעלת סימטריה סיבובית, נרצה לעיתים לעבוד עם פונקציות רדיאליות, שהן פונקציות התלויות אך ורק באורך הווקטור.

אחת התכונות שלהן היא שהפעלה של התמרת פורייה פעמיים נותנת לנו חזרה את הפונקציה איתה התחלנו.

קל לראות את זה אם נכתוב במפורש את התמרת פורייה הכפולה: 

נקבל את האינטגרל על המרחב כולו של 
F
האט (כובע), ואם נזיז את סימן המינוס לגורם 
Y
בחזקה ונשתמש בהתמרת פרוייה ההפוכה, נקבל את
$f(-y)$,
אבל כמובן שלמינוס
Y
וY
יש את אותו האורך, ולכן נקבל חזרה את
FY.
]

== נוסחת הסכימה של פואסון

כדי שנוכל להפעיל כלים מתחום האנליזה על בעיית הצפיפות, נשתמש בנוסחת הסכימה של פואסון
(_Poisson Summation Formula_).

#speaker-note[
נוסחה זו מביעה את הדואליות שבין סכימת ערכים של פונקציה על סריג, לסכימה של התמרת פורייה שלה על הסריג הדואלי.
]

נוכיח למקרה החד מימדי.
_נוסחת הסכימה של פואסון עבור
$RR$_
אומרת כי לכל
$f in cal(S)(RR)$:

$ sum_(n=-infinity)^(infinity) f(n) = sum_(n=-infinity)^(infinity) hat(f)(n) $ <poisson-sum-for-r>

#speaker-note[
  לסכום את הפונקציה על כל השלמים זה בדיוק כמו לסכום את התמרת פורייה שלה על כל השלמים
]

אנו יודעים כי שתי פונקציות זהות אם פיתוח פורייה שלהן זהה.

נגדיר שתי פונקציות 1-מחזוריות, נמצא את המקדמים של פיתוחי פורייה שלהן, וכך נראה כי הן זהות.


#speaker-notes-slide[

כדי שנוכל להפעיל כלים מתחום האנליזה על בעיית הצפיפות, נשתמש בנוסחת הסכימה של פואסון

נתחיל בלהוכיח את המקרה החד מימדי. 

נוסחת הסכימה של פאסון אומרת שאם יש לנו פונקציה
F,
אז
לסכום את הפונקציה על כל השלמים, זה בדיוק כמו לסכום את התמרת פורייה שלה על כל השלמים.

אפשר לחשוב על השלמים בתור סריג פשוט במיוחד בR.

אנחנו נגדיר שתי פונקציות 1-מחזוריות, ונוכיח כי הן שוות באמצעות השוואה של המקדמים של פיתוחי פרוייה שלהן.
]

==
ראשית:
$ F_1(x) := sum_(n=-infinity)^(infinity) f(x+n) $

$F_1$
היא 1-מחזורית,
ומכיוון ש-
$f$
פוחתת מהר מאוד (במובן שהגדרנו עבור פונקציות שוורץ),
הסדרה מתכנסת בהחלט על הישר ולכן 
$F_1$
רציפה.


באמצעות פיתוח פורייה נוכל להגיע לפונקציה נוספת, שגם היא 1-מחזורית:

$ F_2(x) := sum_(n=-infinity)^(infinity) hat(f)(n) e^(2 pi i n x)  $

נוכל לחשוב על 
$F_2$
בתור הגרסה הדיסקרטית של
$f(x) = integral_(-infinity)^infinity hat(f)(xi) e^(2pi i x dot xi) dif xi$



#speaker-notes-slide[

הפונקציה הראשונה שלנו,
F1,
תהיה הסכום ממינוס אינסוף לאינסוף של
F
של
X+N.

היא 1-מחזורית, ומכיוון ש
f פוחתת מהר מאוד במובן שהגדרנו עבור פונקצייות שוורץ, יש לנו סדרה מתכנסת בהחלט על הישר ו
F1
רציפה.

את הפונקציה השניה שלנו נקבל בהשראת פיתוח פורייה: ניקח שוב את הסכום ממינוס אינסוף לאינסוף, והפעם נסכום את
F-
האט על 
N,
ונכפול ב

$ e^(2 pi i n x) $

אי(E) בחזקת שתי פאי איי(I) אן(N) איקס(X)

אפשר לחשוב על
F2
בתור הגרסה הדסקרטית של התמרת פורייה ההפוכה,
כאשר אנחנו מחליפים את האינטגרציה על הישר בסכום האינסופי.

גם פה, ברור שהיא 1 מחזורית.
]

==


עבור
$F_2(x) = sum_(n=-infinity)^(infinity) hat(f)(n) e^(2 pi i n x)$,
המקדם ה-$m$י הוא בדיוק
$hat(f)(m)$.
\
עבור $F_1(x) = sum_(n=-infinity)^(infinity) f(x+n)$, מתקיים:

$ 
a_m &= integral_0^1 (sum_(n=-infinity)^(infinity) f(x+n)) e^(-2 pi i m x) dif x \
    &= sum_(n=-infinity)^(infinity) integral_0^1  f(x+n) e^(-2 pi i m x) dif x \
// (y-n) => e^-2pi*i*mn = 1
    &= sum_(n=-infinity)^(infinity) integral_n^(n+1) f(y) e^(-2 pi i m y) dif y \
    &= integral_(-infinity)^infinity f(y) e^(-2pi i m y) dif y 
    &= hat(f) (m)
$


#speaker-notes-slide[

אז אמרנו שאנחנו רוצים להראות שהמקדמים של פיתוח פורייה שלהן שווים.

עבור
F2
המקדם ה
Mי
הוא בדיוק
f-האט של M,
ועבור
F1
אנחנו יכולים לפתח:

המקדם ה
M
הוא האינטגרל מ0  עד 1 של הפונקציה כפול אי-בחזקת-מינוס..

אפשר להחליף את סדר הסכימה והאינטגרציה כי
f
פונקציית שוורץ.

אחרי זה, אפשר לבצע החלפת משתנים כדי לקבל את כל פעם את האינטגרל מN
לN+1,
ואז להפוך את הסכום האינסופי והאיטגרל לאינטגרל על הישר כולו, ונקבל בדיוק את את הביטוי לערך של התמרת פורייה ב-
M,
כפי שרצינו
]

==

כאשר החלפת סדר הסכימה והאינטגרציה מותרת כי
$f in cal(S)$.

נסיק כי אכן
$F_1 = F_2$,
ואת התוצאה הסופית נקבל אם נציב
$x=0$.


נוכל להכליל את התוצאה למימד
$n$
ולקבל:

$ sum_(x in ZZ^n) f(x) = sum_(x in ZZ^n) hat(f)(x) $ <poisson-sum-for-r-n>



#speaker-notes-slide[

נסיק כי אכן
$F_1 = F_2$,
ואת התוצאה הסופית נקבל אם נציב
$x=0$.

כמו שאמרנו שהשלמים הם סריג פשוט ב
R,
אפשר להכליל את התוצאה לסריג
Z^N.

אבל מה לגבי סריגים כללים?
]

==

כדי להרחיב את התוצאה עבור סריגים כלליים, נסמן ב-
$M: Z^n -> RR^n$
את ההעתקה הלינארית ביחס לבסיס
$B = {v_1, ... , v_n}$
של
$Lambda$.
אז
$M$
היא מטריצה שעמודותיה הם ווקטורי הבסיס,
ו-
$Lambda = M ZZ^n$.

אז
$ sum_(x in Lambda) f(x) = sum_(x in ZZ^n) f(M x) $


נסמן
$g(x)=f(M x)$
ומהנוסחה נקבל כי
$hat(g)(xi) = integral_(RR^n) f(M x) e^(-2pi i xi dot x) dif x$.

באמצעות מעט מניפולציות אלגבריות נקבל כי
$
hat(g)(xi) &= 1/vol(RR^n \/ Lambda) integral_(RR^n) f(u) e^(-2pi i (M^(-1))^T xi dot u) dif u = 1/vol(RR^n \/ Lambda) hat(f)((M^(-1))^T xi)
$


#speaker-notes-slide[

נסמן ב-
M
את ההעתקה הלינארית מ
ZN
לRN
($M: Z^n -> RR^n$),
ביחס לבסיס
של
$Lambda$.

אז
$M$
היא מטריצה שעמודותיה הם ווקטורי הבסיס,
ו-
LAMBDA
הוא
כפל משמאל של
M
ב
ZN
.

($Lambda = M ZZ^n$)

זה אומר שאנחנו יכולים לכתוב את הסכום השמאלי בתור סכום על
ZN
וכפל במטריצה.

נסמן
ב
G
את
F
של
MX,
ונקבל את התמרת פורייה שלה לפי הנוסחה.

אפשר להחליף משתנים באינטגרל ולהשתמש בתכונות המכפלה הפנימית כדי להביע את
G-האט
באמצעות
F-האט.
]

==

נציב חזרה ונקבל כי

$ sum_(x in Lambda) f(x)  = sum_(x in ZZ^n) f(M x) 
= 
sum_(xi in ZZ^n) hat(g)(xi) = 1 / vol(RR^n \/ Lambda) sum_(xi in ZZ^n) hat(f)((M^(-1))^T xi) $

נסמן ב-
$D$
את הבסיס של הסריג הדואלי
$Lambda^*$.
ישירות מההגדרה נקבל כי
$M^T D = I$,
\
אז
$D = (M^T)^(-1)$ 
ולכן
$Lambda^* = D ZZ^n = (M^T)^(-1) ZZ^n$.
כלומר:

#let filled-block(body) = {
  [#align(center)[
    #block(
      fill: luma(230),
      inset: 8pt,
      radius: 4pt,
      [
        #body
      ]
    )
  ]]
}

#filled-block[
  $ sum_(x in Lambda) f(x) = 1 / vol(RR^n \/ Lambda) sum_(y in Lambda^*) hat(f)(y) $
]

וזו היא נוסחת הסכימה של פואסון לסריגים ב-
$RR^n$.



#speaker-notes-slide[

נשתמש בנוסחת הסכימה ונציב חזרה.

עכשיו נוכל להיעזר בתכונות הסריג הדואלי. 
אם נסמן את הבסיס שלו ב
D,
אז לפי ההגדרה,
התטראנפוז של
M
כפול
D
ייתן לנו בדיוק את
I.

אז
D
שווה ל
M
T
מינוס1,
($D = (M^T)^(-1)$ )

ולכן
LAMBDA STAR, ששווה ל
D-Z-N, שווה ל
MT-מינוס1
כפול
ZN.

($Lambda^* = D ZZ^n = (M^T)^(-1) ZZ^n$)

ולכן סכימה של
F
על הסריג
היא כמו סכימה של
F-האט
על הסריג הדואלי (עד כדי כפל בקבוע),
וזו נוסחת הסכימה של פואסון לסריגים בRN.
]

== חסמים המתקבלים מתכנון לינארי <lin-bounds>

המשפט המרכזי בעבודתם של
$CnE$:

*תהי*
$f in  Sw$
ויהי מספר ממשי
$0 <r in RR$,
כך ש:

1. $f(0) = hat(f)(0) > 0$
2. $hat(f)(y) >= 0$ לכל $y in RR^n$
3. $f(x) <= 0$ לכל $|x| >= r$

*אז*
הצפיפות המרבית ב-
$RR^n$
היא לכל היותר
$vol(HalfBall)$.

נוכיח את הטענה תחילה עבור אריזות סריג, ולאחר מכן נרחיב את התוצאה לאריזות כלליות.


#speaker-notes-slide[

עכשיו, אנחנו מוכנים להוכיח את המשפט המרכזי של כוהן ואלקיס.

תהי
F
פונקציית שוורץ, ומספר ממשי חיובי
R,
ככה ש:

1 בראשית, הפונקציה שווה להתמרת פורייה שלה, והן חיוביות


2 התמרת פרוייה שלה אי-שלילית בכל המרחב

3 F 
עצמה קטנה או שווה ל0 לכל
X
מחוץ לרדיוס
R
סביב הראשית.

אם ישנה פונקציה כזאת, אז הצפיפות המירבית הינה לכל היותר כמו נפח הכדור ברדיוס
Rחלקי2.

נוכיח את הטענה תחילה עבור אריזות סריג, ולאחר מכן נרחיב את התוצאה לאריזות כלליות.
]

==

#counter(footnote).update(0)


יהי
$Lambda$
סריג ב-
$RR^n$.

ללא הגבלת הכלליות נניח כי
$Lambda$
בעל אורך ווקטור מינימאלי
$r$
#footnote()[
צפיפות אריזת הסריג תישאר זהה אם נרחיב או נכווץ את הסריג (ואיתו את אורך הווקטור המינימאלי) בסקלר.
].

אז ישנה אריזת סריג המבוססת עליו ומורכבת מכדורים ברדיוס
$r\/2$
ובעלת צפיפות

$ vol(HalfBall) / vol(RR^n \/ Lambda) $

כלומר, אנו צריכים להוכיח כי
$vol(RR^n \/ Lambda) >= 1$.

 #speaker-notes-slide[

יהי
$Lambda$
סריג ב-
$RR^n$,
וללא הגבלת הכלליות נניח שהוא
בעל אורך ווקטור מינימאלי
$r$

אז ישנה אריזת סריג המבוססת עליו ומורכבת מכדורים ברדיוס
$r\/2$
ובעלת צפיפות
השווה לנפח כדור ברדיוס
Rחלקי2,
חלקי נפח המנה של המרחב בסריג.

$ vol(HalfBall) / vol(RR^n \/ Lambda) $

כלומר, אנו צריכים להוכיח שהנפח הזה גדול או שווה ל1.
]

==

ע"פ נוסחת הסכימה של פואסון,
$ sum_(x in Lambda) f(x) = 1 / vol(RR^n \/ Lambda) sum_(y in Lambda^*) hat(f)(y)$


#let left-sum = [
ואם נביע את הסכום השמאלי כך

$ sum_(x in Lambda) f(x) = f(0) + sum_(x in Lambda , x != 0) f(x) $

דרשנו כי
$f(0) > 0$
ו-
$f(x) <= 0$ לכל $|x| >= r$
(ובפרט לכל
  $x in Lambda, x != 0$). אז נקבל:

$ sum_(x in Lambda) f(x) <= f(0)   $

#speaker-note[
משילוב דרישות (1) ו- (3)
השתמשנו באורך הווקטור המינימאלי
]
]

#let right-sum = [
עבור הסכום הימני,

$ hat(f)(0) <= sum_(y in Lambda^*) hat(f)(y) $

ולכן

$ (hat(f)(0)) / vol(RR^n \/ Lambda) <=  1 / vol(RR^n \/ Lambda) sum_(y in Lambda^*) hat(f)(y) $
]

#grid(
  gutter: 1em,
  columns: (1fr, 1fr),
  [
    #block(inset: 1em)[
      #right-sum
    ]
  ],
  grid.vline(stroke: black),
  [
    #block(inset: 1em)[
      #left-sum
    ]
  ]
)


 #speaker-notes-slide[

נתחיל מנוסחת הסכימה של פואסון.

אם נסתכל על הסכום הימני, דרשנו ש
F-האט-0
תהיה חיובית, ודרשנו שהיא תקבל רק ערכים אי-שלילים בכל המרחב ובפרט על הסריג הדואלי. אז בוודאי שהסכום שלה על כל הסריג הדואלי גדול או שווה ל
F-האט-0.

את הסכום השמאלי נוכל לפרק ל
F-0
והסכום שלה על כל שאר הנקודות בסריג.

אנחנו יודעים ש
F-0 חיובית, ואנחנו יודעים ש
F
שלילית או 0 לכל
X אחר על הסריג, כי
R
הוא אורך הווקטור המינימאלי בו, אז וודאי שהסכום שלה על הסריג כולו קטן או שווה ל
F-0.

]

==

נקבל כי


$ f(0) >= sum_(x in Lambda) f(x) = 1 / vol(RR^n \/ Lambda) sum_(y in Lambda^*) hat(f)(y) >= (hat(f)(0)) / vol(RR^n \/ Lambda) $

כלומר

$ (hat(f)(0)) / vol(RR^n \/ Lambda) <=  f(0) $

אבל דרשנו גם ש-
$f(0) = hat(f)(0)$
ולכן

$ vol(RR^n \/ Lambda) >= 1  $


 #speaker-notes-slide[

אם נציב את התוצאות שקיבלנו בנוסחת הסכימה, 

נקבל ש
F-0
גדולה או שווה מ-
F-האט-0
חלקי נפח המנה.

נשתמש בכך ש
F-0
ו
F-האט-0 שוות,
ונקבל כי
נפח המנה חייב להיות גדול או שווה ל1, 
ולכן הצפיפות חייבת להיות גדולה או שווה לנפח הכדור ברדיוס
R/2,
כפי שרצינו.
]
== הרחבה לאריזות מחזוריות ואריזות כלליות


הוכחנו כי כאשר ישנה פונקציה המקיימת התנאים, אין אריזת *סריג* בעלת צפיפות גדולה יותר. אך מה לגבי אריזות כלליות?

// From the paper: "given an optimal packing, 
// one can approximate it by taking the spheres contained in a large box 
// and repeating them periodically throughout space, 
// and the density loss is negligible if the box is large enough."

כל אריזה כללית ניתנת לקירוב על ידי אריזה *מחזורית*.
נוכל לקחת את כל הכדורים בתיבה גדולה ככל שנרצה ולחזור עליה עבור המרחב כולו, והצפיפות שתאבד בתהליך תהיה זניחה.


עבור אריזה מחזורית של כדורים שמרכזיהם נמצאים על הזזות של הסריג
$Lambda$
באמצעות
$N$
הווקטורים
$t_1, ..., t_N$,
נוכל שוב להניח ללא הגבלת הכלליות כי אורך הווקטור המינימאלי הינו
$r$
ולכן רדיוס הכדורים הינו
$r\/2$,
וצפיפותה תהיה
$N dot vol(HalfBall) \/ vol(RR^n \/ Lambda) $.

את החסם הדרוש,
$ vol(RR^n \/ Lambda) >= N$,
ניתן לקבל באופן דומה באמצעות הסכום
$ sum_(j,k=1)^N sum_(x in Lambda) f(t_j - t_k + x) $

#speaker-note[
  TODO: איך להסביר את הסכום הזה במילים? XXX
]


 #speaker-notes-slide[


הוכחנו כי כאשר ישנה פונקציה המקיימת התנאים, אין אריזת *סריג* בעלת צפיפות גדולה יותר. אך מה לגבי אריזות כלליות?

כל אריזה כללית ניתנת לקירוב על ידי אריזה *מחזורית*.
נוכל לקחת את כל הכדורים בתיבה גדולה ככל שנרצה ולחזור עליה עבור המרחב כולו, והצפיפות שתאבד בתהליך תהיה זניחה.

עבור אריזות מחזוריות, ניתן לקבל תוצאה דומה תוך הסתכלות על סריג
LAMBDA
בשילוב עם 
N
הזזות באמצעות N ווקטורים.
]
== האפסים של הפונקציה ומסקנות נוספות 
הצפיפות של אריזת סריג של כדורים ברדיוס
$r\/2$ היא:

$ vol(HalfBall) / vol(RR^n \/ Lambda) $

ולכן, אם ישנה פונקציה כזו ו-
$r>0$ כזה,
אז 
 צפיפותה שווה לחסם כאשר
$vol(RR^n \/ Lambda) = 1$.


נציב בנוסחת הסכימה של פואסון:

$ f(0) + sum_(x in Lambda , x != 0) f(x) = hat(f)(0) + sum_(y in Lambda^* , y != 0) hat(f)(y) $

ועל פי הדרישות נסיק כי כל האברים בשני הסכומים אפסים.
ולכן פונקציה העונה על התנאים חייבת לקבל אפסים על הסריג (מלבד בראשית) - וכך גם התמרת פורייה שלה על הסריג הדואלי.

#speaker-note[
אבל דרשנו
$f(0) = hat(f)(0)$,
הסכום הימני הוא של מספרים אי שליליים, הסכום השמאלי הוא של מספרים אפסים או שליליים, ולכן ישנם רק אפסים בשניהם.
]

 #speaker-notes-slide[

מכווין שהצפיפות של אריזת סריג של כדורים ברדיוס
R/2 היא נפח הכדור חלקי נפח המנה,
\
נסיק שאם ישנה פונקציה כזו ו
R
כזה
אז צפיפות האריזה שווה לחסם כאשר נפח המנה שווה ל1.


אם נציב בנוסחת הסכימה של פואסון נקבל את המשוואה הבאה.

אנחנו כבר יודעים ש-
F0
ו
F-האט-0 שווים, הטור הימני הוא סכום מספרים אי שלילים והטור השמאלי הוא מספרים שליליים או אפס, ולכן כל האיברים בשני הסכומים הם אפסים.

זה אומר שנוכל להסיק שהפונקציה מקבלת אפסים על הסריג, ושהתמרת פורייה שלה מקבלת אפסים על הסריג הדואלי.
]
==

כל התנאים על הפונקציה המבוקשת הינם לינארים ונשמרים תחת סיבוב ולכן נוכל לחשוב על
$f$
בתור פונקציה _רדיאלית_
$f_0(x), x >= 0$.

ביחס לסריג
$Lambda_8$,
נוכל גם להסיק את זוגיות הסדר של כל אפס, ולצייר באופן סכמתי את הצורה המצופה של הפונקציה ושל התמרת פורייה שלה:

#speaker-note[
פונקציית הקסם נשארת לא חיובית עבור
$abs(x) >= r$,
אז היא מתאפסת על הסריג
$E_8$
(מלבד בראשית).


בתור פונקציה רדיאלית
$f_0(x)$,
נסיק כי יש לה אפסים בכל
$x = sqrt(2k), k = 1, 2, ...$
וכולם מסדר זוגי מלבד במקרה של
$k = 1$,
שם נצפה לאפס מסדר אי זוגי.

באופן דומה ומכיון ש
$E_8$
צמוד לעצמו, נסיק כי
$hat(f_0)$
מקבלת אפסים מסדר זוגי לכל
$y = sqrt(2k), k = 1, 2, ...$.
]

#import "./plots_grid.typ": plots_grid

#plots_grid


 #speaker-notes-slide[


כל התנאים על הפונקציה המבוקשת הינם לינארים ונשמרים תחת סיבוב ולכן נוכל לחשוב על
$f$
בתור פונקציה _רדיאלית_,
שאני אסמן פה בתור 
F0.

ביחס לסריג
LAMBDA-8,
מכיוון שהוא גם הדואלי של עצמו נוכל לצייר את הפונקציה ואת התמרת פורייה שלה באופן סכמתי.

אז F0 צריכה לקבל ערך חיובי ב0, להתאפס בשורש-2 - והאפס צריך להיות מסדר אי זוגי, כי אז היא הופכת להיות שלילית, ונשארת שלילית או אפס וחוזרת לאפס בכל כפולה של שורש-2.

לעומת זאת,
F-0-האט
מתחילה חיובית (באותו הערך),
ואז מתאפסת (עם אפס מסדר זוגי) בכל כפולה של שורש-2.

מגניב!
]
= תבניות מוֹדוּלָרִיּוֹת <modular-forms>


 #speaker-notes-slide[

ריק
]
==


על פניו, התקדמנו מאוד: יש לנו "מתכון" למציאת הפונקציה המבוקשת:
עלינו למצוא פונקציה של משתנה יחיד, שמקבלת אפסים בכל הסריג
$E_8$,
וכך גם התמרת הפורייה שלה.

אולם, בעיה זו מתבררת כקשה מאוד.

בעוד שניתן לבנות פונקציה בעלת אפסים במקומות הנדרשים, וניתן לבנות פונקציה שהתמרת פורייה שלה מקבלת אפסים כאלו, אין דרך כללית או פשוטה לבנות פונקציה המקיימת את שתי הדרישות בו זמנית.


 #speaker-notes-slide[

למרות שהתקדמנו דיי הרבה ויש לנו מעין מתכון למציאת הפונקציה המבוקשת, אנחנו בבעיה דיי גדולה. 

קשה לשלוט גם בפונקציה וגם בהתמרת פורייה שלה, ולכן קשה לבנות פונקציה שמקבלת אפסים על הסריג וגם שהתמרת פרוייה שלה מקבלת אפסרים על הסריג.
]
==


כפי שראינו,
לכל פונקציה רדיאלית מתקיים
$hat(hat(f)) = f$.
אז ל-
$f$
המקיימת את התנאים, נוכל לקחת:

$ g_(+1) = (f+hat(f)) / 2  , #h(2em) g_(-1) = (f-hat(f)) / 2 $

תחת התמרת פורייה נקבל
$hat(g_(+1)) =& (hat(f)+f) \/ 2 =&  g_(+1) , 
  hat(g_(-1)) =& (hat(f)-f) \/ 2 =& -g_(-1)$.

/ *_פונקציה עצמית_ של התמרת פורייה
*: #[פונקציה המקיימת עבור סקלר
$alpha in RR$
כולשהו
$hat(f) = alpha f$.
]
אז
$g_(+1)$
היא פונקציה עצמית עם
$alpha = 1$,
ו-
$g_(-1)$
היא פונקציה עצמית עם
$alpha = -1$.

הן מקבלות את השורשים הנדרשים  כמו
$f$,
ונוכל לקבל באמצעותן חזרה את
$f$ שכן
$f = g_(+1) + g_(-1)$.

שתי הפונקציות החדשות בלתי תלויות אחת בשניה, ולכן נוכל לבנות כל אחת מהן בנפרד.


 #speaker-notes-slide[

אחד הפישוטים הראשונים שנוכל לעשות הוא כזה:

אנחנו מחפשים פונקציה רדיאלית, וראינו שאם מפעילים על פונקציה כזאת את התמרת פרוייה פעמיים, אנחנו חוזרים לפונקציה המקורית.

אז, אנחנו יכולים לפרק את הפונקציה שלנו לשתי פונקציות חדשות, שנקרא להן

G-מינוס-1
ו
G-פלוס-1.

כל פונקציה כזאת תהיה _פונקציה עצמית_ של התמרת פורייה, כי הן שוות לעצמן עדי כדי כפל בסקלר תחת ההתמרה.

הן בלתי תלויות אחת בשניה, הן מקבלות את אותם אפסים כמו
F,
וניתן להרכיב חזרה את
F
באמצעותן.
]
== התמרת לפלס

כדי למצוא פונקציות עצמיות כאלו, נפנה ל#[_התמרת לפלס_] של _גאוסיאינים_.

#speaker-note[
\
ה#[_גאוסיאן_]
(_Gaussian_),
$f(x) = e^(-t pi abs(x)^2)$,
הינה פונקציה המקיימת
$e^(-t pi abs(x)^2) -> t^(-n/2) e^(-pi abs(y)^2 \/ t)$.
]

/ * _התמרת לפלס_*: #[
עבור פונקציה
$g$,
נגדיר את התמרת לפלס שלה באמצעות:
$ f(x) = integral_0^infinity e^(-t pi abs(x)^2) g(t) dif t $
]

כל עוד
$g$
פשוטה למדי, נוכל לקבל את התמרת פורייה של
$f$
באמצעות החלפה פשוטה:

$ hat(f)(y) =& integral_0^infinity t^(-n/2) e^(-pi abs(y)^2 \/ t) g(t) dif t 
// Replace t -> 1/t.
            =& integral_0^infinity e^(-pi abs(y)^2 t) t^(n/2 - 2)  g(1 \/ t) dif t
$ <fourier-transform-of-laplace-transform>


אם מתקיים
$g(1 \/ t) = epsilon t^(2-n/2) g(t)$
אז
$hat(f) = epsilon f$,
ולכן אנו מחפשים פונקציות המקיימות משוואה כזו.



 #speaker-notes-slide[

אז אנחנו מחפשים פונקציות עצמיות של התמרת פורייה.

אחת הדרכים לבנות פונקציות כאלו היא באמצעות התמרת לפלס.

התמרת לפלס של פונקציה היא פונקציה חדשה, שבה נבצע אינטגרציה על כל הישר של הפונקציה המקורית, כפול הפונקציה
E-בחזקת-מינוס-T-פאי-איקס-בריבוע,
שנקראת גם "גאוסיאן".

כל עוד
G
יחסית פשוטה, קל לחשב את התמרת פורייה של התמרת לפלס,

ואם מתקיימת המשוואה הפונקציואנאלית
G
של 1 חלקי T
שווה ל
קבוע כולשהו כפול
T
בחזקת
2-N/2 כפול
G-T,
אז הפונקציה תהיה פונקציה עצמית.
]

== הגדרות ראשונות

#let hh = $frak(h)$
#let Im = $op("Im")$
#let Re = $op("Re")$

_תבניות מוֹדוּלָרִיּוֹת_
(_modular forms_)
הן משפחה של פונקציות המקיימות משוואות פונקציונאליות מסויימות.

נסמן ב-
$hh$
את חצי המישור העליון, כלומר
$hh = { z in CC | Im z > 0 }$.

// Based on "Definition 3" in "An Introduction to Modular Forms".

/ *_תבנית מוֹדוּלָרִית חלשה_ בעלת משקל 
$k$ 
(_weakly modular form of weight k_)*: #[

עבור פונקציה
$F: hh -> CC$
ו-
$k in ZZ$,
$F$
היא תבנית מודולרית חלשה ממשקל
$k$
אם היא מקיימת:

$ F((a z + b) / (c z + d)) = (c z + d)^k F(z) $

#[
  #set text(bottom-edge: "bounds")
  לכל
  $mat(a, b; c, d) in "SL"(2, RR)$
]
]

$F$
תיקרא
_תבנית מוֹדוּלָרִית_
(_modular form_)
אם היא גם הולומורפית ב-
$hh$
וחסומה כאשר
$Im z -> infinity $.


 #speaker-notes-slide[

תבניות מודולריות הן משפחה של פונקציות המקיימות משוואות פונקצניאליות דומות.

באופן כללי, תבנית מודולרית חלשה ממשקל
K
היא פונקציה מחצי המישור העליון למישור המרוכב, שמקיימת את המשוואה הבאה,
שאומרת שניתן להחליף בין הפעלה של
F
על התרנספורמציה הזאת של 
Z,
לכפל של פולינום ב
F
של
Z,

ואפשר לראות את הדמיון למשוואה שאנחנו מחפשים.

אם F היא הולומורפית בחצי המישור העליון וחסומה כאשר החלק המדומה של 
Z
גדל לאינסוף, אנחנו נקרא לה פשוט "תבנית מודולרית".
]
#let rtl-mark = [\u{200F}]

== טור Eisenstein - $E_k$ #rtl-mark

#counter(footnote).update(0)
#let overlap-footnote = [
אומנם ישנה חפיפה בסימון בין האריזה
$E_8$
לבין
$E_k$
כאשר
$k=8$,
אך נשתמש אך ורק ב
$k in {2,4,6}$.
]

טור
Eisenstein
הינו פונקציה אותה נגדיר כך
#footnote(numbering: "1")[#overlap-footnote]

$ E_k (z) = 1 / (2 zeta (k)) sum_((m,n) in ZZ^2 \ (m,n) != (0,0)) 1 / (m z + n)^k $

כאשר
$zeta$
היא פונקצית זטא של רימן (
  $zeta(k) = sum_(n=1)^infinity 1/n^k$
).



כאשר
$k$
זוגי וגדול מ-2, נקבל על ידי הצבה:

$ 
E_k (z+1) = E_k (z) , space space space
E_k (-1 \/ z) = z^k E_k  (z) 
$ <eisen-k>

ו-
$E_k$
הינן תבניות מדולריות ממשקל
$k$.



 #speaker-notes-slide[

הדוגמה הראשונה שנביא לתבנית מודולרית היא טור אייזנשטיין,
שהיא משפחה של פונקציות המודרת כך:

לכל פרמטר
K
זוגי וגדול מ-2, זהו הסכום האינסופי על כל הזוגות של שלמים של 1 חלקי
MZ ועוד N בחזקת K,
וכפל בקבוע שמתקבל על ידי הצבה של K בפונקציית זטא של רימן.

אפשר לראות באמצעות הצבה שהן

1-מחזוריות

ושניתן להחליף 
את EK ששל
מינוס-אחד-חלקי-Z
בכפל 
Z-בחזקת-K כפול E-K-של-Z,

והן תבניות מודולריות ממשקל
K.
]

==

עבור
$k=2$,
הסכום מתכנס _בתנאי_ ולא _בהחלט_. 

נגדיר את סדר הסכימה כך:


$ E_k (z) &= 1/(2zeta(k)) sum_(n!=0) 1/n^k + 1/(2zeta(k)) sum_(m!=0) sum_(n in ZZ) 1/(m z + n)^k $ <e-k-as-inf-sum>

עבור
$k=2$,
נוכל לקבל שוב באמצעות הצבה את הזהות
$E_2 (z+1) = E_2 (z)$,
אך המקבילה של הזהות 
$E_k (-1 \/ z) = z^k E_k  (z)$
הינה:

$ E_2 (-1 \/ z) = z^2 E_2 (z) - 6i z \/ pi $   <eisen-2>


אנו נאמר ש-
$E_2$
היא 
_תבנית כְּמוֹ-מוֹדוּלָרִית_
(_quasimodular form_)
ממשקל 2.



 #speaker-notes-slide[

ההצבה עובדת רק כאשר
K
זוגי וגדול ממש מ2.
כאשר
K=2,
הסכום מתכנס רק בתנאי, ולא בהחלט.

אבל, אפשר להגדיר את סדר הסכימה כך. באמצעות הצבה אפשר לקבל שוב 1-מחזוריות,
אבל המקבילה של המשוואה הפונקציונאלית השניה שונה מעט:

אנחנו נקבל שההחלפה של
E-שתיים
של מינוס-אחד-חלקי-Z היא
Z-בריבוע
כפול E-שתיים,
אבל פחות הגורם
6-איי-Z-חלקי-פאי.

פונקציה כזאת נקראת תבנית כמו-מודולרית, ממשקל 2.
]
==

סקיצה של של ההוכחה: לכל
$epsilon>0$,
נוכל לסמן

$ G_(2,epsilon) (z) = 1 / 2 sum_((m,n) in ZZ^2 \ (m,n) != (0,0)) 1 / ((m z + n)^2 |m z + n|^(2epsilon)) $

ולקבל טור מתכנס בהחלט.
הפונקציה החדשה מקיימת את המשוואה

// This the same as @eqt:eisen-k (but with the general az+b/cz+d input).

$ G_(2,epsilon)((a z + b) / (c z + d)) = (c z + d)^2 |c z + d|^(2epsilon) G_(2,epsilon)(z) $

הגבול
$G^*_2 (z) := lim_(epsilon -> 0) G_(2,epsilon)(z)$
קיים, ושווה ל- 
$zeta(2) E_2 (z) - pi \/ (2Im(z))$.


$G^*_2$
מתנהגת בדומה לתבנית מודלרית ממשקל 2,
והצבה במשוואה הפונקציונאלית נותנת את התוצאה הרצויה.



 #speaker-notes-slide[

אני רוצה להציג סקיצה קצרה של ההוכחה, כדי להסביר מאיפה "נפל" עלינו הגורם הזה.

התור אומנם לא מתכנס בהחלט, אבל הוא כל כך קרוב לכך, שלכל אפסילון גדול מאפס אפשר לסמן את הפונקציה הבאה, שדומה לטור אייזנשטיין המקורי אבל בלי הגורם הקבוע,
ולקבל תור מתכנס בהחלט.

הפונקציה החדשה מקיימת את המשוואה הפונקצינואלית הזאת, מה שאומר שהיא מתנהגת כמו תבנית מודולרית.

עכשיו, אפשר למצוא את הגבול כאשר אפסילון הולך לאפס, ולהראות שהוא שווה ל
זטא-2 כפול אי-2-של-
Z,
פחות פאי-חלקי-שתיים-כפול-החלק-המדומה-של-Z.

נגיד את הפונקציה
G-שתים-סטאר בתור הגבול הזה, גם היא מקיימת את המשוואה, וניתן להציב את הגבול שקיבלנו במשוואה לקבל את התוצאה הרצויה.
]
== פיתוח פורייה של $E_k$

לפונקציה 1-מחזורית ישנו פיתוח פורייה בעל הצורה הבאה:
$g(z) space ~ sum_(n = -infinity)^infinity a_n e^(2 pi i n z)$.

נמשיך מכאן והלאה לסמן 
$q = e^(2 pi i z)$.
כדי למצוא פיתוח פורייה ל-
$E_k$
נשתמש בזהות הבאה:

$ sum_(n in ZZ) 1 / (z + n) = pi / tan(pi z) = -2pi i (1/2 + sum_(r=1)^infinity q^r), space z in CC \/ ZZ $ <sum-one-over-z-plus-n>

ובאמצעות
$k$
גזירות איבר-איבר, נוכל לקבל פיתוח ל-
$sum_(n in ZZ) 1 / (z + n)^k$.  בסך הכל, נקבל כי:

$ E_k (z) = 1 + 2 / (zeta (1 - k)) sum_(m=1)^infinity sigma_(k-1)(m) q^m $ <e-k-fourier-exp>

כאשר
$sigma_(k-1)(m)$
מחזירה את סכום המחלקים של
$m$, 
כאשר כל אחד מהם מועלה בחזקת
$k-1$.


 #speaker-notes-slide[

מעכשיו, נסמן ב
Q
את
$e^(2 pi i z)$.

מכיוון ש
EK
הן פונקציות 1-מחזוריות, טבעי שנרצה לחשב את פיתוח פורייה שלהן.

מה שחשוב לי לציין הוא שניתן, למשל באמצעות גזירה איבר-איבר של התור כאן, לקבל ביטוי מפורש של 
המקדם של כל איבר בפיתוח פורייה, של כל אחת מהפונקציות
 EK.
 
-

// אנחנו רוצים לעבוד עם פיתוח פרוייה של
// EK.

// מכאן והלאה נסמן את
// E-בחזקת-שתי-פאי-איי-Z
// בQ,
// ונשתמש בזהות הבאה כדי למצוא פיתוח פורייה ל
// EK.

// אם נגזור K פעמים איבר-איבר, נוכל לקבל פיתוח לסכום שהוא כמעט הסכום הרצוי. 

// לאחר מכן, אפשר להחליף את הסכום הכפול 

// בסכום מ-1 עד אינסוף של סיגמה-קיי-מינוס-אחד של M
// ,
// שהיא פונקציה המחזירה את סכום המחלקים של M בחזקת K-1.

$ E_k (z) &= 1 + 1/(zeta(k)) sum_(m=1)^infinity [(-2pi i)^k / (k-1)! sum_(r=1)^infinity r^(k-1) q^(m r)] 
&= 1 + 1/(zeta(k)) (2pi i)^k / (k-1)! sum_(m=1)^infinity sigma_(k-1)(m) q^m\ 
 $ <e-k-fourier-exp>

]

#if(false) {[
==


נרצה גם למצוא נוסחה אסימפטוטית עבור המקדם
$a_n$
של תבנית מודולרית,
וכך נוכל לקבל חסמים אפקטיביים על הפונקציות.

נבחן מקרה פשוט במיוחד:
כאשר
$n>=1$, 
המקדם ה-
$n$
בפיתוח פורייה של
$E_k$
מקיים
$a_n = O(n^(k-1))$, \
וזאת מכיוון ש-
$n^(k-1) <= sigma_(k-1)(n) < zeta(k-1) n^(k-1)$.

אז, המקדם ה-
$n$
בפיתוח פורייה של
$E_2$
מקיים,
כאשר
$n>=1$, 

// In Viazovksa's paper, she uses this form "Similar inequalities hold for the Fourier coefficients of ..".

$ abs(c_(E_2(z))(n)) <= C_1 n $

ולכן כאשר
$Im(z) > 1\/2$:

$
abs(E_2(z)) <= 1 + sum_(n=1)^infinity  C_1 n abs(e^(2 pi i n z))

= 1 + C_1 sum_(n=1)^infinity n e^(-2 pi n Im(z)) 
<=  1 + C_2 e^(-2pi Im z) 
$

#speaker-note[
   לכל
$Im(z) > 0$
התור מתכנס ו-

// https://www.wolframalpha.com/input?i=sum+(ne%5E(-2pi*n*t)),+n%3D1+to+infinity
$
sum_(n=1)^infinity n e^(-2pi n Im(z)) = (e^(2pi Im(z))) / (1 - e^(2pi Im(z)))^2
$

]

]}

// TODO: This is probably too much, so we skip it
#if(false) {[
  
== שימושים ל- $E_k$

/// From "Proposition 5" in 1-2-3 of Modular Forms
אם נשתמש בפיתוח פורייה נקבל כי

$ 
E_4 (z) &= 1 + 2 / (zeta (-3)) ( sigma_(3)(1) q^1 + sigma_(3)(2) q^2 + ... ) \
        &= 1 + 2 / (1/120) ( 1dot q^1 + 9 dot q^2 ) \
        &= 1 + 240q + 2160q^2 + ...
$ <e4-fourier>

באופן דומה, נקבל כי
$
E_6 &= 1 − 504q − 16632q^2 − ... \
E_2 &= 1 - 24q - 72q^2 - ...
$ <e2-and-e6-fourier>

==

באמצעות פיתוחים אלו נוכל גם לחשב את הפיתוחים של חזקות שונות של
$E_k$,
למשל:

// Taken from "Proposition 7" in 1-2-3 of Modular Forms

$ 
E_4^2 &=  (1 + 240q + 2160q^2 + ...)^2 = 1 + 480q + ... \
E_4^3 &=  1 + 720q + ... \
E_6^2 &= 1 - 1008q + ... 
$ <ek-powers-fourier>


הצירוף
$ E_4^3 - E_6^2 = 1728q + ...$
שימושי בפני עצמו. 
נוכל לנרמל אותו ולסמנו בתור

$ Delta (z) = 1/1728 (E_4^3 - E_6^2) $

==

נציג עתה את $j$,
הנקראת גם
_elliptic j-invariant_.

היא מוגדרת כך:

$ j  = (E_4^3) / Delta = (1728 E_4^3) / (E_4^3 - E_6^2) $ <elliptic-j-invariant>

#speaker-note[
במבט ראשון, הביטוי נראה משונה מאוד, מדוע לבחור שבר המורכב מ"פולינום" של תבניות מודולריות?
]

נוכל לבדוק ולקבל כי אכן
$ 
j(-1 \/ z) = (1728 E_4^3(-1/z)) / (E_4^3(-1/z) - E_6^2(-1/z)) = 
(1728 z^12 E_4^3(z)) / (z^12 E_4^3(z) - z^12 E_6^2(z)) = j(z)
$

כלומר, 
$j$
היא אכן אינווריאנטית במובן זה. באופן מיידי נוכל לקבל גם כי
$j(z) = j(z+1)$.

#speaker-note[
בזכות הפיתוח, מתבררים תפקידיהם של ה-
$E_k$-ים
השונים, וכן החזקות הספציפיות שנבחרו עבורם. מיד גם נראה מהיכן מגיע הקבוע $1728$ במונה.
]

==

מכיוון שיש לנו מתכון לחישוב פיתוח פורייה של
$E_k$
לכל חזקה שנרצה, נוכל לחשב גם את פיתוח פורייה של
$j$
לכל חזקה שנרצה:

$ #h(1em) j(z) = q^(−1) + 744 &+ 196884 q + 21493760 q^2 \ &+ 864299970 q^3 + 20245856256 q^4 \ &+ O(q^5) $ <j-foureir>


]}

#let thetaseries = $Theta_Lambda$
#let thetaseriesdual = $Theta_(Lambda^*)$

== פונקציית תטא של סריג - $thetaseries (z)$ <theta-series>

לכל סריג
$Lambda$
נוכל להגדיר פונקציה, לה נקרא פונקציית תטא, כך

$ thetaseries(z) = sum_(x in Lambda) e^(pi i abs(x)^2 z) $

פונקציה זו מתכנסת כאשר
$Im z > 0$
ומגדירה פונקציה אנליטית ב-
$hh$.

לפונקציה זו תכונה חשובה:
לכל סריג
$Lambda$
ב-
$RR^n$,
מתקיים

$ thetaseries(z) = 1 / vol(RR^n \/ Lambda) (i/z)^(n \/ 2) thetaseriesdual (-1 \/ z) $

לכל
$z in hh$.

ההוכחה - באמצעות נוסחת הסכימה של פואסון על הפונקציה הפנימית,
$e^(-t pi abs(x)^2)$.


 #speaker-notes-slide[

בלי להתעכב מידי על הפרטים, לכל סריג ניתן להגדיר פונקצייה שנקראת פונקציית תטא של סריג, באמצעות סכימה של כל הווקטורים בסריג תוך הפעלה של פונקציית הגאוסייאן עליהם.

זו פונקציה שמתכנסת בחצי המישור העליון, ומקיימת את המשוואה הפונקציונאלית הבאה.

(קליק)
]
==


אנו נשתמש בפונקציות תטא הבאות,
המוגדרות על הסריג
$ZZ$:

$ 
theta_00 (z) = sum_(n in ZZ) e^(pi i n^2 z)\
theta_01 (z) = sum_(n in ZZ) (-1)^n e^(pi i n^2 z)\
theta_10 (z) = sum_(n in ZZ) e^(pi i (n + 1/2)^2 z)
$ <theta-z-funcs>


#grid(
  columns: (1fr, 1fr),
  [
    #align(center)[
      $
      z^(-2) theta_00^4(-1 \/ z) &= -theta_00^4(z) \
      z^(-2) theta_01^4(-1 \/ z) &= -theta_10^4(z) \
      z^(-2) theta_10^4(-1 \/ z) &= -theta_01^4(z) \
      $
    ]
  ],
  [
    #align(center)[
      $
      theta_00^4(z + 1) &= &theta_01^4(z) \
      theta_01^4(z + 1) &= &theta_00^4(z) \
      theta_10^4(z + 1) &= -&theta_10^4(z)
      $
    ]
  ]
)

 #speaker-notes-slide[

אנחנו נשתמש בשלוש הפונקציות הבאות, שאני רוצה רק להציג כאן לשם השלמות.
]
= הפונקציה של #Viaz #rtl-mark <viaz-func>


 #speaker-notes-slide[

ריק 
]
== בניה של פונקציה בעלת שורשים מתאימים

תבניות מודולריות, בשילוב עם התמרת לפלס, מתאימות לחיפוש שלנו אחר פונקציות עצמיות של התמרת פורייה. 

אך כיצד נוכל לבנות פונקציה בעלת השורשים המתאימים?
דרך אחת וישירה מאוד היא באמצעות כפל בפונקציה פשוטה המקבלת שורשים דומים, וזו הדרך בה הצליחה
#Viaz
להוכיח את קיומן של הפונקציות הנדרשות.

הפונקציה
$sin^2(pi abs(x)^2 \/ 2)$
מקבלת אפסים מסדר שני לכל
$x=sqrt(2k), k=1,2,...$.

בשילוב עם התמרת לפלס נקבל תבנית שתתאים לשתי הפונקציות העצמיות אותן אנו מחפשים:
#filled-block[
$ sin^2(pi abs(x)^2 \/ 2) integral_0^infinity e^(-t pi abs(x)^2) f(t) dif t $ <eign-fn-pattern>
]

#speaker-note[
אלו הם כמעט האפסים בהם אנו מעוניינים, מלבד אפס לא רצוי מסדר רביעי עבור
$x=0$, 
והאפס עבור
$x=sqrt(2)$ 
שהינו מסדר שני ולא מסדר ראשון (או מסדר אי זוגי אחר). אבל אלו הן בעיות הניתנות (כמסתבר) לגישור.


נשים לב שעל מנת שנוכל להשתמש בתבנית זו, לא מספיק שרק נמצא פונקציות עצמיות: 
עלינו גם לפצות על השורשים הלא מתאימים וגם לוודא כי הפונקציה הסופית מקיימת את החסמים המתאימים.
]


 #speaker-notes-slide[

תבניות מודולריות מתאימות לחיפוש שלנו אחר פונקציות עצמיות של התמרת פורייה,
אבל עדיין לא פתרנו את הבעיה הקשה ביותר:

כיצד נוכל לבנות פונקציה שגם לה וגם להתמרת פורייה שלה יש את השורשים המתאימים?

דרך אחת וישירה מאוד היא באמצעות כפל בפונקציה פשוטה המקבלת שורשים דומים, וזו הדרך בה הצליחה
#Viaz
להוכיח את קיומן של הפונקציות הנדרשות.

אם ניקח את סינוס ברבוע של פאי-איקס-בריבוע-חלקי2, נקבל פונקציה בעלת אפס מסדר שני לכל
X
ששווה לשורש-2 כפול K.

אם נשלב זאת עם התמרת לפלס נקבל תבנית שתתאים לשתי הפונקציות העצמיות שאנחנו מחפשים.
]
== תנאים לפונקציות עצמיות מתאימות

// Intro

נתחיל בחיפוש אחר הפונקציה העצמית בעלת הערך העצמי 1. אם נניח כי יש לנו פונקציה:

$ a(x) = sin^2(pi abs(x)^2 \/ 2) integral_0^infinity e^(-t pi abs(x)^2) g_0(t) dif t $

אנחנו רוצים לדעת מתי
$hat(a) = a$.

אנחנו מחפשים תנאים _שאינם הכרחיים_. לא דרושים לנו כלים לאפיון _כל_ הפונקציות שיכולות לשמש להוכחת החסם, אלא דוגמה לפונקציה אחת כולשהי.

ננסה לבצע ניחושים מושכלים על מנת לצמצם את "איזור החיפוש".

בתור התחלה, נניח כי
$abs(x)>sqrt(2)$,
כי שם התנהגות הפונקציה צריכה להיות פשוטה יותר.


 #speaker-notes-slide[

נתחיל בחיפוש אחר הפונקציה בעלת הערך העצמי 1.
אם ניקח את התבנית שקיבלנו, אנחנו רוצים לדעת מתי
A-האט
שווה ל 
A.

אנחנו לא מחפשים תנאים הכרחיים. אנחנו לא צריכים לאפיין את כל הפונקציות, אנחנו רק צריכים דוגמה לפונקציית קסם אחת מתאימה.

מה שנעשה הוא לנסות לבצע ניחושים משוכלים על מנת לצמצם את איזור החיפוש.

בתור התחלה, נניח שהארוך של איקס גדול משורש 2, כי אנחנו יודעים ששם ההתנהגות של הפונקציה צריכה להיות פשוטה יותר.
]
==

#counter(footnote).update(0)

נוכל גם לחשוב על
$a$
בתור פונקציה רדיאלית המוגדרת#footnote[
כאשר נדבר על התמרת פורייה, נמשיך לסמן
$a(x) : RR^n -> RR$
ואת ההתמרה ב-
$hat(a)(y)$
תוך החלפה של
$r^2$
בריבוע הנורמה של הווקטור
$x$.
]
עבור
$r in RR_(>=0)$.
\
ראינו שהתמרת פורייה של התמרת לפלס מקבל את הצורה הבאה:
$  integral_0^infinity e^(-t pi abs(x)^2) g(t) dif t -> integral_0^infinity e^(-pi abs(y)^2 t) t^2  g(1 \/ t) dif t $

אז אם נניח ש
$a$
הינה פונקציה עצמית (כלומר, 
$hat(a) = a$), 
אז נוכל להתקרב לצורה הרצויה אם נבחר
\
$g_0(t) = h_0 (1\/t) t^2 $,
כלומר
$ a(r) = sin^2(pi r^2 \/ 2) integral_0^infinity e^(-pi r^2 t) t^2  h_0(1 \/ t) dif t $


 #speaker-notes-slide[

כזכור, אנחנו יכולים לחשוב על
A
בתור פונקציה רדיאלית, עבור
R
גדול-שווה 0.

ראינו גם שהתמרת פורייה של התמרת לפלס מחליפה את הפונקציה הפנימית ב
T^2 כפול 
הפונקציה הפנימית של 1-חלקי-T.

אז אם נניח ש
A
היא פונקציה עצמית, הגיוני להתקרב לצורה הזאת של הפונקציה.

אז נחליף את
G-אפס
של T
ב
H-0
של 1חלקיT,
כפול
T^2.

]

==

#let phi0 = $phi.alt_0$


אנו רוצים לעבוד ב-
#hh,
חצי המישור העליון כדי להשתמש בתבניות מודולריות,
ונוכל לפשט אף יותר אם נחפש פונקציה 
$phi0 : i RR -> i RR$.
נוכל לסמן:

$ i phi0 (1/(i t)) = h_0(1/t) $

#speaker-note[
הבחירה היכן "למקם" את ה-
$i$-ים
היא מעט שרירותית, אבל היא תתאים מאוד לצעד הבא שלנו, כפי שתכף נראה.
]


נציב
ונעבור לקטע האינטגרציה 
$(0, i infinity)$
באמצעות החלפת משתנים
$z= i t => t = -i z$:

$ a(r) &= sin^2(pi r^2 \/ 2) integral_0^infinity e^(-pi r^2 t) t^2  i phi0(1 / (i t)) dif t \

 &= - sin^2(pi r^2 \/ 2) integral_0^(i infinity) phi0(-1/z) z^2  e^(z pi i r^2) dif z 
$

 #speaker-notes-slide[

כדי להשתמש בתבניות מודולריות, אנחנו צריכים לעבוד בחצי המישור העליון.

אנחנו יודעים שהפונקציה שלנו מקבלת משתנה ממשי ואמורה להחזיר רק ערכים ממשיים, אז נוכל לחפש פונקציה מרוכבת 
מIR
לIR,
ונסמן אותה בתור
פהאי-אפס.
[[מתחרז עם קסאי, פאי]].

נציב ונבצע החלפה כדי לעבור לקטע האינטגרציה אפס-איי-אינסוף, ובסך הכל נקבל את הצורה הזאת:

A, שווה ל-

מינוס סינוס בריבוע של פאי--R-בריבוע חלקי 2,
כפול האינטגרל מאפס לאיי-אינסוף של פהאי אפס של מינוס אחד חלקי
Z,
כפול
Z-בריבוע-אי-Z-פאי-איי-R-בריבוע-
DZ.

אומנם הביטוי נראה דיי מורכב, אבל המוטיבציה לכל אחד מהחלקים דיי ברורה:

?? הסינוס נותן לנו אפסים על הסריג, האיטגרל דומה להתמרת לפלס אבל על הציר המדומה בשביל התבניות המודולריות, 
ופהאי של
מינוס1חלקיZ
כפול Z^2
כי אנחנו מצפים לפונקציה עצמית.
]

==


מה יקרה אם ננסה להתקרב אף יותר לצורה של התמרת לפלס?
כלומר, אנו רוצים ש
$e^(z pi i r^2)$
יהיה אחד מגורמי המכפלה בתוך האינטגרל, ולהימנע מגורמים מחוצה לו.

נוכל לעשות זאת באמצעות הזהות

$ sin^2(pi r^2 \/ 2) = -1/4 (e^(i pi r^2) - 2 + e^(-i pi r^2)) $

אז נגדיר:

$ a(r) := -4 sin^2(pi r^2 \/ 2) integral_0^(i infinity) phi0(-1/z) z^2  e^(pi i r^2 z) dif z  $ <a-for-r-gt-sqrt-2>

מעתה, לא נשנה יותר את
$a$,
ונתמקד בפונקציה הפנימית,
$phi0$.

 #speaker-notes-slide[

אנחנו עדיין לא ממש קרובים לצורה של התמרת לפלס. אנחנו צריכים שהגורם
$e^(z pi i r^2)$
יהיה אחד מהגורמים בתוך המכפלה, ושלא יהיו גורמים מחוץ לאינטגרל.

נוכל להחליף את הסינוס בחזקות של E באמצעות הזהות הבאה:

ונעדכן את ההגדרה שלנו של
A
לכלול את הכפל ב-4 כדי לשמור על הצורה המפורקת פשוטה יותר.
]
==


נשתמש בזהות ונקבל

$ a(r) = integral_0^(i infinity) [ phi0(-1/z) z^2  e^(pi i r^2 (z+1)) - 2 phi0(-1/z) z^2  e^(pi i r^2 z) + phi0(-1/z) z^2  e^(pi i r^2 (z-1)) ] dif z $


נטפל בחזקות
$z+1, z-1$
בגורמים
$e^(pi i r^2 (z plus.minus 1))$,
שמפריעים לנו להגיע להתמרת לפלס.

נוכל לבצע החלפת משתנים בכל אחד מהמחוברים, ולקבל:

$ 
// Fix the e^(z+1) by ~z= z+1 => z= ~z-1  
integral_0^(i infinity) phi0(-1/z) z^2  e^(pi i r^2 (z+1)) dif z = integral_(1)^(i infinity+1) phi0(-1/(z-1)) (z-1)^2  e^(pi i r^2 z) dif z \

// Fix the e^(z-1) by ~z= z-1 => z= ~z+1  
integral_0^(i infinity) phi0(-1/z) z^2  e^(pi i r^2 (z-1)) dif z = integral_(-1)^(i infinity-1) phi0(-1/(z+1)) (z+1)^2  e^(pi i r^2 z) dif z
$


 #speaker-notes-slide[

הזהות מאפשרת לנו להגיע לצורה הבאה של הפונקציה, שהיא וורבוזית הרבה יותר אך שקולה לגמרי, ומתאימה לניתוח באמצעות התמרת פורייה.

החזקות של
Z-פלוס-מינוס-1 יחסית קלות לטיפול: אפשר לבצע החלפת משתנים בכל אחד מהאינטגרלים ולקבל את האינטגרלים הבאים.
]
==

נניח שניתן לעבור בין
$phi0(-1/z) z^2 <-> phi0(z)$.
שינוי תחום האינטגרציה בעייתי לנו:

#let integral-path-text = [

$ integral_(i a)^(i b) phi0(-1/z) z^2 e^(pi i abs(x)^2 z) dif z -> \ integral_(i 1/a)^(i 1/b) phi0(w) e^(pi i abs(y)^2 w) dif w , space a,b in [-infinity, infinity]  $

נחלק את הקטע
$(0, i infinity)$
ל-
$(0, i)$
ו-
$(i, i infinity)$,
ונקבל כי כל אחד מהם הוא תמונת מראה של השני. 

את האינטגרציה לאורך הקטעים
$(plus.minus 1, i infinity)$
נשנה להיות על הקטעים
$(plus.minus 1, i) -> (i, i infinity)$.

]

#import "./integral_paths_graph.typ": integral-path-graph

#grid(
  columns: (1fr, 1fr),
  [
    #integral-path-text
  ],
  [
    #align(left + horizon)[#integral-path-graph]
  ]
)


 #speaker-notes-slide[

הבעיה היא שגם אם יש לנו דרך לעבור בין פהאי-אפס של מינוס אחד חלקי Z לפהאי-אפס של Z,
שינוי תחום האינטגרציה מפריע לנו לחזור לאותה הפונקציה ממש.

אבל, אפשר לחלק את הקטעים כך: את אפס-עד-I-אינסוף נחלק ל

$(0, i infinity)$
ל-
$(0, i)$
ו-
$(i, i infinity)$,
ונקבל כי כל אחד מהם הוא תמונת מראה של השני תחת התמרת פורייה וההחלפה שביצענו. 

אנחנו רוצים להימנע מאינטגרציה על הציר הממשי, אז נבחר לחלק את הקטעים
$(plus.minus 1, i infinity)$
לקטעים
$(plus.minus 1, i) -> (i, i infinity)$.
]

==

$

a(r) &=  integral_(-1)^(i) phi0(-1/(z+1)) (z+1)^2  e^(pi i r^2 z) dif z \
     & -2 integral_0^(i) phi0(-1/z) z^2  e^(pi i r^2 z) dif z \
     & + integral_(1)^(i) phi0(-1/(z-1)) (z-1)^2  e^(pi i r^2 z) dif z \
     & + integral_(i)^(i infinity) [
       phi0(-1/(z+1)) (z+1)^2  e^(pi i r^2 z) \ &#h(4em) -2 phi0(-1/z) z^2  e^(pi i r^2 z)  + phi0(-1/(z-1)) (z-1)^2  e^(pi i r^2 z)
     ] dif z

$ <a-as-sum-of-3-finite-integrals-and-one-i-to-inf-integral>


 #speaker-notes-slide[

בסך הכל נקבל את ה"מפלצת" הזאת, שהיא בסך הכל הפונקציה היחסית פשוטה שהתחלנו איתה, אבל אחרי שקירבנו אותה כמה שיכולנו לצורה של התמרת לפלס.
]
==

נסתכל על התמרת פורייה של האינטגרל בקטע
$(-1,i)$
תחת החלפת משתנים 
$w=-1/z$, נקבל:

$
integral_(-1)^(i) phi0(-1/(z+1)) (z+1)^2  e^(pi i abs(x)^2 z) dif z -> integral_(1)^(i) phi0(-1 - 1/(w-1)) (w-1)^2 e^(pi i abs(y)^2 w) dif w
$

ונקבל
זהו כמעט האינטגרל בקטע
$(1,i)$!

אם
$phi0$
היא 1-מחזורית (תכונה שכבר הוכחנו עבור תבניות מודולריות), אז
$ phi0(-1 - 1/(w-1)) = phi0(1 + -1 - 1/(w-1)) = phi0(- 1/(w-1)) $

כלומר
החלק המורכב מהאינטגרלים על הקטעים 
$(plus.minus 1, i)$
הוא למעשה פונקציה עצמית (תחת ההנחה ש-
$phi0(z+1) = phi0(z)$
).


 #speaker-notes-slide[

אם נסתכל עכשיו על התמרת פורייה של האינטגרל בקטע מינוס-1-עד-I,
נקבל תחת החלפת משתנים את האינטגרל מ1-עד-איי של הפונקציה הבאה, שהיא כמעט האינטגרל בקטע 1-עד-I
בפונקציה המקורית.

אם פהאי-0 היא 1-מחזורית, אז נוכל לקבל בדיוק את החלק של האינטגרל מ1-עד-I,

(קליק)

כלומר האינטגרלים על הקטעים פלוס-מינוס-אחד-עד-I הם כבר פונקציה עצמית (אם נניח 1-מחזוריות)
]

==

$

a(r) &= #text(green.darken(26%))[ $ integral_(-1)^(i) phi0(-1/(z+1)) (z+1)^2  e^(pi i r^2 z) dif z $ ] \
     & -2 integral_0^(i) phi0(-1/z) z^2  e^(pi i r^2 z) dif z \
     & #text(green.darken(26%))[ $ + integral_(1)^(i) phi0(-1/(z-1)) (z-1)^2  e^(pi i r^2 z) dif z $] \
     & + integral_(i)^(i infinity) [
       phi0(-1/(z+1)) (z+1)^2  e^(pi i r^2 z) \ &#h(4em) -2 phi0(-1/z) z^2  e^(pi i r^2 z)  + phi0(-1/(z-1)) (z-1)^2  e^(pi i r^2 z)
     ] dif z

$ <a-as-sum-of-3-finite-integrals-and-one-i-to-inf-integral>


 #speaker-notes-slide[

(קליק)

כלומר האינטגרלים על הקטעים פלוס-מינוס-אחד-עד-I הם כבר פונקציה עצמית (אם נניח 1-מחזוריות)


אם נמשיך את קו המחשבה הזה, אנחנו חייבים שהחלק השני של הפונקציה, כלומר האינטגרלים בקטעים אפס-עד-I וI עד I-אינסוף,
יהיו גם הם פונקציה עצמית.

// ==

// $

// a(r) &= #text(green.darken(26%))[ $ integral_(-1)^(i) phi0(-1/(z+1)) (z+1)^2  e^(pi i r^2 z) dif z $ ] \
//      & #text(blue.darken(26%))[ $ -2 integral_0^(i) phi0(-1/z) z^2  e^(pi i r^2 z) dif z  $ ] \
//      & #text(green.darken(26%))[ $ + integral_(1)^(i) phi0(-1/(z-1)) (z-1)^2  e^(pi i r^2 z) dif z $] \
//      & #text(blue.darken(26%))[ $ + integral_(i)^(i infinity) [
//        phi0(-1/(z+1)) (z+1)^2  e^(pi i r^2 z) \ &#h(4em) -2 phi0(-1/z) z^2  e^(pi i r^2 z)  + phi0(-1/(z-1)) (z-1)^2  e^(pi i r^2 z)
//      ] dif z $ ]

// $ <a-as-sum-of-3-finite-integrals-and-one-i-to-inf-integral>


//  #speaker-notes-slide[

// (קליק)
]
==

כדי ש-
$a(r)$
כולה תהיה פונקציה עצמית, חייב להתקיים כי החלק השני של הפונקציה,
כלומר החלק המורכב מהקטעים
$(0, i)$ ו- $(i, i infinity)$
גם הוא פונקציה עצמית.

נוכל להפעיל עליו את התמרת פורייה ולהשוות, ולקבל כי אם:

$
phi0(-1/(z+1)) (z+1)^2 -2 phi0(-1/z) z^2 + phi0(-1/(z-1)) (z-1)^2 = 2phi0(z)
$ <phi0-func-eq>

אז גם החלק השני של
$a(r)$
יהיה פונקציה עצמית, כלומר 
$a(r)$
כולה תהיה בדיוק הפונקציה העצמית אותה אנו מחפשים!

#speaker-note[
נסכם:
עלינו למצוא פונקציה, אותה סימנו ב-
$phi0$,
כך ש:

1.#[
  $phi0$
  היא 1-מחזורית, כלומר
  $phi0(z)=phi0(z+1)$.
]

2.#[
  $phi0$
  מקיימת את
  המשוואה
]

3.#[
  $phi0(z)=O(e^(-2pi i z))$
  כאשר
  $Im z -> infinity$,
  עבור ההתכנסות במ"ש ובהחלט של האינטגרלים.
]

4.#[
  $phi0(-1/z) z^2  e^(pi i r^2 z) -> 0$
  כאשר
  $Im (z) -> infinity$,
  כדי שנוכל לשנות את מסלול האינטגרציה.
]

אם נדרוש גם כי
$a(x)$
עצמה תהיה פונקציית שוורץ,
תנאים אלה יבטיחו שנקבל פונקציה עצמית.

אנו יודעים כי היא תקבל את האפסים הנדרשים כאשר 
$r>sqrt(2)$
אבל יהיה עלינו לבדוק את האפס הנוסף כאשר
$r=sqrt(2)$.
]



 #speaker-notes-slide[

[
אם נמשיך את קו המחשבה הזה, אנחנו חייבים שהחלק השני של הפונקציה, כלומר האינטגרלים בקטעים אפס-עד-I וI עד I-אינסוף,
יהיו גם הם פונקציה עצמית.
]

נוכל להפעיל את התמרת פורייה ולהשוות את התוצאה לביטוי המקורי, ולקבל כי אם מתקיימת המשוואה הפונקציונאלית הבאה, שמאוד מזכירה את התכונות שקיבלנו עבור צורות מודלריות, מתקיימת, 

אז כל A היא פונקציה עצמית כפי שרצינו!
]

== פונקציה המקיימת את התנאים


נציג עתה את $j$,
הנקראת גם
_elliptic j-invariant_.

היא מוגדרת כך:

$ j  = (1728 E_4^3) / (E_4^3 - E_6^2) $ <elliptic-j-invariant>

#speaker-note[
במבט ראשון, הביטוי נראה משונה מאוד, מדוע לבחור שבר המורכב מ"פולינום" של תבניות מודולריות?
]

נוכל לבדוק ולקבל כי אכן
$ 
j(-1 \/ z) = (1728 E_4^3(-1/z)) / (E_4^3(-1/z) - E_6^2(-1/z)) = 
(1728 z^12 E_4^3(z)) / (z^12 E_4^3(z) - z^12 E_6^2(z)) = j(z)
$

כלומר, 
$j$
היא אכן אינווריאנטית במובן זה. באופן מיידי נוכל לקבל גם כי
$j(z) = j(z+1)$.

#speaker-note[
בזכות הפיתוח, מתבררים תפקידיהם של ה-
$E_k$-ים
השונים, וכן החזקות הספציפיות שנבחרו עבורם. מיד גם נראה מהיכן מגיע הקבוע $1728$ במונה.
]

 #speaker-notes-slide[

נתחיל את הבניה של פונקציה המקיימת את התנאים הנדרשים.

נתחיל בכך שנציג פונקציה הנקראת
_elliptic j-invariant_.

במבט ראשון, זה ביטוי דיי משונה: למה לבחור שבר המורכב מ"פולינומים" של תבניות מודולריות?

אבל אם נציב את מינוס-1-חלקי-Z,
התפקידים השונים של ה
EKים
מתבררים:
למשל,
E4
מחליף את מינוס-1-חלקי-Z
בZ-בחזקת-4,
והעלאה בחזקת 3 של התבנית כולה נותנת Z-בחזקת 12, שמתקזז בדיוק עם ה
Zים
במכנה.

הקבוע $1728$ דרוש עבור נירמול של פיתוח פורייה של J.
]
==

בדומה לפונקציה
$j$,
נגדיר שתי פונקציות עזר:

$

phi_(-2) := (-1728 E_4 E_6) / (E_4^3 - E_6^2) , #h(4em)
phi_(-4) := (1728 E_4^2) / (E_4^3 - E_6^2) \

$

אלו פונקציות להן התכונות

$

phi_(-2)(-1 \/ z) = z^(-2) phi_(-2)(z) \

phi_(-4)(-1 \/ z) = z^(-4) phi_(-4)(z)

$

(וכמובן ששתיהן 1-מחזוריות)

#speaker-note[
אלו הן "אבני בניין" בהן נוכל להשתמש בכל פעם שנרצה להיפטר מחזקות לא רצויות של
$z$.
]

 #speaker-notes-slide[

באופן דומה, נגדיר עוד שתי פונקציות:
פהאי-מינוס-2 ופהאי-מינוס-4.

פהאי-מינוס-2 של מינוס-1-חלקי-Z
הופכת להיות
Z^-2 של פהאי-מינוס-2 של Z,
ופהאי מינוס 4...
]

==

באמצעות פונקציות אלו, נגדיר

$

phi0 := phi_(-4) E_2^2 + 2phi_(-2) E_2 + j - 1728

$

ו-
$phi0$
מקיימת את כל התכונות הדרושות לנו!
המשוואה הפונקציונאלית נובעת מכך ש-
$

phi0(-1 / z) = phi0(z) - (12i) / pi dot 1 / z (phi_(-4) E_2 + phi_(-2)) - 36 / (pi^2) 1 / (z^2) phi_(-4) (z)

$ <phi0-one-over-z-tranform>

ואת מרבית התכונות האחרות ניתן להוכיח באמצעות פיתוח פורייה של
$phi0$,
שניתן לחישוב באמצעות כלי אוטומאטי:

$

phi0(z) &= 518400 q + 31104000 q^2 + 870912000 q^3 + 15697152000 q^4 + O(q^5) 

$

בשילוב עם חסמים אסימפטוטיים על המקדמים.

 #speaker-notes-slide[

ועכשיו נוכל לבנות את פהאי-0, הפונקציה הדרושה לנו!

פהאי-אפס מוגדרת בתור:
[פהאי-מינוס-4 כפול E2-בריבוע...]

חלק מההגיון מאחורי הפולינום הוא ש
E2 מוסיפה
Z^2,
אז פהאי-מינוס-2 מבטלת אותו.

ככה גם
E2-בחזקת-2 ו-פהאי-מינוס-4.

J
והקבוע מאפשרים לנו לקבל פיתוח פורייה שמכיל רק גורמים מ
Q-בחזקת-אחת
ומעלה.

את המשוואה הפונקציונאלית שאנחנו צריכים קל לקבל מתוך המשוואה הבאה, שקל לבדוק באמצעות הצבה.
]

#if (false) { [
== בדיקה כי $a(x)$ היא פונקציית שוורץ

#let a_for_x_in_r8 = $
integral_(-1)^(i) phi0(-1/(z+1)) (z+1)^2  e^(pi i abs(x)^2 z) dif z + integral_(1)^(i) phi0(-1/(z-1)) (z-1)^2  e^(pi i abs(x)^2 z) dif z \
     & -2 integral_0^(i) phi0(-1/z) z^2  e^(pi i abs(x)^2 z) dif z 
      + 2 integral_(i)^(i infinity) phi0(z)  e^(pi i abs(x)^2 z) dif z
$

// Alt, simpler version:
#let a_for_x_in_r8_single_integral = $
integral_0^(i infinity) phi0(-1/z) z^2  e^(pi i abs(x)^2 z) dif z
$

נסתכל על הפונקציה שקיבלנו:

$ a(x) =& #a_for_x_in_r8_single_integral $

מפיתוח פורייה שראינו, נסיק כי
$phi0(z) = O(e^(-2 pi i z))$
כאשר
$Im(z) -> infinity$,
ולכן האינטגרל מתכנס בהחלט ובמידה שווה והפונקציה 
$a(x)$
מוגדרת לכל
$x in RR^8$.

#speaker-note[
  מתקיים גם
$phi0(-1/z) z^2  e^(pi i r^2 z) -> 0$
כאשר
$Im (z) -> infinity$,
ולכן נוכל לשנות את מסלול האינטגרציה.
]

נותר לנו לוודא כי
$a(x)$
הינה פונקציית שוורץ.
הדרך לעשות זאת היא באמצעות חסמים אסימפטוטיים על המקדמים של פיתוח פורייה של
$phi0$,
המקיימים:

$ c_(phi0)(0) = 0, |c_(phi0)(n)| <= 2 e^(4 pi sqrt(n)) $

אז ישנו קבוע
$C$
כך שלכל
$Im(z) > 1/2$,
$|phi0(z)| <= C  e^(-2 pi Im(z))$,
וניתן לחסום את האינטגרל.

]}

== מציאת ערכי הפונקציה על הסריג ובראשית

כדי למצוא את הערכים של
$a(r)$
עבור
$r=0$
ו-
$r=sqrt(2)$,
נשתמש בהערכה הבאה של
$phi0$:

#speaker-note[
  נובע מהמשוואה הפונקצינאלית שראינו קודם
]

// This is Prop 3 (38) in the paper.

$

phi0(i/t) t^2 = 36 / (pi^2) e^(2 pi t) - 8640 / pi t + 18144 / pi^2 + O(t^2 e^(-2 pi t))

$ <phi0-estimate-for-approx>

עבור
$r > sqrt(2)$
נוכל לחשב
את האינטגרל המתאים על שלושת הגורמים הראשונים ולקבל:

$

tilde(a)(r) = 4i sin^2(pi r^2 \/ 2)  (&
    36 / (pi^3 (r^2 - 2)) - ... 
    &+ integral_0^infinity (t^2 phi0(i / t) - 36 / (pi^2 e^(2 pi t)) + ...) e^(-pi r^2 t) dif t
)

$

$tilde(a)(r)$
אנליטית בסביבה כולשהי ב-
$[0, infinity)$
וכך גם
$a(r)$.
אז הן שוות בתחום כולו, ובאמצעות גבול נקבל:

$
a(sqrt(2)) &= lim_(r->sqrt(2)) 4i sin^2(pi r^2 \/ 2)  (36 / (pi^3 (r^2 - 2)) - ...) 
& = 0, a(0) = (-i 8640) / pi
$

 #speaker-notes-slide[

כזכור, כאשר הגדרנו את
A
התמקדנו בתחום בו
R
גדול משורש-2.
אנחנו יודעים ששם מתקבלים האפסים הדרושים, אבל אנחנו צריכים לבדוק את הערכים שלה בראשית וכאשר
R=$sqrt(2)$.

אם נשתמש במשוואה הפונקציונאלית שראינו קודם, נוכל להשתמש בפיתוחי פורייה של ה
EKים
השונים על מנת לקבל את ההערכה הבאה של פהאי-0:

בתחום
$r>sqrt(2)$,
ניתן לחשב את האינטגרל על הגורמים הראשונים, ולקבל צורה כזו של
A:
יש לנו את הסינוס המקורי, והוצאנו מתוך האינטגרל את שלושת הגורמים הראשונים,
ומחסרים אותם בחזרה בפנים.

קיבלנו פונקציה אנליטית בסביבה כולשהי באפס-עד-אינסוף. אבל גם
A
המקורית אנלטית בסביבה כולשהי שם, ולכן הן שוות בכל התחום.

עכשיו, נוכל להשתמש בצורה החדשה שמצאנו כדי למצוא את הערכים באמצעות גבול פשוט.
\
למשל את
A
ב
$sqrt(2)$
נקבל באמצעות הגבול הבא, שניתן לפתור באמצעות כלל לופטיל ולקבל 0 (כפי שדרוש לנו).
]

== הפונקציה העצמית הנוספת

עדיין דרושה לנו פונקציה המקיימת
$b(x) = -hat(b)(x)$.
נשתמש בפונקציות מקודם ונסמן

#let psiI = $psi_I$
#let psiT = $psi_T$
#let psiS = $psi_S$

$

// This is the form used in the Cohn paper (before 7.2),
// except they have -32 (but we place the -4 in the b-for-r func).

psiI := 128 (theta_00^4 + theta_01^4) / theta_10^8 + 128 (theta_01^4 - theta_10^4) / theta_00^8 \

// Original psi_T and psi_S from the paper.
// psiT = 128 (theta_00^4 + theta_01^4) / theta_10^8 + 128 (theta_00^4 + theta_10^4) / theta_01^8 \
// psiS = -128 (theta_00^4 + theta_10^4) / theta_01^8 - 128 (theta_10^4 - theta_01^4) / theta_00^8 \

$

באמצעותה, נגדיר את הפונקציה הבאה 

$ b(r) := -4 sin^2(pi r^2 \/ 2) integral_0^(i infinity) psiI(z) e^(pi i r^2 z) dif z  $ <b-for-r-gt-sqrt-2>


ו-
$b(x)$
היא הפונקציה העצמית הנדרשת,
ו-
$b(0) = 0, b(sqrt(2)) = 0$.


 #speaker-notes-slide[

אז מצאנו את הפונקציה העצמית הראשונה, אבל עדיין דרושה לנו פונקציה
עצמית של מינוס 1.


נשתמש בפונקציות תטא שהגדרנו קודם כדי להגדיר את
פסאי-I.

נציב אותה בתבנית דומה לתבנית שהשתמשנו בה מקודם, ובאופן דומה ניתן לפרק את הסינוס ולבדוק שהיא אכן מקיימת זאת.

אפשר גם לבצע הערכה ולחשב אינטגרל וגבול כפי שעשינו מקודם, ולבדוק שהיא מקבלת אפסים בשתי הנקודות  הנוספות.
]

== בדיקת החסמים המתאימים <proof-g-satisfies-lin-bounds>

נגדיר את

#filled-block[
$ g(x) := (pi i) / 8640 a(x) + i / (240 pi) b(x) $
]
וזו היא פונקציית הקסם הדרושה לנו!
\
נוכל להציב ולקבל כי
$abs(x) = sqrt(2) => g(x) = 0$.


מכיוון ש-
$a(0) = (-i 8640) / pi$
ו-
$b(0) = 0$,
נקבל גם כי
$g(0) = hat(g)(0) = 1 > 0$.

נותר לנו רק להוכיח את שני התנאים האחרים, כלומר:
#align(center)[
$hat(g)(y) >= 0$ לכל $y in RR^n$

$g(x) <= 0$ לכל $|x| >= r$
]


 #speaker-notes-slide[

כמעט סיימנו! נגדיר את
G
בתור הסכום הבא של שתי הפונקציות שמצאנו, וזו תהיה פונקציית הקסם הדרושה לנו!

אפשר לוודא באמצעות הצבה שהתנאי הראשון, כלומר ש
G
ו
G-האט
יהיו שוות וחיוביות ב0 מתקיים.

אבל, אנחנו עדיין צריך להוכיח את שני התנאים האחרים: כלומר ש
G-האט
אי שלילית בכל המרחב

ו-G שלילית או אפס לכל
Xגדול-שווהR.
]

==
סקיצה של ההוכחה לכך ש-
$g(x) <= 0$
לכל
$abs(x) > sqrt(2)$.
נציג את הפונקציה כך:

$
g(r) = pi / 2160 sin^2(pi r^2 \/ 2) integral_0^(infinity) A(t) e^(- pi r^2 t) dif t, space

A(t) = -t^2 phi0(i \/ t) - 36/pi^2 psiI(i t) \
$

נראה ש-
$A(t) < 0$
בקטע האינטגרציה, ונסיק כי 
$g$
אינה מקבלת ערכים חיוביים לכל
$r>sqrt(2)$.

#let A0 = $A_0^((n))$
#let A0m = $A_0^((m))$
#let A06 = $A_0^((6))$

בקטע
$(0,1]$
נסמן את
$A0$:
// A(t) &= -t^2 phi0(i \/ t) + 36/pi^2 t^2 psiS(i \/ t), 
$A(t) = A0(t) + O(t^2 e^(- pi n \/ t))$.

#speaker-note[
כלומר,
$A0(t)$
היא פונקציה המקרבת את 
$A(t)$
בסביבת 0, עד כדי גורם
$t^2 e^(- pi n \/ t)$.
]

#let R0(m) = $(t^2 + 36/pi^2) sum_(n=#m)^infinity 2 e^(2 sqrt(2) pi sqrt(n)) e^ (-pi n \/ t)$
#let Rinf(m) = $(t^2 + 12/pi t + 36/pi^2) sum_(n=#m)^infinity 2 e^(2 sqrt(2) pi sqrt(n)) e^ (-pi n t)$

באמצעות חסמים על המקדמים של פיתוח פורייה, ניתן לחסום את השגיאה
$abs( A(t) - A0m(t) )$.

$A06(t) < 0$,
ו-
$abs( A(t) - A06(t) )  &<= abs(A06(t))$,
ולכן 
$A(t) < 0$
כאשר
$t in (0,1]$.

הערכות דומות ניתן לקבל בקטע
$(1, infinity)$,
ותהליך דומה מאפשר להוכיח כי
$hat(g)(y) >= 0$ לכל $y in RR^n$.



 #speaker-notes-slide[


אני רוצה להציג רק סקיצה של ההוכחה לכך ש
G אינה חיובית לכל
איקס גדול משורש-2.

אם נסמן ב
A-גדולה
את הפונקציה הפנימית באינטגרל,
מספיק שנראה ש
A שלילית בכל קטע האינטגרציה, ומכך נסיק ש
G
אינה מקבלת ערכים חיובים לכל
$r>sqrt(2)$.

נחלק את הקטע מ0עד-אינסוף לשני חלקים, ובכל אחד מהם נמצא הערכה של
A.

// בקטע אפס-עד-אחת, אפשר לסמן את 
// A-אפס-N,
// שהיא פונקציה המקרבת את 
// $A$
// בסביבת 0, עד כדי גורם
// $t^2 e^(- pi n \/ t)$.

באמצעות חסמים על המקדמים של פיתוח פורייה של שתי הפונקציות שבנינו, אפשר לחסום את השגיאה של ההערכה הזאת, וכאשר
N=6
ניתן לראות גם ש
A-אפס-6 קטנה מ0 בקטע, וגם שהשגיאה קטנה ממנה, 
ולכן גם
A
עצמה שלילית בקטע.

אפשר לקבל הערכה דומה בקטע אחת-עד-אינסוף, ותהליך דומה מאפשר להוכיח ש
G-האט אי שלילית.
]

==

אז,
$g(x)$
היא פונקציית הקסם הדרושה,
ועל כן הצפיפות המירבית ב-
$RR^8$
הינה
$ vol(B_(sqrt(2) \/ 2)^8) = pi^4 / 384 = 0.2538 ... $

מכיוון שזו הצפיפות שקיבלנו עבור
$E_8$,
הוכחנו כי היא אכן אריזה בעלת הצפיפות הגבוהה ביותר האפשרית במימד זה.
$square$

 #speaker-notes-slide[

אז!
G
היא פונקציית הקסם הדרושה לנו, ולכן הצפיפות המירבית ב
R8
היא 
פאי-ברביעית חלקי 384.

מכיוון שזו הצפיפות שקיבלנו עבור האריזה
E8,
הוכחנו כי היא אכן אריזה בעלת הצפיפות הגבוהה ביותר האפשרית במימד זה.


תודה!
]