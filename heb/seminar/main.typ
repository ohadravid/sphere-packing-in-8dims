#import "template.typ": *

// Take a look at the file `template.typ` in the file panel
// to customize this template and discover how it works.
#show: project.with(
  title: "סמינר בנושא אריזת כדורים במימד 8",
  authors: (
    "אוהד רביד",
  ),
)

#let vol = math.op("vol", limits: true)


// Set numbering of equations to only include labeled ones.

#set heading(numbering: "1.")

#import "i-figured.typ"

// this resets all figure counters at every level 1 heading.
// custom figure kinds must be added here.
#show heading: i-figured.reset-counters.with(extra-kinds: ("atom",),)
// this show rule is the main logic, custom prefixes for custom figure kinds
// can optionally be added here.
#show figure: i-figured.show-figure.with(extra-prefixes: (atom: "atom:",))

// a similar function exists for math equations
#show math.equation: i-figured.show-equation.with(only-labeled: true)

// Remove the prefix before the equation number when referencing it.

#set ref(supplement: "")

#outline(title: "תוכן עניינים", depth: 2, indent: auto)

#pagebreak()

= הקדמה

אריזת כדורים
(Sphere Packing) 
היא בעיה גיאומטרית העוסקת בשאלה פשוטה לכאורה:


#align(center)[
מה היא הדרך היעילה ביותר למקם כדורים במרחב?
]


ולא רק שהשאלה פשוטה לכאורה, אפילו קל לנחש את התשובה הנכונה: 

לדוגמה, במרחב התלת המימדי ערימת התפוזים הנפוצה 
בסופר היא אכן היעילה ביותר!

את העומק והקושי האמיתיים נמצא בבואנו לנסות ולהוכיח כי זו אכן התשובה הנכונה: כלומר, שלא ניתן למצוא סידור יעיל אף יותר.

סמינר זה יעסוק בתשובה (ובשאלה!) ב- 
$RR^8$, 
אחד מבין שני המימדים הגבוהים היחידים בהם התשובה ידועה.

== תוכנית פעולה

נפתח, כצפוי, בהגדרות שבאמצעותן נוכל לדבר על הבעיה בדיוק הנדרש (למה הכוונה ב"צפיפות יעילה ביותר"? ואיך מגדירים "אריזה"?),
ונציג את האריזה המרכזית בה נעסוק, הנקראת
$E_8$.

#let CnE = [Cohn ו Elkies]

#let Viaz = [Viazovska]

לאחר מכן, נכין את הקרקע ונביא את הטענה התיאורטית המרכזית הראשונה שלנו, 
התוצאה של 
$CnE$,
שבאמצעותה נוכל להפוך את הבעיה הגיאומטרית לבעיה באנליזה: \
נראה כי מציאתה של פונקציה המקיימת מספר תכונות ייחודיות,
מאפשרת להוכיח כי עבור מימד מסויים ישנו חסם לצפיפות המירבית, ולכן אם אריזה מסוימת הינה בעלת אותה צפיפות, היא גם היעילה ביותר במימד מסוים.

לבסוף, נוכיח כי הפונקציה שמצאה
$Viaz$
אכן מקיימת את כל התכונות האלו, ולפיכך מוכיחה כי
$E_8$
היא האריזה היעילה ביותר ב-
$RR^8$.

#pagebreak()

= הגדרות  ראשונות

בעיית אריזת הכדורים עוסקת בשאלה: מה הוא החלק הגדול ביותר של
$RR^n$
הניתן לכיסוי בכדורים בעלי רדיוס שווה שאינם נחתכים?

#let Pkg = math.cal([P])

_אריזת כדורים_
(_sphere packing_)
היא תת קבוצה לא ריקה של
$RR^n$
של כדורים בעלי רדיוס שווה, שהפנימים שלהם זרים זה לזה (אך מותר שיהיו משיקים).

#let Ball = $ B_r^n $
#let HalfBall = $ B_(r \/ 2)^n $

אנו נסמן ב-
$Ball(x)$
כדור סגור ברדיוס
$r$
שמרכזו ב
$x$.


_הצפיפות העליונה_
(_upper density_)
של אריזה כלשהי
$Pkg$
היא 

$ limsup_(r->infinity) vol(Ball(0) sect Pkg) / vol(Ball(0)) $

כאשר אנו משתמשים במרחב האוקלידי הרגיל ו
$vol$
הינה מידת לבג.

#let spherepackingdensity = $Delta_(RR^n)$


_
צפיפות אריזת הכדורים ב-
$RR^n$
_
, אותה נסמן ב-
$spherepackingdensity$,
היא הסופרימום של כל הצפיפויות העליונות.

על פניו, הגדרה זו אינה מבטיחה כי צפיפות זו אכן מתקבלת על ידי אריזה כולשהי, אך אנו נסתמך על תוצאה שהוכיח
Groemer @Groemer1963,
לפיה קיימת אריזה
$Pkg$
עבורה

$ lim_(r->infinity) vol(Ball(x) sect Pkg) / vol(Ball(x)) = spherepackingdensity $

במידה שווה לכל
$x in RR^n$.
הווה אומר - ישנה אריזה עבורה מתקבלת הצפיפות המירבית.

== סְרִיגִים ואריזות מחזוריות

סָרִיג
(_lattice_)
ב-
$RR^n$
הוא תת חבורה מדרגה
$n$,
אשר מורכבת מבסיס של
$RR^n$
בתוספת כל צירוף לינארי בעל מקדמים שלמים של בסיס זה (לצירוף כזה נקרא גם _צירוף אינטגרלי_, ולבסיס נקרא _בסיס אינטגרלי_).

פורמאלית, אם 
$B$
הוא בסיס מסוים של 
$RR^n$,
אז הסריג
$Lambda$
ניתן להצגה בצורה הבאה:

$ Lambda := {a_1 v_1 + ... + a_n v_n | a_i in ZZ , v_i in B} $

באמצעות מושג הסריג נוכל להגדיר גם _אריזה מחזורית_.

אריזת כדורים
$Pkg$
היא _מחזורית_
(_periodic_)
אם קיים סריג
$Lambda$
כך ש
$Pkg$
נשמרת תחת הזזה בכל איבר מ-
$Lambda$.
או, בסימנים:

$ Pkg = Pkg + v,  forall v in Lambda $

_אריזת סריג_ (_lattice packing_)
היא אריזה מחזורית בה כל מרכזי הכדורים נמצאים על סריג, עד כדי הזזה (כי סריג תמיד כולל את הראשית, מגבלה שאינה רצויה עבור אריזות).


לדוגמה, אם ניקח את הבסיס

$ B = {(0,4), (4,0)} subset RR^2 $

נוכל לבנות באמצעותו את הסריג

$ Lambda = {(4n, 4m) | n,m in ZZ} $

מכיוון שהתחלנו מסריג, גם האריזה
$Pkg_1 = {B^2_1(x) | x in Lambda}$
היא אריזת סריג, \ וגם 
$Pkg_2 = {B^2_1(x + (1, 1)) | x in Lambda}$
היא אריזת סריג.

אך ישנן כמובן אריזות מחזוריות שאינן אריזות סריג.

#pagebreak()

למשל,

$ Pkg_3 = {B^2_(1\/2)(x) | x in Lambda union (Lambda + (1,0))} $

הינה אריזה מחזורית (וודאי שהיא נשמרת תחת הזזה בכל איבר מ- 
$Lambda$),
אך היא אינה אריזת סריג. 
נוכל להראות זאת כך:
נניח כי קבוצת מרכזי הכדורים ב-
$Pkg_3$
היא סריג, שנסמנו
$Lambda_B$,
ונסמן את הבסיס המתאים
$B = {(a,b), (c,d)}$.

נשים לב כי וקטור
$(x,y)$
בסריג אם ורק אם
$
x mod 4 in {0, 1}\
y mod 4 = 0
$

ווקטור שאינו בסריג כמובן שאינו איבר של הבסיס, וקל גם לראות כי
$(1,t) in.not B$,
כי אחרת 
$(2,2t) in Lambda_B$.

למעשה, כל ווקטור
$(x, y)$
עבורו
$x mod 4 = 1$
לא יכול להיות איבר של הבסיס מאותה הסיבה, \
ונסיק כי
$a,b,c,d$
מתחלקים כולם ב-
$4$.
אבל אז לא נוכל לקבל למשל
$(5,0) in Lambda_B$.

כלומר לא קיים בסיס כזה, ולכן האריזה אינה אריזת סריג.

== צפיפות של אריזת סריג

מכיוון שאנו עוסקים בצפיפות של אריזות כדורים, טבעי שנרצה לחשב צפיפות של אריזות סריג.

נוכל לעשות זאת ביתר קלות אם נחשוב על הסריג כריצוף של המרחב באמצעות מקבילונים.

_התא היסודי_ (_fundamental cell_)
של אריזת כדורים המבוססת על סריג
$Lambda$
שהבסיס שלו הוא
$B$
ניתן להצגה כך:

$ C := {x_1 v_1 + ... + x_n v_n | 0 <= x_i <= 1 , v_i in B} $

הזזות של התא היסודי באמצעות איברים של
$Lambda$
מרצפת את המרחב, ואריזת הסריג הינה מיקום של כדורים בכל צומת של ריצוף זה.

מכיוון שבמרחב ישנו כדור אחד לכל עותק של התא, עבור רדיוס
$r$
כלשהו נוכל לחשב את הצפיפות באמצעות היחס
$ vol(Ball) / vol(C) $

כאשר את נפח הכדור נקבל מהנוסחה

$ vol(Ball) = pi^(n \/ 2) / (n \/ 2)! r^n $

מהקורס חשבון אינפיניטסימלי 3,
ואת נפח המקבילון נוכל לחשב באמצעות הדטרמיננטה.

בסך הכל, נקבל כי הצפיפות של אריזת סריג היא

$ vol(Ball) / vol(RR^n \/ Lambda) $ <packing-vol>

את הרדיוס מקובל לבחור באמצעות _אורך הווקטור המינימאלי_ של הסריג
$Lambda$
, שהוא האורך הקטן ביותר של ווקטור בסריג (שאינו ווקטור האפס).

אם אורכו של ווקטור זה הוא
$d$,
אז הרדיוס הגדול ביותר בו נוכל להשתמש הוא
$r = d \/ 2$
מכיוון שבאמצעותו נקבל כדורים משיקים.


#pagebreak()

== הגדרה ותכונות בסיסיות של $E_8$

אנו נעסוק באריזה
$E_8$,
שהיא אריזת כדורים סימטרית במיוחד במימד
$RR^8$.

נציג את הסריג עליו היא מבוססת,
$Lambda_8$,
ונוכיח מספר תכונות חשובות וייחודיות שלו.

$ Lambda_8 = { (x_1, ... , x_8) in ZZ^8 union (ZZ + 1/2)^8 mid(|) sum^8_(i=1)x_i equiv 0 (mod 2) } $

כלומר, הסריג שמכיל את כל הווקטורים שכל מקדמיהם שלמים או שכל מקדמיהם נבדלים בחצי משלם, ושסכומם זוגי.

נוכל גם לראות כי
$Lambda_8$
סגור לחיבור, אם נשים לב שכאשר

$ 
x in Lambda_8 , y in Lambda_8 
$

אז
$ x + y in ZZ^8 union (ZZ + 1/2)^8$
, כי בדיוק אחד מהמקרים הבאים מתקיים:

$ 
x, y in ZZ^8  &=> x + y in ZZ^8 \
x in ZZ^8 and y in (ZZ + 1/2)^8  &=> x + y in (ZZ + 1/2)^8 \
y in ZZ^8 and x in (ZZ + 1/2)^8  &=> x + y in (ZZ + 1/2)^8 \
x, y in (ZZ + 1/2)^8  &=> x + y in ZZ^8 \
$

ומכיוון שסכום זוגיים הינו זוגי, 

$
sum^8_(i=1)x_i equiv 0 (mod 2) and sum^8_(i=1)y_i equiv 0 (mod 2) => \
sum^8_(i=1) x_i+y_i = sum^8_(i=1)x_i + sum^8_(i=1)y_i equiv 0 (mod 2)
$

האריזה
$E_8$
היא אריזת הסריג המבוססת על
$Lambda_8$.


#pagebreak()

=== בחירת בסיס עבור $Lambda_8$

מכיוון ש
$E_8$
הינה אריזת סריג, נרצה לפנות להגדרת הסריג על מנת להוכיח את התכונות שידרשו לנו בהמשך.
לשם כך, דרוש לנו בסיס.

// From p. 34, after Proposition 12., in D. Zagier:
נשתמש בבסיס הבא, אותו נגדיר ביחס לבסיס הסטנדרטי של
$RR^8$, $e_1, ... , e_8$: \
$B = {v_1, ... , v_8}$
כאשר
$v_i = e_i - e_(i+1)$
עבור
$1<=i<=6$,
$v_7 = e_6 + e_7$
ו-
$v_8 = -1/2 (e_1 + ... + e_8)$.

נראה כי זה הוא אכן בסיס אינטגרלי לסריג.

נתחיל בכך שנראה כי כל צירוף אינטגרלי של אברי הבסיס נמצא בסריג. נסמן

$ u = z_1 v_1 + ... + z_8 v_8 = (t_1, ..., t_8) | z_i in ZZ $

ראשית, נשים לב כי תכונת הזוגיות של
$Lambda_8$
מתקיימת:

$ z_1(-1+1) + .. +z_6(-1+1) + z_7 (1+1) + z_8 (-1/2 *8) = 2z_7 -4z_8 equiv 0 (mod 2) $

מכיוון ש:

$
  t_1 &= z_1 - 1/2 z_8 \
  t_2 &= z_2 - z_1 - 1/2 z_8 \
  &space dots.v \
  t_5 &= z_5 - z_4  - 1/2 z_8 \
  t_6 &= z_6 - z_5 + z_7 - 1/2 z_8 \
  t_7 &= z_7 - z_6 - 1/2 z_8 \
  t_8 &= -1/2 z_8 \
$

אז כאשר
$z_8 equiv 0 (mod 2)$,
נקבל כי
$t_i in ZZ$
ולכן
$u in ZZ^8$,
ואילו אם
$z_8 equiv 1 (mod 2)$,
אז
$u in (ZZ+1/2)^8$,
כלומר
$u in Lambda_8$,
כפי שרצינו.

בכיוון השני, יהי
$w= (t_1, ... , t_8) in Lambda_8$.
נראה כי קיימים
$z_i in ZZ$
כך ש
$w = z_1 v_1 + ... + z_8 v_8$.

נסתמך על אותן משוואות שמצאנו מקודם, ונבחר
$z_8 = t_8 * -2$.
מיד נקבל 
$z_1 = t_1 - t_8$, $z_2 = t_2 + t_1 - 2 t_8$
כאשר תכונת הסריג מבטיחות כי נקבל שלמים בכל צעד.

נוכל להמשיך לפתור את המשוואות שראינו מקודם, אחת אחרי השניה עד
$z_5 = t_5 + t_4 + t_3 + t_2 + t_1 - 5 t_8$.

לאחר מכן, נקבל

$
t_6 &= z_6 - (t_5 + ... + t_1 - 5 t_8) + z_7 + t_8 \
t_7 &= z_7 - z_6 + t_8
$

נוכל לסכום ולקבל

// Note: -7t_8 = +t_8 -8t_8
$
2 z_7 = t_1 + ... + t_5 + t_6 + t_7 + t_8 - 8 t_8
$

אנו יודעים כי
$sum^8_(i=1)t_i equiv 0 (mod 2)$,
וכמובן שגם
$8t_8$
זוגי, ולכן ישנו 
$z_7$
המבוקש, ובאמצעותו נוכל למצוא גם את
$z_6$.

// Note: for z_6 = z_7 - t_7 + t_8, we know that (t_7 + t_8) is integer.

כלומר, מצאנו ייצוג של 
$w$
באמצעות צירוף אינטגרלי של אברי הבסיס,
כפי שרצינו.

#pagebreak()

=== מטריצת Gram של $Lambda_8$

במקום להוכיח תכונות ישירות באמצעות אברי הבסיס, נוכל להשתמש במטריצת
Gram
שלו.

קל לראות כי
$angle.l v_i, v_i angle.r = 2$,
וכי
$angle.l v_i, v_(i+1) angle.r = -1$
, מלבד המקרה
$angle.l v_6, v_7 angle.r = 0$.

בנוסף, המכפלה
$angle.l v_i, v_j angle.r$
מתאפסת בכל מקרה אחר, מלבד
$angle.l v_5, v_7 angle.r = -1$.

כלומר, המטריצה המתאימה הינה

$ (angle.l v_i, v_j angle.r)_(1<=i,j<=8) = mat(delim: "[",
   2, -1,  0,  0,  0,  0,  0,  0; // 1
  -1,  2, -1,  0,  0,  0,  0,  0; // 2
   0, -1,  2, -1,  0,  0,  0,  0; // 3
   0,  0, -1,  2, -1,  0,  0,  0; // 4
   0,  0,  0, -1,  2, -1, -1,  0; // 5
   0,  0,  0,  0, -1,  2,  0,  0; // 6
   0,  0,  0,  0, -1,  0,  2, -1; // 7
   0,  0,  0,  0,  0,  0, -1,  2; // 8
) $

// The original matrix from the paper has a different order, but it doesn't matter as the new matrix has the same poly:
// https://www.emathhelp.net/en/calculators/linear-algebra/characteristic-polynomial-calculator/?i=%5B%5B2,-1,0,0,0,0,0,0%5D,%5B-1,2,-1,0,0,0,0,0%5D,%5B0,-1,2,-1,0,0,0,0%5D,%5B0,0,-1,2,-1,0,0,0%5D,%5B0,0,0,-1,2,-1,-1,0%5D,%5B0,0,0,0,-1,2,0,0%5D,%5B0,0,0,0,-1,0,2,-1%5D,%5B0,0,0,0,0,0,-1,2%5D%5D

המטריצה כמובן סימטרית, וקל לראות כי היא גם חיובית לחלוטין.

הפולינום האופייני של המטריצה, שהוא

$ t^8 - 16t^7 + 105t^6 - 364t^5 + 714t^4 - 784t^3 + 440t^2 - 96t + 1 $

תמיד חיובי כאשר 
$t<0$,
מכיוון שאז אין לו איברים שלילים, ולכן נוכל להסיק כי כל האפסים שלו, כלומר הערכים העצמיים של המטריצה, חיוביים ממש, ולכן היא אכן חיובית לחלוטין.

=== תכונות נוספות של $Lambda_8$

$Lambda_8$
הוא _סריג אינטגרלי_
(_integral lattice_),
כלומר כל המכפלות הפנימיות בין אברי הבסיס שלו שלמות (כפי שראינו מקודם).

בנוסף,
$Lambda_8$
הוא _סריג זוגי_
(_even lattice_),
כלומר ריבוע האורך של כל ווקטור בו הוא שלם וזוגי. נוכל לראות זאת אם נשים לב שלכל
$m_i in ZZ$
מתקיים

$ lr(| m_1 v_1 + ... + m_8 v_8 |)^2 &= 2m^2_1 + ... + 2m^2_8 + sum_(1<=i,j<=8) 2m_i m_j angle.l v_i, v_j angle.r $

אז ממטריצת גראהם שראינו נובע כי גם ריבוע האורך זוגי, ובפרט כי המרחק בין כל שתי נקודות ב-
$Lambda_8$
הוא מהצורה
$sqrt(2k)$,
ובין שתי נקודות סמוכות
הוא
$sqrt(2)$
.

מכך נובע כי נוכל לבחור אריזת סריג בעלת
$r=sqrt(2) / 2$
,
אותה נסמן ב-
$E_8$.

צפיפותה, על פי
@eqt:packing-vol,
מתקבלת על ידי

$ vol(B^8_(sqrt(2) \/ 2)) / vol(RR^8 \/ Lambda_8) = pi^4 / (384 vol(RR^8 \/ Lambda_8)) $

וכל שנותר לנו הוא לחשב את 
$vol(RR^8 \/ Lambda_8)$
על מנת שנוכל לחשב את צפיפות האריזה.

מתכונות הדטרמיננטה, נקבל כי

$ vol(RR^8 \/ Lambda_8) = lr(| 
det mat(delim: "[",
  <- v_1 ->;
  <- v_2 ->;
  dots.v ;
  <- v_8 ->;
) 
|) $

#pagebreak()

אבל את מטריצת גראהם שמצאנו מקודם נוכל גם לכתוב בתור

$
mat(delim: "[",
  <- v_1 ->;
  <- v_2 ->;
  dots.v ;
  <- v_8 ->;
)

mat(delim: "[",
  arrow.t , arrow.t ,     , arrow.t ,  ;
  v_1     , v_2     , ... , v_8     ,  ;
  arrow.b , arrow.b ,     , arrow.b ,  ;
)
$

ולכן

// Note, that this is det(Grahm) = det(v_i * v_j), not det(B) = det([v_i]).

$
vol(RR^8 \/ Lambda_8) = sqrt(lr( ( det (angle.l v_i, v_j angle.r)_(1<=i,j<=8) ) ))
$

אבל מהפולינום האופייני אנו יודעים כי 
$ det (angle.l v_i, v_j angle.r)_(1<=i,j<=8) = 1 $

ולכן 

$
vol(RR^8 \/ Lambda_8) = 1
$

ולמעשה הוכחנו כי הצפיפות של
$E_8$
היא

$ pi^4 / 384 = 0.2538 ... $ <e8-packing-density>

#pagebreak()

=== הדואליות של $Lambda_8$ <dual-of-lambda-8>

לבסוף, אנו זקוקים לתכונה אחת נוספת של
$Lambda_8$:
שהוא יהיה _הסריג הדואלי_
(_dual lattice_)
של עצמו.

עבור סריג
$Lambda$
בעל בסיס מסוים
$v_1, ..., v_n$
ישנו סריג
$Lambda^*$,
לו נקרא הסריג הדואלי
שהוא בעל הבסיס
$v^*_1, ..., v^*_n$
המקיים

$
angle.l v_i, v^*_j angle.r = cases(
  1 "if" i = j "," "and",
  0 "otherwise"
)
$

זהו הסריג הדואלי,
ואם
$Lambda = Lambda^*$
אז נאמר ש
$Lambda$
הוא הסריג הדואלי של עצמו.

// Proof of Lemma 3.2 in the paper, but using https://math.stackexchange.com/a/4465380

נוכיח כי
$Lambda_8$ 
הוא כזה באמצעות טענה כללית יותר: כל סריג שמטריצת
Gram שלו היא
_אוּנִימוֹדוּלָרִית_ (_unimodular_),
כלומר מטריצה שכל איבריה שלמים ובעלת דטרמיננטה $1$ או $-1$,
הוא הדואלי של עצמו.

#let adj = math.op("adj")

יהי סריג
$Lambda$
בעל מטריצה
$A$
כזו.

המטריצה המצורפת,
$adj(A)$,
מקיימת
$A^(-1)=1/det(A) adj(A)$
(מסקנה 4.7.3 בקורס אלגברה לינארית 1).

מכיוון שהיא מבוססת על מינורים של המטריצה המקורית,
$adj(A)$
אינטגרלית,
ומכך שהדטרמיננטה של
$A$
היא
$1$ או
$-1$,
נקבל כי גם
$A^(-1)$
אינטגרלית.

נסמן ב-
$M: Z^n -> RR^n$
את ההעתקה הלינארית ביחס לבסיס
$B = {v_1, ... , v_n}$
של
$Lambda$,
כלומר

$ M vec(a_1, ... , a_n) := a_1 v_1 + ... + a_n v_n $

אז
$M$
היא מטריצה שעמודותיה הם ווקטורי הבסיס, ומטריצת
Gram
של
$Lambda$
היא
$A = M^T M$.

על פי הגדרת הסריג, 
$ Lambda = M ZZ^n $

נסמן ב-
$D$
את הבסיס של הסריג הדואלי
$Lambda^*$.

ישירות מההגדרה נקבל כי
$M^T D = I$,
כלומר
$D = (M^T)^(-1)$.

אבל שוב מהגדרת הסריג

$ Lambda^* = D ZZ^n = (M^T)^(-1) ZZ^n $

נוכל להחליף
$(M^T)^(-1) = M (M^T M)^(-1)$
ולקבל

$ Lambda^* = M (M^T M)^(-1) ZZ^n = M A^(-1) ZZ^n $

אבל מכיוון ש-
$A^(-1)$
אינטגרלית, נקבל כי
$A^(-1) ZZ^n subset.eq ZZ^n$.

אבל גם
$A$
אינטגרלית,
ולכן
$A ZZ^n subset.eq ZZ^n$.
אז
$I ZZ^n = A^(-1) A ZZ^n subset.eq A^(-1) ZZ^n$.

כלומר
$ A^(-1) ZZ^n = ZZ^n $

ולכן
$ Lambda^* = M ZZ^n = Lambda $

כפי שרצינו להוכיח.

כבר ראינו כי מטריצת
Gram
של
$Lambda_8$
בעלת איברים שלמים וכי הדטרמיננטה שלה היא $1$,
ולכן נוכל להסיק כי הוא הדואלי של עצמו.

#pagebreak()

= שימוש באנליזה הרמונית למציאת חסמים לצפיפות <harmonic-analysis-and-enc>

לאחר שהגדרנו מה היא צפיפות, ואחרי שהגדרנו את אריזת הסריג
$E_8$
ואת התכונות העיקריות שלה, ניגש לבעיה המרכזית בה נעסוק: כיצד ניתן להוכיח מה היא הצפיפות הגבוהה ביותר האפשרית במימד מסוים?

אם נוכל להוכיח כי הצפיפות הגבוהה ביותר האפשרית ב
$RR^8$
שווה לצפיפות של
$E_8$,
הרי שבכך נוכיח כי היא אריזה אופטימאלית במימד זה.

בעיה זו מקבלת מענה בעבודתם של 
$CnE$,
שהוכיחו כי ניתן להשתמש בפונקציות עזר בעלות תכונות מסוימות, אותן נפרט מיד, כדי לחסום את הצפיפות המירבית האפשרית במימד מסוים.

הדבר נראה מפתיע, שכן טיבם של הסריגים הוא שאינם רציפים, ובעית הצפיפות הינה בכלל בעיה גיאומטרית. כיצד אנליזה של פונקציות תוכל לסייע לנו?

התובנה העיקרית נמצאת בקשר הקיים בין פונקציה והתמרת פורייה שלה, באמצעות #[_נוסחת הסכימה של פואסון_].
נציג את עיקרי התיאוריה בחלק הבא, ואז נפנה להוכחת המשפט העיקרי באמצעותה.

// Next 3 parts:
// Based on "Lectures in Analysis Vol1 - Fourier Analysis"

== פונקציות שוורץ

אנו נעסוק בפונקציות מ-
$RR^n$
ל-
$RR$
(ולעתים בפונקציות מרוכבות של משתנה ממשי).

#let Sw = $cal(S)(RR^n)$

_פונקציות שוורץ_
(_Schwartz functions_)
הן משפחה של פונקציות אותן נסמן ב-
$Sw$
או בקיצור,
$cal(S)$.

אלו הן כל הפונקציות הניתנות לגזירה אינסוף פעמים, ושמקיימות

$ sup_(x in RR^n) lr(| x^beta (diff / (diff x) )^alpha f(x) |) < infinity $

לכל
$alpha,beta in NN$,
כאשר
$(diff / (diff x) )^alpha$ היא סדרה של
$alpha$
גזירות חלקיות (לפי סדרה כולשהי של משתנים).

כלומר, קבוצת הפונקציות הזו הינה מרחב (במשמעות הרגילה של מרחב פונקציות)
הכולל את כל הפונקציות שערכן, והערך של כל נגזרת שלהן, פוחת "מהר מאוד", כלומר מהר יותר מכל פולינום.


התוצאות שנוכיח מתקיימות גם בתנאים מחמירים פחות, אך בכך שנגביל את עצמנו לעיסוק בפונקציות שוורץ נוכל להימנע מקשיים טכנים רבים,
ומכיוון שההוכחה של #Viaz, בה יעסקו הפרקים הבאים, הינה בנייה של פונקציות שוורץ - תוצאות אלו יספיקו לנו בהחלט.



== התמרות פורייה ב- $RR^n$ של פונקציות שוורץ

נגדיר את התמרת פורייה של פונקציית שוורץ
$f$
כך:

$ hat(f)(xi) = integral_(RR^n) f(x) e^(-2pi i x dot xi) dif x , "for" xi in RR^n $

אנו מבצעים אינטגרציה על המרחב כולו, כאשר
$x dot xi$
מסמן את המכפלה הפנימית בין שני הווקטורים.

אנו נשתמש גם בסימון המקובל
$f(x) -> g(xi)$
כדי לציין ש-
$g$
היא התמרת פורייה של
$f$.

להתמרת פורייה של פונקציות שוורץ מספר תכונות מעניינות:

/// Prop 2.1 in LiA @stein2011fourier page 181.

תהי
$f in Sw$, אז

1. $f(x + h) -> hat(f)(xi)e^(2pi i xi dot h)$ כאשר $h in RR^n$.
2. $f(x) e^(-2pi i x dot h) -> hat(f)(xi + h)$ כאשר $h in RR^n$.
3. $f(delta x) -> delta^(-n) hat(f)(delta^(-1) xi)$ כאשר $delta > 0$.
4. $(diff / (diff x) )^alpha f(x) -> (2pi i xi)^alpha hat(f)(xi)$.
5. $(-2pi i x)^alpha f(x) ->  (diff / (diff xi) )^alpha hat(f)(xi)$.

/// Proofs are in page 136.


#pagebreak()

נביא את ההוכחות לתכונות 4 ו- 5 למקרה החד מימדי.

תהי $f in cal(S)(RR)$.
אז עבור תכונה 4 נוכל למצוא את
$hat(f')$
באמצעות אינטגרציה בחלקים. עבור
$N in NN$,
נקבל כי

$ integral_(-N)^N f'(x) e^(-2 pi i x xi) dif x = [f(x) e^(-2 pi i x xi)]_(-N)^N + 2 pi i xi integral_(-N)^N f(x) e^(-2 pi i x xi) dif x $

נוכל לקחת את הגבול כאשר
$N -> infinity$,
ולקבל כי אכן
$f'(x) -> 2pi i xi hat(f) (xi)$.

עבור תכונה 5, נראה כי
$hat(f)$
גזירה, ונראה כי היא שווה להתמרת פורייה של
$-2 pi i x f$.

נראה כי ההפרש ביניהם קטן מכל מספר חיובי, ולכן הנגזרת קיימת והם שווים.
נקבל כי

$ (hat(f)(xi + h) - hat(f)(xi)) / h - hat((-2 pi i x f))(xi) = integral_(-infinity)^infinity f(x) e^(-2 pi i x xi) [(e^(-2 pi i x h) - 1) / h + 2 pi i x] dif x $

אנו יודעים שגם
$f(x)$
וגם
$x f(x)$
פוחתות מהר (כי הן פונקציות שוורץ).

יהי
$epsilon > 0$.
אז ישנו
$N in NN$
כך ש
$integral_(|x|>=N) |f(x)| dif x <= epsilon$,
וכן
$integral_(|x|>=N) |x|  |f(x)| dif x <= epsilon$.

בנוסף,
עבור
$|x|<=N$,
מכיוון ש-
$e^(-2 pi i x h)$
גזירה (כפונקציה של $h$)
בסביבה של
$0$
ונגזרת שם היא
$-2pi i x$, \
נסיק כי
קיים
$h_0$,
כך שלכל
$|h| < h_0$,

// Because (e^-2pi*ixh - 1) / h ~ 2pi*ix (the derivative of is -2pi*ix).

$ abs((e^(-2 pi i x h) - 1) / h + 2 pi i x) <= epsilon / N $

כלומר, לכל
$h$
כזה

$ abs( (hat(f)(xi + h) - hat(f)(xi)) / h - hat((-2 pi i x f))(xi) ) <= 
integral_(-N)^N abs(f(x) e^(-2 pi i x xi) [(e^(-2 pi i x h) - 1) / h + 2 pi i x]) dif x  + C epsilon <= C' epsilon $

כלומר, הנגזרת קיימת והיא מתקבלת על ידי התמרת פורייה של
$-2pi i x f(x)$.

משתי התכונות האחרונות נוכל להסיק כי התמרת פורייה מחליפה גזירה בכפל (עד כדי כפל בפולינום פשוט), \
כלומר * $Sw$ סגור להתמרת פורייה*.

עבור פונקציות שוורץ מתקיימת גם הזהות החשובה הבאה:

$ f(x) = integral_(RR^n) hat(f)(xi) e^(2pi i x dot xi) dif xi $ <fourier-inversion-formula>

שהיא _התמרת פורייה ההפוכה_.

/// Optional: Prove (based on Theorem 1.9, p141)

== פונקציות רדיאליות <radial-functions>

אנו נקרא לפונקציה
$f$
_רַדְיָאלִית_
(_radial_)
אם היא תלויה אך ורק ב
$|x|$.

כלומר, אם ישנה פונקציה
$f_0 (u), u >= 0$
כך ש
$f(x) = f_0(|x|)$.

/// Optional: Corollary 2.3 - Fourier of a radial function is radial

תכונה חשובה של פונקציות רדיאליות היא שהן מקיימות 
$hat(hat(f)) = f$,
כפי שנובע מהתמרת פורייה ההפוכה
@eqt:fourier-inversion-formula:

$ 
hat(hat(f))(y) &= integral_(RR^n) hat(f)(xi) e^(-2pi i xi dot y) dif xi \

&= integral_(RR^n) hat(f)(xi) e^(2pi i xi dot (-y)) dif xi \

&= f(-y) \

&= f_0(|-y|) = f_0(|y|) 

&= f(y)
$

#pagebreak()

== נוסחת הסכימה של פואסון

כדי שנוכל להפעיל כלים מתחום האנליזה על בעיית הצפיפות, נשתמש בנוסחת הסכימה של פואסון
(_Poisson Summation Formula_).

נוסחה זו מביעה את הדואליות שבין סכימת ערכים של פונקציה על סריג, לסכימה של התמרת פורייה שלה על הסריג הדואלי.

// Prop 4.2 in Cohn 2016

_נוסחת הסכימה של פואסון_ טוענת כי עבור
$f in Sw$,
מתקיימת הזהות

$ sum_(x in Lambda) f(x) = 1 / vol(RR^n \/ Lambda) sum_(y in Lambda^*) hat(f)(y) $ <poisson-sum>

כלומר, הן שוות עד כדי כפל בקבוע.


// Based on Theorem 3.1 (p153) in Lectures in Analysis Volume 1

נתחיל מהוכחת התוצאה למקרה החד מימדי.

_נוסחת הסכימה של פואסון עבור
$RR$_
טוענת כי לכל
$f in cal(S)(RR)$:

$ sum_(n=-infinity)^(infinity) f(n) = sum_(n=-infinity)^(infinity) hat(f)(n) $ <poisson-sum-for-r>

נסמן

$ F_1(x) := sum_(n=-infinity)^(infinity) f(x+n) $

מכיוון ש
$f$
פוחתת מהר מאוד (במובן שהגדרנו עבור פונקציות שוורץ),
הסדרה מתכנסת בהחלט על הישר ולכן הפונקציה רציפה.
קל לראות כי הפונקציה החדשה היא 1-מחזורית.

באמצעות פיתוח פורייה נוכל להגיע לפונקציה נוספת, שגם היא 1-מחזורית:

$ F_2(x) := sum_(n=-infinity)^(infinity) hat(f)(n) e^(2 pi i n x)  $

ניתן לראות את הקשר לפיתוח פורייה אם נסתכל על פונקציה זו בתור הגרסה הדיסקרטית של

$ space space f(x) = integral_(-infinity)^infinity hat(f)(xi) e^(2pi i x dot xi) dif xi $

אנו יודעים כי שתי פונקציות זהות אם פיתוח פורייה שלהן זהה.

עבור
$F_2$,
המקדם ה-$m$י הוא בדיוק
$hat(f)(m)$.
עבור $F_1$, מתקיים

$ 
a_m &= integral_0^1 (sum_(n=-infinity)^(infinity) f(x+n)) e^(-2 pi i m x) dif x \
    &= sum_(n=-infinity)^(infinity) integral_0^1  f(x+n) e^(-2 pi i m x) dif x \
                                                                // (y-n) => e^-2pi*i*mn = 1
    &= sum_(n=-infinity)^(infinity) integral_n^(n+1) f(y) e^(-2 pi i m y) dif y \
    &= integral_(-infinity)^infinity f(y) e^(-2pi i m y) dif y \
    &= hat(f) (m)
$

כאשר החלפת סדר הסכימה והאינטגרציה מותרת כי
$f in cal(S)$.

נסיק כי אכן
$F_1 = F_2$,
ואת התוצאה הסופית נקבל אם נציב
$x=0$.

#pagebreak()

// Prop 4.4 in Cohn 2016
// Based on https://see.stanford.edu/materials/lsoftaee261/chap8.pdf p360

ההכללה למימד
$n$
מיידית, ונקבל כי

$ sum_(x in ZZ^n) f(x) = sum_(x in ZZ^n) hat(f)(x) $ <poisson-sum-for-r-n>

אך אם נתייחס ל-
$ZZ^n$
בתור סריג, איך נוכל להרחיב את התוצאה עבור סריגים כלליים?

כפי  שעשינו בסעיפים הקודמים, נסמן ב-
$M: Z^n -> RR^n$
את ההעתקה הלינארית ביחס לבסיס
$B = {v_1, ... , v_n}$
של
$Lambda$.
אז
$M$
היא מטריצה שעמודותיה הם ווקטורי הבסיס,
ו-
$Lambda = M ZZ^n$.

ראשית,
$ sum_(x in Lambda) f(x) = sum_(x in ZZ^n) f(M x) $


כדי שנוכל להשתמש ב-
@eqt:poisson-sum-for-r-n,
דרושה לנו התמרת פורייה של
$f(M x)$.

נסמן
$g(x)=f(M x)$
ומהנוסחה נקבל כי

$ hat(g)(xi) = integral_(RR^n) f(M x) e^(-2pi i xi dot x) dif x $

נמשיך לפתח ונקבל

$ 
hat(g)(xi) &= integral_(RR^n) f(M x) e^(-2pi i xi dot x) dif x \
          &= integral_(RR^n) f(M x) e^(-2pi i xi dot (M^(-1) M x)) 1/abs(det(M)) abs(det(M))  dif x \
          &= 1/abs(det(M)) integral_(RR^n) f(M x) e^(-2pi i xi dot (M^(-1) M x)) abs(det(M))  dif x
$

אנחנו יודעים ש-
$vol(RR^n \/ Lambda) = abs(det(M))$,
ונוכל לבצע החלפת משתנים
$u=M x$
ולקבל

$
hat(g)(xi) &= 1/vol(RR^n \/ Lambda) integral_(RR^n) f(u) e^(-2pi i xi dot (M^(-1) u)) dif u
$

נשתמש בזהות
$xi dot (M^(-1) u) = (M^(-1))^T xi dot u$,
ונקבל


$
hat(g)(xi) &= 1/vol(RR^n \/ Lambda) integral_(RR^n) f(u) e^(-2pi i (M^(-1))^T xi dot u) dif u = 1/vol(RR^n \/ Lambda) hat(f)((M^(-1))^T xi)
$

נציב חזרה ונקבל כי

$ sum_(x in Lambda) f(x)  = sum_(x in ZZ^n) f(M x) 
underbrace(=, #ref(label("eqt:poisson-sum-for-r-n"))) 
sum_(xi in ZZ^n) hat(g)(xi) = 1 / vol(RR^n \/ Lambda) sum_(xi in ZZ^n) hat(f)((M^(-1))^T xi) $

אבל אם נסמן ב-
$D$
את הבסיס של הסריג הדואלי
$Lambda^*$,
אז כפי שראינו ב-
@dual-of-lambda-8,
$D = (M^T)^(-1)$ \
ולכן
$Lambda^* = D ZZ^n = (M^T)^(-1) ZZ^n$.

כלומר

$ sum_(x in Lambda) f(x) = 1 / vol(RR^n \/ Lambda) sum_(y in Lambda^*) hat(f)(y) $

כמבוקש.

#pagebreak()

== חסמים המתקבלים מתכנון לינארי <lin-bounds>

ברשותנו כל הכלים הדרושים להוכחת המשפט המרכזי בעבודתם של
$CnE$.

*תהי*
$f in  Sw$
ויהי מספר ממשי
$0 <r in RR$,
כך ש:

1. $f(0) = hat(f)(0) > 0$
2. $hat(f)(y) >= 0$ לכל $y in RR^n$
3. $f(x) <= 0$ לכל $|x| >= r$

*אז*
הצפיפות המרבית ב-
$RR^n$
היא לכל היותר
$vol(HalfBall)$.

נוכיח את הטענה תחילה עבור אריזות סריג, ולאחר מכן נרחיב את התוצאה לאריזות כלליות.

יהי
$Lambda$
סריג ב-
$RR^n$.
נוכל להניח ללא הגבלת הכלליות כי
$Lambda$
בעל אורך ווקטור מינימאלי
$r$,
שכן צפיפות אריזת הסריג תישאר זהה אם נרחיב או נכווץ את הסריג (ואיתו את אורך הווקטור המינימאלי) בסקלר.
אז ישנה אריזת סריג המבוססת עליו ומורכבת מכדורים ברדיוס
$r\/2$,
וכפי שראינו ב-
@eqt:packing-vol,
נובע מכך שהצפיפות שלה היא

$ vol(HalfBall) / vol(RR^n \/ Lambda) $

ולכן, אנו נרצה להוכיח כי
$vol(RR^n \/ Lambda) >= 1$.


ע"פ נוסחת הסכימה של פואסון
@eqt:poisson-sum,

$ sum_(x in Lambda) f(x) = 1 / vol(RR^n \/ Lambda) sum_(y in Lambda^*) hat(f)(y) $

אבל, אם נביע את הסכום השמאלי כך

$ sum_(x in Lambda) f(x) = f(0) + sum_(x in Lambda , x != 0) f(x) $

ונזכור כי מלבד
$x = 0$,
לכל
$x in Lambda$
מתקיים כי 
$|x| >= r$,
אז משילוב דרישות (1) ו- (3) נוכל להסיק כי

$ sum_(x in Lambda) f(x) <= f(0)   $

באופן דומה, נוכל לחסום את הסכום הימני

$ hat(f)(0) <= sum_(y in Lambda^*) hat(f)(y) $

כלומר,

$ (hat(f)(0)) / vol(RR^n \/ Lambda) <=  1 / vol(RR^n \/ Lambda) sum_(y in Lambda^*) hat(f)(y) $

ונקבל כי

$ (hat(f)(0)) / vol(RR^n \/ Lambda) <=  f(0) $

אבל דרשנו כי
$f(0) = hat(f)(0)$
ולכן

$ vol(RR^n \/ Lambda) >= 1 $

כפי שרצינו להוכיח.

#pagebreak()

=== הרחבה לאריזות מחזוריות ואריזות כלליות

הוכחנו כי כאשר ישנה פונקציה המקיימת התנאים, אין אריזת *סריג* בעלת צפיפות גדולה יותר. אך מה לגבי אריזות כלליות?

// From the paper: "given an optimal packing, 
// one can approximate it by taking the spheres contained in a large box 
// and repeating them periodically throughout space, 
// and the density loss is negligible if the box is large enough."

כל אריזה כללית ניתנת לקירוב על ידי אריזה *מחזורית*.
נוכל לקחת את כל הכדורים בתיבה גדולה ככל שנרצה ולחזור עליה עבור המרחב כולו, והצפיפות שתאבד בתהליך תהיה זניחה.

אם כך, מספיק שנוכיח את הטענה עבור אריזות מחזוריות. אם נראה כי גם עבורן מתקיים החסם,
אז לא ייתכן כי ישנה אריזה כללית בעלת צפיפות גבוהה יותר (שכן אז היינו יכולים לקרבה על ידי אריזה מחזורית מעבר לחסם שמצאנו).

תהי אריזה מחזורית של כדורים שמרכזיהם נמצאים על הזזות של הסריג
$Lambda$
באמצעות
$N$
הווקטורים
$t_1, ..., t_N$.

כמקודם, נוכל להניח ללא הגבלת הכלליות כי רדיוס הכדורים הינו
$r\/2$.
צפיפותה של אריזה זו תהיה, אם נתבסס על
@eqt:packing-vol,

$
(N vol(HalfBall)) / vol(RR^n \/ Lambda) 
$

כלומר, עלינו להוכיח כי
$ vol(RR^n \/ Lambda) >= N$.

מקודם, הפעלנו את הפונקציה על כל הנקודות שעל הסריג וסכמנו את התוצאה.
הפעם, הסכום יקבל את הצורה הבאה:

$ sum_(j,k=1)^N sum_(x in Lambda) f(t_j - t_k + x) $

כזכור, התמרת פורייה מחליפה הזזה בכפל, ולכן אם נשתמש שוב בנוסחת הסכימה של פואסון
@eqt:poisson-sum
נקבל

$ sum_(j,k=1)^N sum_(x in Lambda) f(t_j - t_k + x) = sum_(j,k=1)^N  [ 1 / vol(RR^n \/ Lambda) sum_(y in Lambda^*) hat(f)(y) e^(2 pi i y dot (t_j - t_k)) ] $

נוכל להכניס את הטור הסופי ולהפרידו כך:
$sum_(j,k=1)^N e^(2 pi i y dot t_j) dot e^(-2 pi i y dot t_k) = 
(sum_(j=1)^N e^(2 pi i y dot t_j)) (sum_(k=1)^N e^(-2 pi i y dot t_k))$.

אבל אם נשתמש בתכונות המשלים המרוכב נקבל כי

$
sum_(j,k=1)^N sum_(x in Lambda) f(t_j - t_k + x) = 1 / vol(RR^n \/ Lambda) sum_(y in Lambda^*) hat(f)(y) abs(sum_(j=1)^N e^(2 pi i y dot t_j))^2
$

בדומה לדרך בה פעלנו מקודם, משילוב דרישות (1) ו- (3) נוכל להסיק כי

$ sum_(j,k=1)^N sum_(x in Lambda) f(t_j - t_k + x) <= N f(0)   $

ואת הסכום הימני נוכל לחסום כך:

// We get N^2 for y=0 since the Σexp^0 = 1*N.

$ N^2 hat(f)(0) <= sum_(y in Lambda^*) hat(f)(y) abs(sum_(j=1)^N e^(2 pi i y dot t_j))^2 $

ונקבל כי

$ (N^2 hat(f)(0)) / vol(RR^n \/ Lambda) <= N f(0) $

ומכיוון ש
$f(0) = hat(f)(0)$,
אז

$ vol(RR^n \/ Lambda) >= N $

כפי שרצינו להוכיח.

#pagebreak()

== האפסים של הפונקציה ומסקנות נוספות <zeros-of-the-magic-function>
לפני שנפנה לחיפוש אחר פונקציות אשר יתאימו לתנאים המפורטים בסעיף
@lin-bounds,
נוכל לשים לב כי ישנן מספר תכונות כללית שיעזרו לנו בחיפוש.

ראשית, כל התנאים על הפונקציה המבוקשת הינם לינארים ונשמרים תחת סיבוב. \
לכן, נוכל לחשוב על
$f$
בתור פונקציה _רדיאלית_, כלומר פונקציה של משתנה יחיד 
($abs(x)$).

תכונה נוספת, אותה נוכל להסיק מהדרך בה הוכחנו את הטענה, היא שפונקציה העונה על התנאים חייבת לקבל אפסים על הסריג (מלבד בראשית) - וכך גם התמרת פורייה שלה.

ננסח ונוכיח: תהי 
$f$
פונקציה
כזו,
ויהי
$Lambda$
סריג ב-
$RR^n$
בעל אורך ווקטור מינימאלי
$r$.

אז צפיפות אריזת הסריג
$Lambda$
שווה לחסם 
$vol(HalfBall)$
אם ורק אם
1. $x in Lambda \/ {0} => f(x) = 0$
2. $y in Lambda^* \/ {0} => hat(f)(y) = 0$

נתחיל בכך שנקבל מ-
@eqt:packing-vol
כי הצפיפות שווה לחסם אם ורק אם

$ vol(HalfBall) / vol(RR^n \/ Lambda) = vol(HalfBall) $

כלומר,
$vol(RR^n \/ Lambda) = 1$.

השתמשנו בנוסחת הסכימה של פואסון
@eqt:poisson-sum
כי לקבל את השוויון

$ f(0) + sum_(x in Lambda , x != 0) f(x) = sum_(x in Lambda) f(x) = 1 / vol(RR^n \/ Lambda) sum_(y in Lambda^*) hat(f)(y) = 1 / vol(RR^n \/ Lambda) hat(f)(0) + 1 / vol(RR^n \/ Lambda) sum_(y in Lambda^* , y != 0) hat(f)(y) $

בכיוון אחד, אם
$vol(RR^n \/ Lambda) = 1$
אז נקבל כי

$ f(0) + sum_(x in Lambda , x != 0) f(x) = hat(f)(0) + sum_(y in Lambda^* , y != 0) hat(f)(y) $

אבל דרישה (1) ב-
@lin-bounds
הינה ש
$f(0) = hat(f)(0)$
ולכן

$ sum_(x in Lambda , x != 0) f(x) = sum_(y in Lambda^* , y != 0) hat(f)(y) $

ומדרישות (2) ו- (3) ב
@lin-bounds
נקבל מיד כי כל האיברים בשני הסכומים הינם $0$.

הכיוון השני מידי, שכן נוכל להציב את האפסים ולקבל

$ f(0) + sum_(x in Lambda , x != 0) 0  = 1 / vol(RR^n \/ Lambda) hat(f)(0) + 1 / vol(RR^n \/ Lambda) sum_(y in Lambda^* , y != 0) 0 $

ובצירוף דרישה (1) ב-
@lin-bounds
נקבל

$ 1 = 1 / vol(RR^n \/ Lambda) => vol(RR^n \/ Lambda) = 1 $

#pagebreak()

// "We know exactly where the roots of f and hat(f) should be"
// After Lemma 5.1

מכיוון שידוע לנו כי הפונקציה נשארת לא חיובית עבור
$abs(x) >= r$,
נוכל להסיק כי אם
$f$
היא פונקציית הקסם הדרושה שלנו, אז היא מתאפסת על הסריג
$E_8$
(מלבד בראשית).

מכיוון שנוכל לחשוב עליה בתור פונקציה רדיאלית
$f_0(x)$,
נסיק כי יש לה אפסים בכל
$x = sqrt(2k), k = 1, 2, ...$
וכולם מסדר זוגי מלבד במקרה של
$k = 1$,
שם נצפה לאפס מסדר אי זוגי.

באופן דומה ומכיון ש
$E_8$
צמוד לעצמו, נסיק כי
$hat(f_0)$
מקבלת אפסים מסדר זוגי לכל
$y = sqrt(2k), k = 1, 2, ...$.

נוכל אפילו לצייר (באופן סכמתי), את הצורה המצופה של הפונקציה ושל התמרת פורייה שלה:

#figure([
#align(center)[  
  #import "@preview/cetz:0.2.2": canvas, plot, draw
  
  #let style = (stroke: black, fill: rgb(0, 0, 200, 75))

  #canvas(length: 1cm, {
    plot.plot(
      name: "f-plot",
      size: (8, 2),
      axis-style: "school-book",
      x-tick-step: none,
      x-ticks: ((0, 0), (calc.sqrt(2), $sqrt(2)$), (calc.sqrt(4), $sqrt(4)$), (calc.sqrt(6), $sqrt(6)$)),
      y-tick-step: none,
      y-ticks: ((-10, -10), (10, 10)),
      y-domain: (-10, 10),
      {
        plot.add(
          style: style,
          domain: (1, calc.sqrt(7)), 
          x => (
            if x <= calc.sqrt(2) {
              return calc.pow(calc.sin(0.5 * calc.pow(x, 2) * calc.pi), 1)
            } else if x <= calc.sqrt(4) {
              return (1/calc.pow(x, 2)) * calc.pow(calc.sin(0.5 * calc.pow(x, 2) * calc.pi), 1)
            } else {
              return -(1/calc.pow(x, 2)) * calc.pow(calc.sin(0.5 * calc.pow(x, 2) * calc.pi), 2)
            }
          ),
        )
        
      }
    )
    draw.content(((0,2.5), "-|", "f-plot"), $f_0$)
  })

  #canvas(length: 1cm, {
    plot.plot(
      name: "f-hat-plot",
      size: (8, 2),
      axis-style: "left",
      x-tick-step: none,
      x-ticks: ((0, 0), (calc.sqrt(2), $sqrt(2)$), (calc.sqrt(4), $sqrt(4)$), (calc.sqrt(6), $sqrt(6)$)),
      y-tick-step: none,
      {
        plot.add(
          style: style,
          domain: (1, calc.sqrt(7)), 
          x => (1.0 / (x + 0.05)) * calc.pow(calc.sin(0.5 * calc.pow(x, 2) * calc.pi), 2)
        )
      }
    )
    draw.content(((0,2.5), "-|", "f-hat-plot"), $hat(f)_0$)
  })  


]
], caption: [תיאור סכמתי של הפונקציות], supplement: "תרשים") <f0-and-f0-hat-plots>
#pagebreak()

= תבניות מוֹדוּלָרִיּוֹת <modular-forms>

על פניו, התקדמנו מאוד: לא רק שאנו בקיאים בהגדרות ובהוכחות הנדרשות, יש לנו גם "מתכון" למציאת הפונקציה המבוקשת:
עלינו למצוא פונקציה של משתנה יחיד, שמקבלת אפסים בכל הסריג
$E_8$,
וכך גם התמרת הפורייה שלה.

אולם, בעיה זו מתבררת כקשה מאוד.

בעוד שניתן לבנות פונקציה בעלת אפסים במקומות הנדרשים, וניתן לבנות פונקציה שהתמרת פורייה שלה מקבלת אפסים כאלו, אין דרך כללית או פשוטה לבנות פונקציה המקיימת את שתי הדרישות בו זמנית.

// Splitting to f_- and f_+ as eigenfunctions

עם זאת, ישנו פישוט נוסף שנוכל לבצע כבר עתה.
כפי שראינו בסעיף 
@radial-functions,
לכל פונקציה רדיאלית מתקיים
$hat(hat(f)) = f$.

לפיכך, לכל
$f$
המקיימת את התנאים הנדרשים, נוכל לקחת

$ g_(+1) = (f+hat(f)) / 2  , #h(2em) g_(-1) = (f-hat(f)) / 2 $

ואם נפעיל עליהן את התמרת פורייה, נקבל

$ hat(g_(+1)) =& (hat(f)+f) / 2 =&  g_(+1) , #h(2em)
  hat(g_(-1)) =& (hat(f)-f) / 2 =& -g_(-1) $

_פונקציה עצמית_ של התמרת פורייה
היא פונקציה המקיימת עבור סקלר
$alpha in RR$
כולשהו
$hat(f) = alpha f$.

אז
$g_(+1)$
היא פונקציה עצמית עם
$alpha = 1$,
ו-
$g_(-1)$
היא פונקציה עצמית עם
$alpha = -1$.

שתיהן מקבלות את השורשים הנדרשים בדיוק כמו
$f$,
ונוכל לקבל באמצעותן חזרה את
$f$
כך:

$ f = g_(+1) + g_(-1) => hat(f) = g_(+1) - g_(-1) $

הבעיה עדיין קשה מאוד,
אבל שתי הפונקציות החדשות בלתי תלויות אחת בשניה, ולכן נוכל לבנות כל אחת מהן בנפרד.

== התמרת לפלס

העיסוק שלנו בתבניות מודולריות, להן סגולות תיאורטיות במגוון רחב של תחומים, קשור לחיפוש שלנו אחר אבני בניין לפונקציה המיוחדת אותה אנו מחפשים
באמצעות _התמרת לפלס_ של _גאוסיאינים_.
\
ה#[_גאוסיאן_]
(_Gaussian_),
$f(x) = e^(-t pi abs(x)^2)$,
הינה פונקציה המקיימת

$ e^(-t pi abs(x)^2) -> t^(-n/2) e^(-pi abs(y)^2 \/ t) $

מכיוון שקל לנו מאוד לחשב התמרת פורייה של גאוסיאן, נוכל לבחור פונקציה פשוטה
$g(t)$
כולשהי, ולהשתמש בה על מנת לבחור צירוף של גאוסיאנים:

$ f(x) = integral_0^infinity e^(-t pi abs(x)^2) g(t) dif t $

הנוסחה הנ"ל נקראת _התמרת לפלס_ של הפונקציה
$g$.
\
כל עוד
$g$
פשוטה למדי, נוכל לנצל את תכונות הגאוסיאן ולקבל את התמרת פורייה של
$f$
באמצעות החלפה פשוטה:

$ hat(f)(y) =& integral_0^infinity t^(-n/2) e^(-pi abs(y)^2 \/ t) g(t) dif t \
// Replace t -> 1/t.
            =& integral_0^infinity e^(-pi abs(y)^2 t) t^(n/2 - 2)  g(1 \/ t) dif t
$ <fourier-transform-of-laplace-transform>

כלומר, עבור
$epsilon = plus.minus 1$,
אם מתקיים
$ g(1 \/ t) = epsilon t^(2-n/2) g(t) $
אז
$hat(f) = epsilon f$,
ולכן אנו מחפשים פונקציות המקיימות משוואה כזו.

#pagebreak()

== מבוא לתבניות מוֹדוּלָרִיּוֹת

_תבניות מוֹדוּלָרִיּוֹת_
(_modular forms_)
הן משפחה של פונקציות המקיימות משוואות פונקציונאליות מסויימות.

אנו נתמקד במספר קטן של תבניות שימושיות במיוחד למקרה שלנו.

#let hh = $frak(h)$
#let Im = $op("Im")$
#let Re = $op("Re")$

נסמן ב-
$hh$
את חצי המישור העליון, כלומר

$ hh = { z in CC | Im z > 0 } $

// Based on "Definition 3" in "An Introduction to Modular Forms".

עבור פונקציה
$F$
ו-
$k in ZZ$,
אנו נגיד ש-
$F$
היא _תבנית מוֹדוּלָרִית חלשה_ בעלת משקל 
$k$ \
(_weakly modular form of weight k_),
אם היא מקיימת

$ F((a z + b) / (c z + d)) = (c z + d)^k F(z) $

לכל
$mat(a, b; c, d) in "SL"(2, RR)$.

אנו נקרא ל-
$F$
_תבנית מוֹדוּלָרִית_
(_modular form_)
אם בנוסף לכך היא הולומורפית ב-
$hh$
וחסומה כאשר
$Im z -> infinity $.

#let thetaseries = $Theta_Lambda$
#let thetaseriesdual = $Theta_(Lambda^*)$

== פונקציית תטא של סריג - $thetaseries (z)$ <theta-series>

לכל סריג
$Lambda$
נוכל להגדיר פונקציה, לה נקרא פונקציית תטא, כך

$ thetaseries(z) = sum_(x in Lambda) e^(pi i abs(x)^2 z) $

פונקציה זו מתכנסת כאשר
$Im z > 0$
ומגדירה פונקציה אנליטית ב-
$hh$.

לפונקציה זו תכונה חשובה:

לכל סריג
$Lambda$
ב-
$RR^n$,
מתקיים

$ thetaseries(z) = 1 / vol(RR^n \/ Lambda) (i/z)^(n \/ 2) thetaseriesdual (-1 \/ z) $

לכל
$z in hh$.

נוכיח זאת באמצעות נוסחת הסכימה של פואסון על הפונקציה הפנימית,
$e^(-t pi abs(x)^2)$.

כפי שראינו מקודם, פונקציה זו, שהיא הגאוסיאן,
מקיימת

$ e^(-t pi abs(x)^2) -> t^(-n/2) e^(-pi abs(y)^2 \/ t) $

נוכל לבצע המשכה אנליטית לפונקציה זו, ולקבל את אותה התוצאה עבור
$t in CC , Re t > 0 $.

נוסחת הסכימה של פואסון
@eqt:poisson-sum
נותנת לנו

$ sum_(x in Lambda) e^(-t pi abs(x)^2) = 1 / vol(RR^n \/ Lambda) sum_(y in Lambda^*) t^(-n/2) e^(-pi abs(y)^2 \/ t) $

נציב
$z = i t$,
אז
$t = - i z$
ונקבל

$ sum_(x in Lambda) e^(z i pi abs(x)^2) = 1 / vol(RR^n \/ Lambda) sum_(y in Lambda^*) (- i z)^(-n/2) e^(pi abs(y)^2 \/ z i) $

נוכל לפשט את הגורם הראשון בסכום הימני:

$ (- i z)^(-n/2) = (z / i)^(-n/2) = (i/z)^(n/2) $

בנוסף, אם נציב 
$-1/z$
ב
$thetaseriesdual$,
נקבל

$ 

thetaseriesdual(-1/z) = sum_(y in Lambda^*) e^(- pi i abs(y)^2 / z) 
= sum_(y in Lambda^*) e^(pi abs(y)^2 \/ z i) $

נציב בחזרה ונקבל

$ thetaseries(z) = 1 / vol(RR^n \/ Lambda) (i/z)^(n \/ 2) thetaseriesdual (-1 \/ z) $

כפי שרצינו להוכיח.

אנו נשתמש בפונקציות תטא הבאות,
המוגדרות על הסריג
$ZZ$:

$ 
theta_00 (z) = sum_(n in ZZ) e^(pi i n^2 z) \
theta_01 (z) = sum_(n in ZZ) ((-1)^n e^(pi i n^2 z)) \
theta_10 (z) = sum_(n in ZZ) e^(pi i (n + 1/2)^2 z)
$ <theta-z-funcs>

הן מקיימות כי

$
z^(-2) theta_00^4(-1 / z) = -theta_00^4(z) \
z^(-2) theta_01^4(-1 / z) = -theta_10^4(z) \
z^(-2) theta_10^4(-1 / z) = -theta_01^4(z) \
$

וכן
$
theta_00^4(z + 1) = theta_01^4(z) \
theta_01^4(z + 1) = theta_00^4(z) \
theta_10^4(z + 1) = -theta_10^4(z)
$

#pagebreak()

#let rtl-mark = [\u{200F}]

== טור Eisenstein - $E_k$ #rtl-mark

טור
Eisenstein
הינו פונקציה אותה נגדיר כך

$ E_k (z) = 1 / (2 zeta (k)) sum_((m,n) in ZZ^2 \ (m,n) != (0,0)) 1 / (m z + n)^k $

כאשר
$zeta$
היא פונקצית זטא של רימן (
  $zeta(k) = sum_(n=1)^infinity 1/n^k$
).

אומנם ישנה חפיפה בסימון בין האריזה
$E_8$
לבין
$E_k$
כאשר
$k=8$,
אך למזלנו נשתמש אך ורק ב
$k in {2,4,6}$,
ולכן נרשה לעצמנו להיצמד לסימונים המקובלים ולא להגדיר סימון שונה.

// Ek(-1/z) = z^4 Ek(z) and Ek(z+1) = Ek(z) [for k > 2, k mod 2 = 0]

לכל
$k$
זוגי וגדול מ-2, נוכל לקבל את הזהויות

$ 
E_k (z+1) = E_k (z) , space space space
E_k (-1 \/ z) = z^k E_k  (z) 
$ <eisen-k>

על ידי הצבה פשוטה.

ובפירוט:

$
sum_((m,n) in ZZ^2 \ (m,n) != (0,0)) 1 / (m (z + 1) + n)^k 
&= sum_((m,n) in ZZ^2 \ (m,n) != (0,0)) 1 / (m z + m + n)^k 
= sum_((m,n) in ZZ^2 \ (m,n) != (0,0)) 1 / (m z + n)^k

\

sum_((m,n) in ZZ^2 \ (m,n) != (0,0)) 1 / (m (-1/z) + n)^k 
&= sum_((m,n) in ZZ^2 \ (m,n) != (0,0)) 1 / ((n z - m) / z)^k 
= sum_((m,n) in ZZ^2 \ (m,n) != (0,0)) z^k / (n z - m)^k 
= z^k sum_((m,n) in ZZ^2 \ (m,n) != (0,0)) 1 / (m z + n)^k
$

בהתאם להגדרות בתחילת הפרק,
$E_k$
הינן תבניות מדולריות ממשקל
$k$,
כאשר
$k > 2$.

// Edge case for k=2:
// E2(-1/z) = z^4 E2(z) - 6i*z*pi and E2(z+1) = E2(z)

עבור
$k=2$,
אנו נתקלים בבעיה:
הסכום מתכנס _בתנאי_ ולא _בהחלט_. הסתמכנו על התכנסות בהחלט על מנת שנוכל לשנות את סדר הסכימה של הטור, ובמקרה הזה לא נוכל לעשות זאת.

נוכל לבחור להגדיר את סדר הסכימה כך:


$ E_k (z) &= 1/(2zeta(k)) sum_(n!=0) 1/n^k + 1/(2zeta(k)) sum_(m!=0) sum_(n in ZZ) 1/(m z + n)^k \ &= 1/(zeta(k)) sum_(n=1)^infinity 1/n^k + 1/(zeta(k)) sum_(m=1)^infinity sum_(n=-infinity)^infinity 1/(m z + n)^k $ <e-k-as-inf-sum>

וכמובן שהתוצאות הקודמות ימשיכו להתקיים כאשר
$k > 2$.

עבור
$k=2$,
נוכל לקבל שוב באמצעות הצבה את הזהות

$ E_2 (z+1) = E_2 (z)  $

אך המקבילה של הזהות 

$ E_k (-1 \/ z) = z^k E_k  (z)  $

תקבל צורה מעט שונה:

$ E_2 (-1 \/ z) = z^2 E_2 (z) - 6i z \/ pi $   <eisen-2>

אנו נאמר ש-
$E_2$
היא 
_תבנית כְּמוֹ-מוֹדוּלָרִית_
(_quasimodular form_)
ממשקל 2.

נוכיח משוואה זו.

#pagebreak()

=== מציאת משוואה פונקציונאלית ל $E_2$ #rtl-mark

אם נסתכל על הטור המקורי שהגדרנו, עבור
$k=2$
היינו מקבלים את הטור

$ 1 / (2 zeta(2)) sum_((m,n) in ZZ^2 \ (m,n) != (0,0)) 1 / (m z + n)^2 $

// p19 in "1-2-3 of Modular Forms".
כדי לפשט חלק מהחישובים בהמשך, נשתמש בנרמול הבא:

$ G_2 (z) = zeta(2) E_2 (z) $

מכיוון ש
$zeta(2) = pi^2/6$,
נקבל כי
$E_2(z) = 6/pi^2 G_2(z)$.

הטור אומנם אינו מתכנס בהחלט, אך הוא מאוד קרוב לכך. כל כך קרוב, למעשה, שלכל
$epsilon>0$,
נוכל לסמן

$ G_(2,epsilon) (z) = 1 / 2 sum_((m,n) in ZZ^2 \ (m,n) != (0,0)) 1 / ((m z + n)^2 |m z + n|^(2epsilon)) $

ולקבל טור מתכנס בהחלט.
הפונקציה החדשה מקיימת את המשוואה

// This the same as @eqt:eisen-k (but with the general az+b/cz+d input).

$ G_(2,epsilon)((a z + b) / (c z + d)) = (c z + d)^2 |c z + d|^(2epsilon) G_(2,epsilon)(z) $

אנו נראה מיד שהגבול
$lim_(epsilon -> 0) G_(2,epsilon)(z)$
קיים, וכי

$ G^*_2 (z) := lim_(epsilon -> 0) G_(2,epsilon)(z) = G_2(z) - pi / (2Im(z)) $

מכיוון ש
$G^*_2$
מתנהגת בדומה לתבנית מודלרית ממשקל 2,
נקבל כי

$ 
G^*_2((a z + b) / (c z + d)) &= (c z + d)^2 G^*_2(z) \
$

ובפרט,
$
G_2(-1\/z) - pi / (2Im(-1/z)) &= z^2 [G_2(z) - pi / (2Im(z)) ]
$

אבל אם נסמן
$z=x + i y$,
נוכל לחשב כי
$Im(-1\/z) = Im(-1 / (x+i y)) = y / (x^2 + y^2)$.

כלומר
$
G_2(-1\/z) - pi(x^2+y^2) / (2y) &= z^2 [G_2(z) - pi / (2y) ] \

G_2(-1\/z) &= z^2 G_2(z) + pi/(2y) (x^2 + y^2 - z^2) \

G_2(-1\/z) &= z^2 G_2(z) + pi/(2y) (-2 x y i + 2 y^2) \

// Since -iz = -ix + y.

G_2(-1\/z) &= z^2 G_2(z) - pi i z
$

ולכן גם

$ E_2 (-1 \/ z) = z^2 E_2 (z) - 6i z \/ pi $

כפי שרצינו.

#pagebreak()

נותר לנו להוכיח את קיום הגבול וערכו.

נתחיל בכך שנגדיר את
$G_2$
ישירות באמצעות הטור מנוסחה
@eqt:e-k-as-inf-sum,
ולא באמצעות
$E_2$:

$ G_2(z) = 1/2 sum_(n!=0) 1/n^2 + 1/2 sum_(m!=0) sum_(n in ZZ) 1/(m z + n)^2 $

#let Ieps=$I_epsilon$

נגדיר פונקצית עזר
$Ieps(z)$
לכל
$z in hh$
ו-
$epsilon > -1/2$
כך:

$ Ieps(z) = integral_(-infinity)^infinity 1/((z+t)^2 abs(z+t)^(2epsilon)) dif t $

אז לכל
$epsilon > 0$
נוכל לרשום

$ 
G_(2,epsilon) - sum_(m=1)^(infinity) Ieps(m z) = &sum_(n=1)^infinity 1/n^(2+2epsilon) \
+ &sum_(m=1)^(infinity) sum_(n=-infinity)^(infinity) [  1 / ((m z + n)^2 |m z + n|^(2epsilon)) - integral_(n)^(n+1) 1/((m z+t)^2 abs(m z+t)^(2epsilon)) dif t ] 
$

את הביטוי בסוגריים המרובעים נוכל להעריך באמצעות משפט ערך הביניים:
מכיוון שלכל פונקציה גזירה, \
$f(t) - f(n)$
חסום ב-
$n <= t <= n+1$
על ידי
$max_(n<=u<=n+1) abs(f'(u))$,
נוכל להסיק כי הוא
$O(abs(m z + n)^(-3-2epsilon))$.

אז הסכומים בצד הימני של המשוואה מתכנסים בהחלט, ומקומית 
גם במידה שווה.
לכן הגבול קיים כאשר
$epsilon -> 0$, \
ואם נחליף את
$epsilon$
ב-$0$
נקבל בדיוק את 
$G_2$:

$ 
sum_(n=1)^infinity 1/n^2 + sum_(m=1)^(infinity) sum_(n=-infinity)^(infinity) [  1 / (m z + n)^2 - integral_(n)^(n+1) 1/((m z+t)^2) dif t] &= 
 sum_(n=1)^infinity 1/n^2 + sum_(m=1)^(infinity) sum_(n=-infinity)^(infinity) [  1 / (m z + n)^2 - 0] \
// Note the change from n=1..inf to n∈Z,n!=0 (also for m).
&= 1/2 ( sum_(n!=0) 1/n^2 + sum_(m!=0) sum_(n in ZZ) 1/(m z + n)^2 ) \
&= G_2(z)
$

מצד שני, עבור
$epsilon > -1/2$
מתקיים כי

$ Ieps(x + i y) &= integral_(-infinity)^infinity 1/((x + i y + t)^2 abs(x + i y +t)^(2epsilon)) dif t \
&= integral_(-infinity)^infinity 1/((x + i y + t)^2 ((x + t)^2 + y^2)^(epsilon)) dif t \

$

נוכל להחליף את
$t$
ב
$u=t+x$,
ולקבל, לאחר שינוי שם המשתנה חזרה, כי

$
&= integral_(-infinity)^infinity 1/((t + i y)^2 (t^2 + y^2)^(epsilon)) dif t \
$

אז נוכל להוציא את
$y$
בתור גורם משותף, לבצע החלפת משתנים 
$u=t/y => u'=1/y$
ולקבל (לאחר שינוי שם המשתנה) כי

$
Ieps(x + i y) &= integral_(-infinity)^infinity 1/(y^2(t/y + i)^2 y^(2epsilon)(t^2/y^2 + 1)^(epsilon)) dif t \
// (t/y)' = 1/y
&= integral_(-infinity)^infinity 1/y^(2+2epsilon)  1/((t + i)^2 (t^2 + 1)^(epsilon)) dot 1/y dif t 
&= 1/y^(1+2epsilon) integral_(-infinity)^infinity 1/((t + i)^2 (t^2 + 1)^(epsilon)) dif t 
$

#pagebreak()

אם נסמן

// Same as I(eps) but with z=i.
$ 
I(epsilon) = Ieps(i) = integral_(-infinity)^infinity 1/((t + i)^2 (t^2 + 1)^(epsilon)) dif t $

נקבל כי
$ Ieps(x + i y) = I(epsilon)/(y^(1+2epsilon)) $

נשים לב שעבור
$I(0)$,
נקבל כי

$ I(0) = integral_(-infinity)^infinity 1/((t + i)^2) dif t = lr(-1/(t+i)|)_(-infinity)^infinity=0 $

וכי עבור
$I'(0)$,
נוכל למצוא את 
$I'(epsilon)$
על ידי

$ 
I'(epsilon) &= partial / (partial epsilon) integral_(-infinity)^infinity 1/((t + i)^2 (t^2 + 1)^(epsilon)) dif t \
&=  integral_(-infinity)^infinity partial / (partial epsilon) [1/((t + i)^2 (t^2 + 1)^(epsilon))] dif t 
&= - integral_(-infinity)^infinity (log(1 + t^2))/((i + t)^2 (1 + t^2)^(epsilon)) dif t
$

אז
$
I'(0) &= - integral_(-infinity)^infinity log(t^2 + 1)/((t + i)^2) dif t = lr(
  ((1+log(t^2 + 1)) / (t+i) - 1 / tan(t) ) |
)_(-infinity)^infinity = -pi $

נוסיף לכך את העבודה כי
$zeta(1+2epsilon) = 1/(2epsilon) + O(1)$,
ונסיק כי

$ 
// remove the O(1) from zeta.
lim_(epsilon->0) (I(epsilon) zeta(1+2epsilon))/y^(1+2epsilon) &= lim_(epsilon->0) I(epsilon) / (y^(1+2epsilon) 2epsilon) \
// l'hopital's rule for 0/0.
&= lim_(epsilon->0) (I'(0)) / (2 epsilon dot 2y^(1+2 epsilon)log(y) + 2y^(1+2epsilon)) \
&= -pi/(2y) 
$

כלומר

$ lim_(epsilon -> 0) [G_(2,epsilon)(z) - sum_(m=1)^(infinity) Ieps(m z)] &= G_2 (z) \ 
G^*_2(z) - lim_(epsilon -> 0) sum_(m=1)^(infinity) I(epsilon)/((m y)^(1+2epsilon)) &= G_2(z) \
G^*_2(z) - lim_(epsilon -> 0) I(epsilon) /y^(1+2epsilon) sum_(m=1)^(infinity) 1/(m^(1+2epsilon)) &= G_2(z)\
G^*_2(z) - lim_(epsilon->0) (I(epsilon) zeta(1+2epsilon))/y^(1+2epsilon) &= G_2(z) \
G^*_2(z) + pi/(2y) &= G_2(z)
$

ולכן
$G^*_2(z) &= G_2(z) - pi/(2 Im(z))$,
כפי שרצינו להוכיח.

#pagebreak()

=== פיתוח פורייה של $E_k$

במקרה הכללי, לפונקציה 1-מחזורית ישנו פיתוח פוריה בעל הצורה הבאה:

// In the general case, if f is periodic in [-L, L], f(x) = Σ (a_n cos (n pi x / L) + b_n sin (n pi x / L)).
// For the [0,1] case, in Lectures in Analysis Volume 1 p35:

$ g(z) space ~ sum_(n = -infinity)^infinity a_n e^(2 pi i n z) $

נמשיך מכאן והלאה לסמן 
$q = e^(2 pi i z)$.

// Abs: if sum (|a_n|) converges, Cond: if sum (a_n) converges, but not |a_n|.
// LinAlg 2 Chapter 5.
/// Optional: CTNTmodularforms - Theorem B.1 shows why.

כדי למצוא פיתוח פורייה ל-
@eqt:e-k-as-inf-sum,
נשתמש בזהות הבאה:

$ sum_(n in ZZ) 1 / (z + n) = pi / tan(pi z), space z in CC \/ ZZ $ <sum-one-over-z-plus-n>

את הסכום משמאל, המתכנס בתנאי, נפרש בתור הגבול כאשר
$lim_(N->infinity) sum_(-N)^N (1/(z+n))$.

הפונקציה מימין הינה 1-מחזורית, ופיתוח פורייה שלה מתקבל על ידי

$ pi / tan(pi z) = pi cos(pi z) / sin(pi z) = pi i (e^(pi i z) + e^(-pi i z)) / (e^(pi i z) - e^(-pi i z)) = - pi i (1+q)/(1-q) = -2pi i (1/2 + sum_(r=1)^infinity q^r) $

אם נגזור את
@eqt:sum-one-over-z-plus-n
איבר-איבר
$k-1$
פעמים נקבל (לאחר חילוק ב-
$(-1)^(k-1)(k-1)!$
)
כי

$ sum_(n in ZZ) 1 / (z + n)^k = (-1)^(k-1) / (k-1)! d^(k-1)/(d z^(k-1)) (pi / tan(pi z)) $

אז נוכל להציב ולקבל (שוב לאחר גזירה איבר-איבר) כי

$ sum_(n in ZZ) 1 / (z + n)^k = (-2pi i)^k / (k-1)! sum_(r=1)^infinity r^(k-1) q^r $

נשים לב כי זהות זו מתקיימת לכל
$z in hh, k >= 2$.

נציב בחזרה ב-
@eqt:e-k-as-inf-sum
ונקבל את פיתוח פורייה הבא:

// Fourier expansion in the paper

$ E_k (z) &= 1 + 1/(zeta(k)) sum_(m=1)^infinity [(-2pi i)^k / (k-1)! sum_(r=1)^infinity r^(k-1) q^(m r)] \
&= 1 + 1/(zeta(k)) (2pi i)^k / (k-1)! sum_(m=1)^infinity sigma_(k-1)(m) q^m\ 
&= 1 + 2 / (zeta (1 - k)) sum_(m=1)^infinity sigma_(k-1)(m) q^m $ <e-k-fourier-exp>



כאשר
$sigma_(k-1)(m)$
היא פונקציה המחזירה את סכום המחלקים של
$m$,
כאשר כל אחד מהם מועלה בחזקת
$k-1$.

#pagebreak()

=== שימושים ל- $E_k$

נציג עתה את $j$,
הנקראת גם
_elliptic j-invariant_.
זו היא תבנית מודולרית בעלת התכונה הבסיסית

$ j(-1 \/ z) = j(z) $

היא מוגדרת כך

$ j = (1728 E_4^3) / (E_4^3 - E_6^2) $ <elliptic-j-invariant>

במבט ראשון, הביטוי נראה משונה מאוד, מדוע לבחור שבר המורכב מ"פולינום" של תבניות מודולריות?

אבל, אם נבחן את התכונות של
$E_k$
שראינו ב-
@eqt:eisen-k,
ובפרט הזהות
$E_k (-1 \/ z) = z^k E_k  (z) $,
נקבל כי אכן

$ 
j(-1 \/ z) = (1728 E_4^3(-1/z)) / (E_4^3(-1/z) - E_6^2(-1/z)) = 
(1728 z^12 E_4^3(z)) / (z^12 E_4^3(z) - z^12 E_6^2(z)) = j(z)
$

כלומר, 
$j$
היא אכן אינווריאנטית במובן זה. כמובן, באופן מיידי נוכל לקבל גם כי
$j(z) = j(z+1)$.

בזכות הפיתוח, מתבררים תפקידיהם של ה-
$E_k$-ים
השונים, וכן החזקות הספציפיות שנבחרו עבורם. מיד גם נראה מהיכן מגיע הקבוע $1728$ במונה.


=== שימוש בפיתוח פורייה של $E_k$

// Based on "Proposition 5" in Zagier - 1-2-3 Of Modular Forms

/// From "Proposition 5" in 1-2-3 of Modular Forms
אם נשתמש בפיתוח פורייה שראינו ב-
@eqt:e-k-fourier-exp,
נקבל כי

$ 
E_4 (z) &= 1 + 2 / (zeta (-3)) ( sigma_(3)(1) q^1 + sigma_(3)(2) q^2 + ... ) \
        &= 1 + 2 / (1/120) ( 1dot q^1 + 9 dot q^2 ) \
        &= 1 + 240q + 2160q^2 + ...
$ <e4-fourier>

באופן דומה, נקבל כי
$
E_6 &= 1 − 504q − 16632q^2 − ... \
E_2 &= 1 - 24q - 72q^2 - ...
$ <e2-and-e6-fourier>

באמצעות פיתוחים אלו נוכל גם לחשב את הפיתוחים של חזקות שונות של
$E_k$,
למשל:

// Taken from "Proposition 7" in 1-2-3 of Modular Forms

$ 
E_4^2 &=  (1 + 240q + 2160q^2 + ...)^2 = 1 + 480q + ... \
E_4^3 &=  1 + 720q + ... \
E_6^2 &= 1 - 1008q + ... 
$ <ek-powers-fourier>


// #pagebreak()

הצירוף
$E_4^3 - E_6^2$
שימושי בפני עצמו. 
את פיתוח פורייה שלו נקבל מיד על ידי
$ E_4^3 - E_6^2 = 1728q + ... $

נוכל לנרמל אותו ולסמנו בתור

$ Delta (z) = 1/1728 (E_4^3 - E_6^2) $

כלומר,

$ j(z) = (E_4^3(z)) / Delta(z) $

לבסוף, נוכל להשתמש בכלי אוטומאטי על מנת לקבל גם פיתוח עבור
$j$,
לכל חזקה שנרצה:

$ #h(1em) j(z) = q^(−1) + 744 + 196884 q + 21493760 q^2 + 864299970 q^3 + 20245856256 q^4 + O(q^5) $ <j-foureir>

נרצה גם למצוא נוסחה אסימפטוטית עבור המקדם
$a_n$
של תבנית מודולרית.

הנוסחה עצמה מורכבת (ושונה מעט בין תת משפחות של תבניות מודולריות) ולא נביאה כאן, אך נשתמש ביכולת לחסום את המקדמים בשלב מאוחר יותר על מנת למצוא קירובים טובים מספיק (כלומר, בעלי שגיאה חסומה קטנה מספיק).

אם זאת, נבחן מקרה פשוט במיוחד.

/// Based on "Proposition 8" In 1-2-3 which shows how to bound weakly holomorpic forms.

מ-
@eqt:e-k-fourier-exp
נוכל להסיק כי
כאשר
$n>=1$, 
המקדם ה-
$n$
בפיתוח פורייה של
$E_k$
מקיים
$a_n = O(n^(k-1))$, \
וזאת מכיוון ש-
$n^(k-1) <= sigma_(k-1)(n) < zeta(k-1) n^(k-1)$.

אז לדוגמה, המקדם ה-
$n$
בפיתוח פורייה של
$E_2$
מקיים,
כאשר
$n>=1$, 

// In Viazovksa's paper, she uses this form "Similar inequalities hold for the Fourier coefficients of ..".

$ abs(c_(E_2(z))(n)) <= C_1 n $

ראינו כבר כי
$c_(E_2(z))(0) = 1$,
ולכן

$

abs(E_2(z)) = abs(
  1 +sum_(n=1)^infinity c_(E_2(z))(n) e^(2 pi i n z)
) <= 1 + sum_(n=1)^infinity  C_1 n abs(e^(2 pi i n z))

= 1 + C_1 sum_(n=1)^infinity n e^(-2 pi n Im(z)) 

$
 
אז לכל
$Im(z) > 0$
התור מתכנס ו-

// https://www.wolframalpha.com/input?i=sum+(ne%5E(-2pi*n*t)),+n%3D1+to+infinity
$
sum_(n=1)^infinity n e^(-2pi n Im(z)) = (e^(2pi Im(z))) / (1 - e^(2pi Im(z)))^2
$

אז גם

// https://www.wolframalpha.com/input?i=sum+(ne%5E(-2pi*n*t)),+n%3D2+to+infinity
$

sum_(n=1)^infinity n e^(-2pi Im(z)) &= e^(-2pi Im z) + sum_(n=2)^infinity n e^(-2pi n Im(z)) \
&= e^(-2pi Im z) + (e^(-2 pi Im(z)) (2 e^(2 pi Im(z)) - 1))/(e^(2 pi Im(z)) - 1)^2 \
&= e^(-2pi Im z) (1 + (2 e^(2 pi Im(z)) - 1)/(e^(2 pi Im(z)) - 1)^2)
$


// Bound for the expression in parentheses: https://www.wolframalpha.com/input?i=((-1+++2+e%5E(2+%CF%80+t)))/(-1+++e%5E(2+%CF%80+t))%5E2+
וכאשר
$Im(z) > 1\/2$
ניתן לחסום את הביטוי בסוגריים ללא תלות ב-
$z$,
ולכן גם

$ |E_2(z)| <=  1 + C_2 e^(-2pi Im z) $ <e-k-estimation>

#pagebreak()

= הפונקציה של #Viaz #rtl-mark <viaz-func>

== בניה של פונקציה בעלת שורשים מתאימים

ראינו בפרק הקודם
כי תבניות מודולריות, בשילוב עם התמרת לפלס, מתאימות לחיפוש שלנו אחר פונקציות עצמיות של התמרת פורייה. 

אך כיצד נוכל לבנות פונקציה בעלת השורשים המתאימים?
דרך אחת וישירה מאוד היא באמצעות כפל בפונקציה פשוטה המקבלת שורשים דומים, וזו הדרך בה הצליחה
#Viaz
להוכיח את קיומן של הפונקציות הנדרשות.

הפונקציה
$sin^2(pi abs(x)^2 \/ 2)$
מקבלת אפסים מסדר שני לכל
$x=sqrt(2k), k=1,2,...$.
כפי שראינו בתרשים
@fig:f0-and-f0-hat-plots
אלו הם כמעט האפסים בהם אנו מעוניינים, מלבד אפס לא רצוי מסדר רביעי עבור
$x=0$, 
והאפס עבור
$x=sqrt(2)$ 
שהינו מסדר שני ולא מסדר ראשון (או מסדר אי זוגי אחר). אבל אלו הן בעיות הניתנות (כמסתבר) לגישור.

אם ניקח את התמרת לפלס מהסעיף הקודם, נקבל תבנית שתוכל להתאים לשתי הפונקציות העצמיות אותן אנו מחפשים:

$ sin^2(pi abs(x)^2 \/ 2) integral_0^infinity e^(-t pi abs(x)^2) f(t) dif t $ <eign-fn-pattern>

נשים לב שעל מנת שנוכל להשתמש בתבנית זו, לא מספיק שרק נמצא פונקציות עצמיות: 
עלינו גם לפצות על השורשים הלא מתאימים וגם לוודא כי הפונקציה הסופית מקיימת את החסמים המתאימים מסעיף
@lin-bounds.

== תנאים לפונקציות עצמיות מתאימות

// Intro

נתחיל בחיפוש אחר הפונקציה העצמית בעלת הערך העצמי 1, כלומר, אם נניח כי יש לנו פונקציה:

$ a(x) = sin^2(pi abs(x)^2 \/ 2) integral_0^infinity e^(-t pi abs(x)^2) g_0(t) dif t $

// From g_0 to h_0(1/t) * t^2

אנחנו רוצים לדעת מתי
$hat(a) = a$.
בתור התחלה, נניח כי
$abs(x)>sqrt(2)$,
כי שם התנהגות הפונקציה צריכה להיות פשוטה יותר.

/*
// Note about the b(x) eigen func.

החיפוש אחר הפונקציה
$b$
עבורה
$hat(b) = -b$
דומה, וניגע בו בקצרה בסוף הסעיף, על מנת שנוכל להוכיח את קיום החסמים הנדרשים.
*/

חשוב לזכור, שאנחנו מחפשים תנאים _שאינם הכרחיים_. לא דרושים לנו כלים לאפיון _כל_ הפונקציות שיכולות לשמש להוכחת החסם, אלא דוגמה לפונקציה אחת כולשהי.
ננסה לבצע ניחושים מושכלים על מנת לצמצם את "איזור החיפוש", ונזכור באילו הנחות השתמשנו כדי להגיע לשם.

נתחיל בכך שננסה להתקרב לצורה של התמרת לפלס, כי ראינו שעבור צירוף פשוט מספיק של גאוסייאנים נוכל לקבל את התמרת פורייה של הפונקציה בקלות רבה יותר.

// About a(r) vs a(x)

נשים לב לנקודה טכנית שקשורה גם לסימון: 
כאשר ניסחנו את הטענות על התמרת פורייה 
בסעיפים הקודמים, עסקנו בפונקציות
$f(x) : RR^n -> RR$
וסימנו את התמרת פורייה שלהן ב-
$hat(f)(y)$,
אך בסעיף
@zeros-of-the-magic-function
ראינו כי נוכל להתמקד בחיפושנו אחר פונקציה רדיאלית המוגדרת עבור
$r in RR_(>=0)$.

אז נגדיר את
$a(r)$
בתור פונקציה של משתנה 
$r >= 0$.
כדי שנהיה אחידים בסימון,
בכל פעם שנרצה לדבר על התמרת פורייה שלה נתייחס אליה בתור
$a(x)$,
תוך החלפה של
$r^2$
בריבוע הנורמה של הווקטור
$x$.
כמובן, נהיה צריכים להצדיק הרחבה זו
מאוחר יותר, אבל לא יהיה בכך קושי רב.

כפי שראינו ב
@eqt:fourier-transform-of-laplace-transform,
אנו מעוניינים לקבל את הצורה הבאה עבור התמרת פורייה של הפונקציה שלנו:

$ a(x) -> integral_0^infinity e^(-pi abs(y)^2 t) t^2  f(1 \/ t) dif t $

אז אם נניח ש
$a$
הינה פונקציה עצמית (כלומר, 
$hat(a) = a$),
נוכל לטייב את ההגדרה שלה מעט אם נבחר 
$g_0(t) = h_0 (1\/t) t^2 $,
כלומר
$ a(r) = sin^2(pi r^2 \/ 2) integral_0^infinity e^(-pi r^2 t) t^2  h_0(1 \/ t) dif t $



#pagebreak()

// From integral 0->∞ to integral 0->i∞

מעבר מקדים נוסף אותו נוכל לעשות הוא לשנות את תחום האינטגרציה.
אנו רוצים לעבוד ב-
#hh,
חצי המישור העליון, על מנת שנוכל להשתמש בתוצאות השימושיות שהוכחנו עבור תבניות מודולריות.

#let phi0 = $phi.alt_0$

יתרה מכך, נוכל לפשט אף יותר אם נחפש פונקציה 
$phi0 : i RR -> i RR$.

נוכל לסמן

$ i phi0 (1/(i t)) = h_0(1/t) $

הבחירה היכן "למקם" את ה-
$i$-ים
היא מעט שרירותית, אבל היא תתאים מאוד לצעד הבא שלנו, כפי שתכף נראה.

נציב

$ a(r) = sin^2(pi r^2 \/ 2) integral_0^infinity e^(-pi r^2 t) t^2  i phi0(1 / (i t)) dif t $


וכדי לעבור לקטע האינטגרציה 
$(0, i infinity)$,
נבצע החלפת משתנים
$z= i t => t = -i z$
כדי לקבל

// Almost (37), but without the 4

$ a(r) &= sin^2(pi r^2 \/ 2) integral_0^(i infinity) (-i z)' e^(- pi r^2 (-i z)) i phi0(-1/z) (-i z)^2 dif z \
 &= sin^2(pi r^2 \/ 2) integral_0^(i infinity) -i e^(pi r^2 i z) i phi0(-1/z) (-1) z^2 dif z \
 &= - sin^2(pi r^2 \/ 2) integral_0^(i infinity) phi0(-1/z) z^2  e^(z pi i r^2) dif z 
$

// From sin² ∫ to ∫(e^2pi - e^-2pi) using sin ident

עד עכשיו, לא העמדנו דרישות נוספות על הפונקציה אותה אנו מחפשים (בהנחה והאינטגרל הרשום מוגדר היטב).

מה יקרה אם ננסה להתקרב אף יותר לצורה של התמרת לפלס?
כלומר, אנו רוצים ש
$e^(z pi i r^2)$
יהיה אחד מגורמי המכפלה בתוך האינטגרל, ולהימנע מגורמים מחוצה לו.

אם נתבסס על הזהות

$ sin^2((pi r^2) / 2) = -1/4 (e^(i pi r^2 \/ 2) - e^(-i pi r^2 \/ 2))^2
= -1/4 (e^(i pi r^2) - 2 + e^(-i pi r^2)) $

נוכל לקבל כי

$ a(r) = 1/4 integral_0^(i infinity) [ phi0(-1/z) z^2  e^((z+1) pi i r^2) - 2 phi0(-1/z) z^2  e^(z pi i r^2) + phi0(-1/z) z^2  e^((z-1) pi i r^2) ] dif z $

מכיוון שהגדרנו בצורה יחסית שרירותית את 
$a(r)$,
נוכל לכפול אותה בסקלר המתאים כדי לשמור על צורה זו של הפונקציה פשוטה יותר. כלומר, נגדיר:

$ a(r) := -4 sin^2(pi r^2 \/ 2) integral_0^(i infinity) phi0(-1/z) z^2  e^(pi i r^2 z) dif z  $ <a-for-r-gt-sqrt-2>

מעתה, לא נשנה יותר את
$a$,
ונתמקד בפונקציה הפנימית,
$phi0$.


#pagebreak()

נקבל, כפי שראינו מקודם

$ a(r) = integral_0^(i infinity) [ phi0(-1/z) z^2  e^(pi i r^2 (z+1)) - 2 phi0(-1/z) z^2  e^(pi i r^2 z) + phi0(-1/z) z^2  e^(pi i r^2 (z-1)) ] dif z $


הבעיה הבאה אותה נרצה לפתור היא החזקות
$z+1, z-1$
בגורמים
$e^(pi i r^2 (z plus.minus 1))$,
שכן הם "מפריעים" לנו להגיע להתמרת לפלס (ואיתה המעבר הפשוט להתמרת פורייה).

נוכל לבצע החלפת משתנים בכל אחד מהמחוברים, ולקבל:

$ 
// Fix the e^(z+1) by ~z= z+1 => z= ~z-1  
integral_0^(i infinity) phi0(-1/z) z^2  e^(pi i r^2 (z+1)) dif z = integral_(1)^(i infinity+1) phi0(-1/(z-1)) (z-1)^2  e^(pi i r^2 z) dif z \

// Fix the e^(z-1) by ~z= z-1 => z= ~z+1  
integral_0^(i infinity) phi0(-1/z) z^2  e^(pi i r^2 (z-1)) dif z = integral_(-1)^(i infinity-1) phi0(-1/(z+1)) (z+1)^2  e^(pi i r^2 z) dif z
$

כלומר

$

a(r) =  integral_(-1)^(i infinity-1) phi0(-1/(z+1)) (z+1)^2  e^(pi i r^2 z) dif z
      - 2 integral_0^(i infinity) phi0(-1/z) z^2  e^(pi i r^2 z) dif z \
      + integral_(1)^(i infinity+1) phi0(-1/(z-1)) (z-1)^2  e^(pi i r^2 z) dif z 

$ <a-as-sum-of-3-integrals>


אומנם לא קיבלנו ביטוי פשוט, אבל התקרבנו מאוד לצורה של התמרת לפלס, ועכשיו ננסה לנצלה.

נסתכל על הביטוי

$ integral_(i a)^(i b) phi0(-1/z) z^2 e^(pi i abs(x)^2 z) dif z , space a,b in [-infinity, infinity] $

אנו מחפשים פונקציה עצמית, ואנחנו יודעים שהתמרת פורייה המתאימה (אם נניח כי מתקיימים כל התנאים הדרושים לכך שנוכל לבצעה), תראה כך

$ integral_(i a)^(i b) phi0(-1/z) z^2 z^(-4) e^(pi i abs(y)^2 (-1/z)) dif z  $

דרך אחת לקרב את הביטוי השני לראשון היא באמצעות "תיקון" המקדם בחזקה.
נוכל לעשות זאת באמצעות החלפת משתנים
$w=-1/z$:

// w=-1/z => z=-1/w

$ 
integral_(i 1/a)^(i 1/b) phi0(w) (-1/w)^(-2) e^(pi i abs(y)^2 w) (-1/w)' dif w =
integral_(i 1/a)^(i 1/b) phi0(w) e^(pi i abs(y)^2 w) dif w
$

כאן, תבניות מודולריות יכולות לסייע לנו, אבל רק במידה מסויימת. 

גם אם נניח כי יש לנו דרך לעבור בין
$phi0(-1/z) z^2 <-> phi0(z)$,
שינוי תחום האינטגרציה מפריע לנו לחזור לאותה הפונקציה ממש.

אבל, ביחס לקטעים המופיעים ב-
@eqt:a-as-sum-of-3-integrals,
נוכל למשל לחלק את הקטע
$(0, i infinity)$
ל-
$(0, i)$
ו-
$(i, i infinity)$,
ונקבל כי כל אחד מהם הוא תמונת מראה של השני תחת התמרת פורייה וההחלפה שביצענו.


// First requirement: phi0 z^2 e^z -> 0 ("From (29) we deduce that ..", page 12).

אם כך, נדרוש כי עבור
$r>sqrt(2)$,
האינטגרנד יקיים
$phi0(-1/z) z^2  e^(pi i r^2 z) -> 0$
כאשר
$Im (z) -> infinity$,
ואז נוכל לשנות את מסלול האינטגרציה.

#pagebreak()

ננסה לאסוף יחד את כל האינטגרלים בקטעים המתאימים, תוך הימנעות מאינטגרציה על הציר הממשי (שבו לא נוכל להשתמש בתבניות מודולריות):

את האינטגרציה לאורך הקטעים
$(plus.minus 1, i infinity)$
נשנה להיות על הקטעים
$(plus.minus 1, i) -> (i, i infinity)$.

את האינטגרציה לאורך הקטע
$(0, i infinity)$
נשנה להיות על הקטעים
$(0, i) -> (i, i infinity)$.

בסך הכל, נקבל

$

a(r) &=  integral_(-1)^(i) phi0(-1/(z+1)) (z+1)^2  e^(pi i r^2 z) dif z 
            + integral_(i)^(i infinity) phi0(-1/(z+1)) (z+1)^2  e^(pi i r^2 z) dif z \
     & -2 integral_0^(i) phi0(-1/z) z^2  e^(pi i r^2 z) dif z 
            -2 integral_i^(i infinity) phi0(-1/z) z^2  e^(pi i r^2 z) dif z \
     & + integral_(1)^(i) phi0(-1/(z-1)) (z-1)^2  e^(pi i r^2 z) dif z 
            + integral_(i)^(i infinity) phi0(-1/(z-1)) (z-1)^2  e^(pi i r^2 z) dif z \

$

נאסוף יחד את האיטגרלים על הקטע
$(i, i infinity)$
ונקבל

$

a(r) &=  integral_(-1)^(i) phi0(-1/(z+1)) (z+1)^2  e^(pi i r^2 z) dif z \
     & -2 integral_0^(i) phi0(-1/z) z^2  e^(pi i r^2 z) dif z \
     & + integral_(1)^(i) phi0(-1/(z-1)) (z-1)^2  e^(pi i r^2 z) dif z \
     & + integral_(i)^(i infinity) [
       phi0(-1/(z+1)) (z+1)^2  e^(pi i r^2 z) -2 phi0(-1/z) z^2  e^(pi i r^2 z)  + phi0(-1/(z-1)) (z-1)^2  e^(pi i r^2 z)
     ] dif z

$ <a-as-sum-of-3-finite-integrals-and-one-i-to-inf-integral>

ראינו שישנה סימטריה מסוימת בין הקטעים
$(i, i infinity)$
ו
$(i, 0)$.
סימטריה דומה קיימת בין הקטעים
$(-1, i)$ ו- $(1,i)$.
שמתבררת כסימטריה מלאה בין האינטגרלים, תחת התמרת פורייה.

/// In the paper, "we exchange the contour integration w.r.t z var and Fourier trans. w.r.t to x in (35). This can be done since the corresponding double integral converges absolutely."

נסתכל על התמרת פורייה של האינטגרל בקטע
$(-1,i)$:

$
integral_(-1)^(i) phi0(-1/(z+1)) (z+1)^2  e^(pi i abs(x)^2 z) dif z -> integral_(-1)^(i) phi0(-1/(z+1)) (z+1)^2  z^(-4) e^(pi i abs(y)^2 (-1/z)) dif z
$

נבצע החלפת משתנים כמו מקודם,
$w=-1/z$,
ונקבל

// Taking the ∫-1..i and using w=-1/z to get ∫1..i
// w=-1/z => z=-1/w

$
integral_(-1)^(i) phi0(-1/(z+1)) (z+1)^2  z^(-4) e^(pi i abs(y)^2 (-1/z)) dif z = \

integral_(1)^(i) phi0(-1/((-1/w)+1)) (-1/w+1)^2 (-1/w)^(-4)  e^(pi i abs(y)^2 w) (-1/w)' dif w = \

// (-1/w)' = 1/w^2, (-1/w+1)^2 = (w-1/w)^2 = (w-1)^2 / w^2

integral_(1)^(i) phi0(-1 - 1/(w-1)) (w-1)^2 e^(pi i abs(y)^2 w) dif w
$

// In the original paper, where is a small error: phi0(1 - 1/(w-1)).

זהו כמעט האינטגרל בקטע
$(1,i)$
ב-
@eqt:a-as-sum-of-3-finite-integrals-and-one-i-to-inf-integral!
מספיק שנדרוש ש
$phi0$
תהיה 1-מחזורית (תכונה שכבר הוכחנו עבור תבניות מודולריות), ונקבל
$phi0(-1 - 1/(w-1)) = phi0(1 + -1 - 1/(w-1)) = phi0(- 1/(w-1))$.

#pagebreak()

נסכם זאת כך:
במשוואה שקיבלנו ב-
@eqt:a-as-sum-of-3-finite-integrals-and-one-i-to-inf-integral,
החלק המורכב מהאינטגרלים על הקטעים 
$(plus.minus 1, i)$
הוא למעשה פונקציה עצמית (תחת ההנחה ש
$phi0(z+1) = phi0(z)$
).

כלומר, כדי ש-
$a(r)$
כולה תהיה פונקציה עצמית, חייב להתקיים כי החלק השני של הפונקציה,
כלומר החלק המורכב מהקטעים
$(0, i)$ ו- $(i, i infinity)$
גם הוא פונקציה עצמית.

נתחיל מהביטוי הפשוט יותר, כלומר האינטגרל על הקטע
$(0,i)$.
התמרת פורייה שלו הינה

$ -2 integral_0^(i) phi0(-1/z) z^2  e^(pi i abs(x)^2 z) dif z -> -2  integral_0^(i) phi0(-1/z) z^2 z^(-4) e^(pi i abs(y)^2 (-1/z)) dif z $

נבצע שוב החלפת משתנים
$w=-1/z$,
ונקבל

$
-2 integral_0^(i) phi0(-1/z) z^2 z^(-4) e^(pi i abs(y)^2 (-1/z)) dif z = \

-2 integral_(i infinity)^(i) phi0(w) (-1/w)^(-2) e^(pi i abs(y)^2 w) (-1/w)' dif w = \

2 integral_(i)^(i infinity) phi0(w) e^(pi i abs(y)^2 w) dif w 
$

קיבלנו ביטוי קרוב אך לא זהה לפונקציה המקורית. אז איך נשלים את הביטוי כדי שכן תתקבל פונקציה עצמית?

למעשה, אנחנו יודעים לפחות על רכיב אחד שצריך להיות לתוצאה של התמרת פורייה: האינטגרל המקורי על הקטע
$(0,i)$!

כלומר, אנחנו מחפשים צירוף כזה:

$
-2 integral_0^(i) phi0(-1/z) z^2  e^(pi i abs(x)^2 z) dif z + ??? -> 2 integral_(i)^(i infinity) phi0(z) e^(pi i abs(y)^2 z) dif z  -2 integral_0^(i) phi0(-1/z) z^2  e^(pi i abs(y)^2 z) dif z
$

אבל מה יקרה אם נפעיל את התמרת פורייה על התוצאה? נקבל מיד:


$
2 integral_(i)^(i infinity) phi0(z) e^(pi i abs(y)^2 z) dif z  -2 integral_0^(i) phi0(-1/z) z^2  e^(pi i abs(y)^2 z) dif z -> -2 integral_0^(i) phi0(-1/z) z^2  e^(pi i abs(x)^2 z) dif z + 2 integral_(i)^(i infinity) phi0(z) e^(pi i abs(x)^2 z) dif z
$
אבל, בפיתוח שקיבלנו ב-
@eqt:a-as-sum-of-3-finite-integrals-and-one-i-to-inf-integral
יש לנו אינטגרל מתאים בקטע
$(i, i infinity)$,
ולכן אם

$
phi0(-1/(z+1)) (z+1)^2 -2 phi0(-1/z) z^2 + phi0(-1/(z-1)) (z-1)^2 = 2phi0(z)
$ <phi0-func-eq>

אז גם החלק השני של
$a(r)$
יהיה פונקציה עצמית, כלומר 
$a(r)$
כולה תהיה בדיוק הפונקציה העצמית אותה אנו מחפשים!

#pagebreak()

נסכם זאת כך: אם נמצא פונקציה 1-מחזורית שמקיימת את משוואה
@eqt:phi0-func-eq,
אז הגדרה
@eqt:a-for-r-gt-sqrt-2
אכן מובילה אותנו אל הפונקציה העצמית המבוקשת.

עלינו לעמוד בעוד מספר תנאים טכניים, כמו קיום והתכנסות בהחלט של האינטגרלים המבוקשים, ונעשה זאת מיד.

לפני כן, נענה על מגבלה אחרת.
כאשר הגדרנו את
@eqt:a-for-r-gt-sqrt-2,
התייחסנו אך ורק למקרה בו
$r>sqrt(2)$.

אבל תוך כדי הפיתוח, קיבלנו למעשה ביטוי שימושי יותר: אם נציב את
@eqt:phi0-func-eq
ב-
@eqt:a-as-sum-of-3-finite-integrals-and-one-i-to-inf-integral,
נקבל, לכל
$x in RR^8$:

// This is (35) in the paper.

#let a_for_x_in_r8 = $
integral_(-1)^(i) phi0(-1/(z+1)) (z+1)^2  e^(pi i abs(x)^2 z) dif z + integral_(1)^(i) phi0(-1/(z-1)) (z-1)^2  e^(pi i abs(x)^2 z) dif z \
     & -2 integral_0^(i) phi0(-1/z) z^2  e^(pi i abs(x)^2 z) dif z 
      + 2 integral_(i)^(i infinity) phi0(z)  e^(pi i abs(x)^2 z) dif z
$

$
a(x) = & #a_for_x_in_r8
$ <a-for-x-in-r8>

היתרון של הצורה הנ"ל של הפונקציה העצמית הוא כי תחת ההנחה כי
$phi0(z)=O(e^(-2pi i z))$
כאשר
$Im z -> infinity$,
האינטגרלים מתכנסים בהחלט ובמידה שווה, ולכן הביטוי אכן מוגדר לכל ווקטור.

נסכם:
עלינו למצוא פונקציה, אותה סימנו ב-
$phi0$,
כך ש:

1.#[
  $phi0$
  היא 1-מחזורית, כלומר
  $phi0(z)=phi0(z+1)$.
]

2.#[
  $phi0$
  מקיימת את
  @eqt:phi0-func-eq.
]

3.#[
  $phi0(z)=O(e^(-2pi i z))$
  כאשר
  $Im z -> infinity$,
  עבור ההתכנסות במ"ש ובהחלט של האינטגרלים.
]

4.#[
  $phi0(-1/z) z^2  e^(pi i r^2 z) -> 0$
  כאשר
  $Im (z) -> infinity$,
  כדי שנוכל לשנות את מסלול האינטגרציה.
]

אם נדרוש גם כי
$a(x)$
עצמה תהיה פונקציית שוורץ,
תנאים אלה יבטיחו שבאמצעות הגדרה
@eqt:a-for-x-in-r8
נקבל פונקציה עצמית.

אנו יודעים כי היא תקבל את האפסים הנדרשים כאשר 
$r>sqrt(2)$
בגלל
@eqt:a-for-r-gt-sqrt-2,
אבל יהיה עלינו לבדוק את האפס הנוסף כאשר
$r=sqrt(2)$.


בנוסף,
את התנאים האחרים של
@lin-bounds
נוכל להוכיח רק כאשר נמצא גם את הפונקציה העצמית השניה,
ובפרט נרצה לדעת את
את ערכה של
$a(r)$
ב-
$r=0$.

#pagebreak()

== פונקציה המקיימת את התנאים

// The building blocks for phi0, 23-24 in the paper.

בדומה לפונקציה
$j$
שהגדרנו ב-
@eqt:elliptic-j-invariant,
נגדיר שתי פונקציות עזר:

$

phi_(-2) := (-1728 E_4 E_6) / (E_4^3 - E_6^2) \
phi_(-4) := (1728 E_4^2) / (E_4^3 - E_6^2) \

$

אלו פונקציות להן התכונות

$

phi_(-2)(-1 \/ z) = 
(-1728 E_4(-1 \/ z) E_6(-1 \/ z)) / (E_4^3(-1 \/ z) - E_6^2(-1 \/ z)) = 
(-1728 z^4 E_4(z) z^6 E_6(z)) / (z^12 E_4^3(z) - z^12 E_6^2(z)) = z^(-2) phi_(-2)(z) \

phi_(-4)(-1 \/ z) = z^(-4) phi_(-4)(z)

$

(וכמובן ששתיהן 1-מחזוריות)

אלו הן "אבני בניין" בהן נוכל להשתמש בכל פעם שנרצה להיפטר מחזקות לא רצויות של
$z$.

// The explicit def of phi0, 23-38 in the paper.

באמצעות פונקציות אלו, נגדיר

$

phi.alt_(-4) := phi_(-4) \
phi.alt_(-2) := phi_(-4) E_2 + phi_(-2) \

phi0 := phi_(-4) E_2^2 + 2phi_(-2) E_2 + j - 1728

$

ונוכיח כי
$phi0$
מקיימת את כל התכונות הדרושות לנו.

כדי להוכיח כי הזהות
@eqt:phi0-func-eq
מתקיימת, מספיק שנשים לב כי

// This is (29) in the paper.

$

phi0(-1 / z) = phi0(z) - (12i) / pi dot 1 / z phi.alt_(-2)(z) - 36 / (pi^2) 1 / (z^2) phi.alt_(-4) (z)

$ <phi0-one-over-z-tranform>

כדי להראות זאת,
נשתמש בתכונה של
$E_2$
שקיבלנו ב-
@eqt:eisen-2,
ונציב:

$ 
phi0(-1 / z) &= phi_(-4) (-1 / z) (E_2(-1 / z))^2 + 2phi_(-2) (-1 / z) E_2(-1 / z) + j(-1 / z) - 1728 \
             &= z^(-4) phi_(-4) (z^2 E_2 (z) - 6i z \/ pi)^2 + 2z^(-2) phi_(-2) (z^2 E_2 (z) - 6i z \/ pi) + j - 1728 \
             &= z^(-4) phi_(-4) (z^4 E_2^2 - 12 i z^3E_2 \/ pi - 36 z^2 \/ pi^2) + 2phi_(-2)E_2-((12i)/(pi) dot 1/z) phi_(-2) +j -1728 \
             &= phi_(-4) E_2^2 -(12 i) / (pi z) phi_(-4)E_2 - 36 / (pi^2 z^2) phi_(-4) +  2phi_(-2)E_2-((12i)/(pi) dot 1/z) phi_(-2) +j -1728 \
             &= phi0 (z) -(12 i) / (pi z) phi_(-4)E_2 - 36 / (pi^2 z^2) phi_(-4) -((12i)/(pi) dot 1/z) phi_(-2) \
             &= phi0 (z) - 36 / (pi^2 z^2) phi.alt_(-4)(z) - (12 i) / (pi z) (phi_(-4) E_2 + phi_(-2) ) \
             &= phi0 (z) - 36 / (pi^2 z^2) phi.alt_(-4)(z)  - (12 i) / (pi z) phi.alt_(-2) (z)
               
$

#pagebreak()

עתה, נוכל להציב את
@eqt:phi0-one-over-z-tranform
ב-
@eqt:phi0-func-eq
ולקבל

$

phi0(-1/(z+1)) (z+1)^2 -2 phi0(-1/z) z^2 + phi0(-1/(z-1)) (z-1)^2 &= \

phi0(z + 1)(z + 1)^2 - 2 phi0(z) z^2 + phi0(z - 1)(z - 1)^2 \
- (12i) / pi [phi.alt_(-2)(z + 1)(z + 1) - 2 phi.alt_(-2)(z) z + phi.alt_(-2)(z - 1)(z - 1)] \
- 36 / pi^2 [phi.alt_(-4)(z + 1) - 2 phi.alt_(-4)(z) + phi.alt_(-4)(z - 1)] 
&= 2 phi0(z)

$

כנדרש.

הראנו כי משוואה
@eqt:phi0-func-eq
מתקיימת, וכל שנותר לנו הוא להראות כי שאר התנאים הנדרשים מתקיימים גם הם, והדרך הפשוטה ביותר לעשות זאת היא באמצעות פיתוח פורייה.

=== פיתוח פורייה של $phi0$ #rtl-mark

מכיוון שיש בידנו את נוסחה
@eqt:e-k-fourier-exp,
נוכל לחשב כל מקדם של פיתוח פורייה שנרצה לכל אחת מהפונקציות שהגדרנו.

נבחן את האיברים הראשונים של כל פיתוח, משום שהם יהיו החשובים ביותר לתכונות הראשונות אותן נרצה להוכיח.

נתחיל עם
$phi.alt_(-4)$.
ראינו כבר את פיתוחי פורייה של המכנה ושל המונה
ב-
@eqt:ek-powers-fourier,
ולכן

// Maybe note that this is because 1/(1-x)=Σx^n 
// https://math.stackexchange.com/questions/33140/j-invariant-fourier-expansion
$ 

phi.alt_(-4) &= (1 + 480q + ...) / (q - 24q^2 + 252q^3 + ...) 
             &= (1 + 480q + ...) (q^(-1) + 24 - 324q + ...) #h(3em) \ 
             &= q^(-1) + 504 + ...
$


עבור
$phi.alt_(-2)$,
מכיוון ש-
$
phi_(-2) &= -q^(-1) + 240 + 141444q + ... #h(18em)
$

אז נוכל להשתמש ב-
@eqt:e2-and-e6-fourier
ולחשב כי

$

phi.alt_(-2) &= (q^(-1) + 504 + ...) (1 - 24q - 72q^2 - ...) + -q^(-1) + 240 + 141444q + ... \
             &= 720 + 203040q + ....

$

ולבסוף נוכל להשתמש גם בפיתוח פרוייה של
$j$
שראינו ב-
@eqt:j-foureir
ולקבל כי

$
// E_2^2 = 1 - 48q + 432q^2 + ...
phi0 = &(q^(-1) + 504 + ...)(1 - 24q - 72q^2 - ...)^2 \
       &+ 2(-q^(-1) + 240 + ...)(1 - 24q - 72q^2 - ...) \
       &+ (q^(-1) + 774 + ...) \
       &-1728 \
      
     = &q^(-1) -2(q^-1) + q^(-1) + 504 - 48 + 2(240 + 24) + 744 - 1728 + ... \
$

נשים לב כי הגורם
$q^(-1)$
מתאפס, וכך גם הגורם הקבוע!


את החישוב המלא נוכל להשאיר שוב לכלי אוטומאטי. בסך הכל, נקבל את פיתוחי פורייה הבאים:

$

phi.alt_(-4)(z) &= q^(-1) + 504 + 73764 q + 2695040 q^2 + 54755730 q^3 + O(q^4) \
phi.alt_(-2)(z) &= 720 + 203040 q + 9417600 q^2 + 223473600 q^3 + 3566782080 q^4 + O(q^5) \
phi0(z) &= 518400 q + 31104000 q^2 + 870912000 q^3 + 15697152000 q^4 + O(q^5) \

$ <phi0-fourier>

#pagebreak()


=== בדיקה כי $a(x)$ היא פונקציית שוורץ

נזכיר כי לאורך הפיתוח, הגענו להגדרה
@eqt:a-for-x-in-r8:

$ a(x) :=& #a_for_x_in_r8 $

מפיתוח פורייה שראינו, נסיק כי
$phi0(z) = O(e^(-2 pi i z))$
כאשר
$Im(z) -> infinity$,
ולכן האינטגרלים מתכנסים בהחלט ובמידה שווה והפונקציה 
$a(x)$
מוגדרת לכל
$x in RR^8$.
קל גם לראות ש-
$phi0(-1/z) z^2  e^(pi i r^2 z) -> 0$
כאשר
$Im (z) -> infinity$,
ולכן נוכל לשנות את מסלול האינטגרציה כפי שעשינו במהלך הפיתוח.

אז
$phi0$
עונה על כל הדרישות לקבלת פונקציה עצמית,
ונותר לנו לוודא כי
$a(x)$
הינה פונקציית שוורץ.

כפי שהזכרנו בפרק
@modular-forms,
לא רק שניתן לחשב את המקדמים של פיתוח פורייה של תבניות מודולריות, אפשר גם למצוא חסמים אסימפטוטיים עבורם.
נשתמש בכך על מנת להעריך את המחובר הראשון.

ראשית, המקדמים של פיתוח פורייה של
$phi0$
מקיימים

$ c_(phi0)(0) = 0, |c_(phi0)(n)| <= 2 e^(4 pi sqrt(n)) $

אז בדומה להערכה שקיבלנו ב-
@eqt:e-k-estimation,
עם התאמה קלה כי
$c_(phi0)(0) = 0$,
נקבל כי ישנו קבוע
$C$
כך שלכל
$Im(z) > 1/2$,

$ |phi0(z)| <= C  e^(-2 pi Im(z)) $

נשתמש בכך כדי לקבל את ההערכה הבאה כאשר
$r>=0$:

$ abs(integral_(-1)^i phi0(-1 / (z + 1))(z + 1)^2 e^(pi i r^2 z) dif z) = abs(integral_(i infinity)^(-1\/(i+1)) phi0(z) z^(-4) e^(pi i r^2 (-1 \/ z - 1)) dif z) <= \
C_1 integral_(1/2)^infinity e^(-2 pi t) e^(-pi r^2 \/ t) dif t <= C_1 integral_(0)^infinity e^(-2 pi t) e^(-pi r^2 \/ t) dif t
$

את האינטגרל האחרון ניתן להעריך באמצעות _פונקציית בסל מותאמת מהסוג השני_ 
(_modified Bessel function of the second kind_)
המסומנת ב-
$K_alpha (x)$.
// Proposition 5.15 in "An Introduction to Modular Forms", p40.
נסתפק בכך שנציין כי
$K_alpha (x)$
היא פתרון למשוואה דיפרנציאלית מסוג מסויים, וכי היא דועכת בצורה אקספוננציאלית 
(כאשר
$x -> infinity$,
אז
$K_alpha (x) ∼ (pi \/ (2x))^(1\/2)e^(−x)$).

ההערכה המתקבלת הינה

$ C_1 integral_(0)^infinity e^(-2 pi t) e^(-pi r^2 \/ t) dif t <= C_2 r K_1(2sqrt(2) pi r) $

באופן דומה ניתן להעריך גם את המחוברים השני והשלישי.

את המחובר האחרון נעריך כך:

$ abs(integral_i^infinity phi0(z) e^(pi i r^2 z) dif z) <= C integral_1^infinity e^(-2 pi t) e^(-pi r^2 t) dif t = 
C_3 e^(-pi (r^2 + 2)) / (r^2 + 2)
 $

ובסך הכל, נקבל כי

$ abs(a(x)) <= 4 C_2 r K_1(2sqrt(2) pi r) + 2 C_3 e^(-pi (r^2 + 2)) / (r^2 + 2) $

נסיק כי
$a(x)$
דועכת מהר יותר מכל פולינום. הערכות דומות ניתן לקבל גם לכל נגזרת שלה,
ולכן היא פונקציית שוורץ.

#pagebreak()

== מציאת ערכי הפונקציה על הסריג ובראשית

// Finding a(0) and a(sqrt(2)) using approx.

מכיוון שאנו יודעים ש-
$a(x)$
מקבלת את הצורה
@eqt:a-for-r-gt-sqrt-2
כאשר
$x > sqrt(2)$,
נסיק כי שם היא אכן מתאפסת על הסריג, כפי שרצינו.
נותר לנו למצוא את ערכיה של
$a(r)$
עבור
$r=0$
ו-
$r=sqrt(2)$.

כדי לעשות זאת, נציג את
$a$
בצורה שלישית, שתהיה נוחה לשם כך.

// This is Prop 3 (38) in the paper.

$

a(r) = 4i sin^2(pi r^2 \/ 2)  (&
    36 / (pi^3 (r^2 - 2)) - 8640 / (pi^3 r^4) + 18144 / (pi^3 r^2) \
    &+ integral_0^infinity (t^2 phi0(i / t) - 36 / (pi^2 e^(2 pi t)) + 8640 / (pi t) - 18144 / pi^2) e^(-pi r^2 t) dif t
)

$ <a-for-r-gt-0-using-approx>

הצגה זו מוצדקת, שכן אם נתחיל מ-
@eqt:a-for-r-gt-sqrt-2
ונבצע את ההחלפה
$t=z \/ i$,
נקבל

$ 
a(r) = 4 i sin^2(pi r^2 \/ 2) integral_0^infinity phi0(i/t) t^2  e^(-pi r^2 t) dif t
$ <a-for-r-gt-0-integral-over-reals>

נוכל להשתמש ב
@eqt:phi0-one-over-z-tranform
כדי לקבל

$ phi0(i/t) t^2 &= phi0(i t) t^2  - (12i) / pi dot t^2 / (i t) phi.alt_(-2)(i t) - 36 / (pi^2) t^2 / ((i t)^2) phi.alt_(-4) (i t) \
 &= phi0(i t) t^2  - (12t) / pi phi.alt_(-2)(i t) + 36 / (pi^2) phi.alt_(-4) (i t) $

בזכות פיתוחי פורייה שראינו ב-
@eqt:phi0-fourier
נוכל להסיק כי כאשר
$t -> infinity$,
מתקיים כי
$phi0(i t) t^2 = O(t^2 e^(-2 pi t))$.

עבור שתי הפונקציות האחרות, נקבל כי כאשר
$t -> infinity$
הן מקיימות

$

phi.alt_(-4)(i t) &= e^(2 pi t) + 504 + O(e^(-2 pi t)) \
phi.alt_(-2)(i t) &= 720 + O(e^(-2 pi t))

$

נסיק כי

$

phi0(i/t) t^2 &=  - (12t) / pi dot 720 + 36 / (pi^2) (e^(2 pi t) + 504) + O(t^2 e^(-2 pi t)) \
              &= 36 / (pi^2) e^(2 pi t) - 8640 / pi t + 18144 / pi^2 + O(t^2 e^(-2 pi t))

$ <phi0-estimate-for-approx>

אבל, עבור
$r > sqrt(2)$
נוכל לחשב

$

integral_0^infinity (36 / (pi^2) e^(2 pi t) - 8640 / pi t + 18144 / pi^2) dif t = 36 / (pi^3 (r^2 - 2)) - 8640 / (pi^3 r^4) + 18144 / (pi^3 r^2)

$

ולכן
@eqt:a-for-r-gt-0-using-approx
מתקיימת עבור
$r > sqrt(2)$.

נשים לב כי ההערכה שמצאנו עבור
$phi0(i\/t) t^2$
מראה כי הצד הימני של משוואה
@eqt:a-for-r-gt-0-using-approx
הינו פונקציה אנליטית בסביבה כולשהי ב-
$[0, infinity)$.
אבל, נוכל להסיק מ-
@eqt:a-for-x-in-r8
שגם
$a(r)$
שהגדרנו ב-
@eqt:a-for-r-gt-0-integral-over-reals
אנליטית בסביבה כולשהי ב
$[0, infinity)$,
כלומר
@eqt:a-for-r-gt-0-using-approx
מתקיימת בכל
$[0, infinity)$.

נשתמש בה על מנת למצוא את הערכים המבוקשים.

#pagebreak()

נשיב לב כי באמצעות ההערכה שמצאנו ב-
@eqt:phi0-estimate-for-approx,
נקבל כי האינטגרל שהגדרנו מקיים

$

abs(
  integral_0^infinity (t^2 phi0(i / t) - 36 / (pi^2 e^(2 pi t)) + 8640 / (pi t) - 18144 / pi^2) e^(-pi r^2 t) dif t 
) <= integral_0^infinity abs(
  C t^2 e^(-2 pi t) e^(-pi r^2 t)
) dif t <= C_1 integral_0^infinity t^2 e^(-(2+r^2) pi t)  dif t

$

ולכן הוא מקבל ערך סופי. נסיק מכך כי כאשר הסינוס אפס, גם המכפלה שלהם אפסה.

אז עבור
$r=0$,
מספיק שנחשב את הגבול

$
a(0) &= lim_(r->0) 4i sin^2(pi r^2 \/ 2)  (36 / (pi^3 (r^2 - 2)) - 8640 / (pi^3 r^4) + 18144 / (pi^3 r^2)) \
& = lim_(r->0) -4i pi^2 r^4 \/ 4 dot 8640 / (pi^3 r^4) \
& = (-i 8640) / pi
$

באופן דומה, עבור
$r=sqrt(2)$
נקבל

$
a(sqrt(2)) &= lim_(r->sqrt(2)) 4i sin^2(pi r^2 \/ 2)  (36 / (pi^3 (r^2 - 2)) - 8640 / (pi^3 r^4) + 18144 / (pi^3 r^2)) \
& = lim_(r->sqrt(2)) -4i pi^2 (r^2 - 2)^2 \/ 4 dot 36 / (pi^3 (r^2 - 2)) \
& = 0
$

#pagebreak()

== הפונקציה העצמית הנוספת

עדיין דרושה לנו פונקציה המקיימת
$b(x) = -hat(b)(x)$.

באופן דומה לפיתוח של
$a(x)$,
נשתמש בפונקציות שהגדרנו ב-
@eqt:theta-z-funcs,
ונסמן

#let psiI = $psi_I$
#let psiT = $psi_T$
#let psiS = $psi_S$

$

// This is the form used in the Cohn paper (before 7.2),
// except they have -32 (but we place the -4 in the b-for-r func).

psiI := 128 (theta_00^4 + theta_01^4) / theta_10^8 + 128 (theta_01^4 - theta_10^4) / theta_00^8 \

// Original psi_T and psi_S from the paper.
// psiT = 128 (theta_00^4 + theta_01^4) / theta_10^8 + 128 (theta_00^4 + theta_10^4) / theta_01^8 \
// psiS = -128 (theta_00^4 + theta_10^4) / theta_01^8 - 128 (theta_10^4 - theta_01^4) / theta_00^8 \

$

באמצעות התכונות של פונקציות תטא שהוכחנו, נציב ונסמן:

$

psiT(z) &:= psiI(z+1) = 128 (theta_01^4 + theta_00^4) / theta_10^8 + 128 (theta_00^4 + theta_10^4) / theta_01^8 = psiI(z-1)\

psiS(z) &:= z^2 psiI(-1 \/ z) = 128 (- theta_00^4 - theta_10^4) / theta_01^8 + 128 (- theta_10^4 + theta_01^4) / theta_00^8 
$ <psi-func-eqs-1>

בפרט, מתקיים כי:

// In the Cohn paper, they say that $psi(z) = psi(z+1) + z^2 psi(-1/z)$, which is the "key" to the -1 eigen function, but I'm note sure we used everything here.
$
psiI(z) =  psiI(z+1) + z^2 psiI(-1 \/ z) \
psiT(z) + psiS(z) = psiI(z)
$ <psi-func-eqs-2>

באמצעותן, נגדיר את 

$ b(r) := -4 sin^2(pi r^2 \/ 2) integral_0^(i infinity) psiI(z) e^(pi i r^2 z) dif z  $ <b-for-r-gt-sqrt-2>

לכל $r>sqrt(2)$.

גם כאן, קיימות ההרחבות הנדרשות ל-
$b(x)$
לכל
$x in RR^8$,
והצגה המאפשרת לחשב ערכים של הפונקציה בנוחות.

נסתפק בכך שנראה כי
$b(x)$
היא אכן הפונקציה העצמית הנדרשת.
בדומה לשיטה בה השתמשנו בתחילת הסעיף, נשתמש בהגדרת הסינוס והחלפת משתנים על מנת לקבל

$

b(r) = integral_(-1)^(i infinity - 1) psiI(z+1) e^(pi i r^2 z) dif z - 2 integral_0^(i infinity) psiI(z) e^(pi i r^2 z) dif z + integral_(1)^(i infinity + 1) psiI(z-1) e^(pi i r^2 z) dif z

$

פיתוחי פורייה של
$psiI$, $psiT$
ו- $psiS$
הינם

$ 
psiI(z) &= q^(-1) + 144 - 5120 q^(1\/2) + 70524 q - 626688 q^(3\/2) + 4265600 q^2 + O(q^(5\/2))
\
psiT(z) &= q^(-1) + 144 + 5120 q^(1\/2) + 70524 q + 626688 q^(3\/2) + 4265600 q^2 + O(q^(5\/2))
\
psiS(z) &= -10240 q^(1\/2) - 1253376 q^(3\/2) - 48328704 q^(5\/2) - 1059078144 q^(7\/2) + O(q^(9\/2))
$ <psi-i-fourier>

ובפרט
$psiI(z) = e^(-2 pi i z) + O(1)$
כאשר
$Im(z) -> infinity$.
אז נוכל לשנות את מסלול האינטגרציה, ובאמצעות
@eqt:psi-func-eqs-1
נקבל

#let gsdz=$e^(pi i r^2 z) dif z$

$
integral_(-1)^(i infinity - 1) psiI(z+1) gsdz &= integral_(-1)^i psiT(z) gsdz + integral_(i)^(i infinity) psiT(z) gsdz \
integral_(1)^(i infinity + 1) psiI(z-1) gsdz &= integral_(1)^(i) psiT(z) gsdz + integral_(i)^(i infinity) psiT(z) gsdz \
integral_0^(i infinity) psiI(z) gsdz &= integral_0^(i) psiI(z) gsdz + integral_i^(i infinity) psiI(z) gsdz
$

#pagebreak()

נאסוף אותם ונקבל

// (56) in the paper.

$

b(r) =& integral_(-1)^i psiT(z) gsdz + integral_(1)^(i) psiT(z) gsdz + \
 &2 integral_(i)^(i infinity) psiT(z) gsdz - 2 integral_0^(i) psiI(z) gsdz -2 integral_i^(i infinity) psiI(z) gsdz \
$

כלומר

$
b(r) =& integral_(-1)^i psiT(z) gsdz + integral_(1)^(i) psiT(z) gsdz -2 integral_0^(i) psiI(z) gsdz + 2 integral_i^(i infinity) (psiT(z) - psiI(z)) gsdz
$

מ-
@eqt:psi-func-eqs-2
נובע כי

$
b(r) &= integral_(-1)^i psiT(z) gsdz + integral_(1)^(i) psiT(z) gsdz -2 integral_0^(i) psiI(z) gsdz - 2 integral_i^(i infinity) psiS(z) gsdz
$

נוכל להפעיל את התמרת פורייה ולקבל

$
#let difz=$z^(-4) e^(pi i abs(x)^2 (-1 / z)) dif z$
hat(b)(x) = &integral_(-1)^i psiT(z) difz + integral_(1)^(i) psiT(z) difz \ 
            &-2 integral_0^(i) psiI(z) difz - 2 integral_i^(i infinity) psiS(z) difz
$

נבצע החלפת משתנים
$w=-1/z$:

$
#let difw=$w^2 e^(pi i abs(x)^2 w) dif w$
hat(b)(x) = &integral_(i)^1 psiT(-1/w) difw + integral_(-1)^(i) psiT(-1/w) difw \ 
            &-2 integral_(i infinity)^(i) psiI(-1/w) difw - 2 integral_i^(0) psiS(-1/w) difw
$

וכל שנותר הוא להשתמש ב-
@eqt:psi-func-eqs-1:


#let gsxdz=$e^(pi i abs(x)^2 z) dif z$

$

hat(b)(x) = &integral_(i)^1 -psiT(z) gsxdz  + integral_(-1)^(i) -psiT(z) gsxdz \ 
            &2 integral_(i)^(i infinity) psiS(z) gsxdz + 2 integral_0^(i) psiI(z) gsxdz
$

כלומר

$ b(x) = -hat(b)(x) $

כפי שרצינו.

עבור
$b$
נוכל להשתמש בהצגה הבאה

$ 
b(r) = 4i sin^2(pi r^2 \/ 2) ( 144 / (pi r^2) + 1 / (pi (r^2 - 2)) + integral_(0)^infinity (psiI(i t) - 144 - e^(2 pi t)) e^(-pi r^2 t) dif t )
$

על מנת לקבל את הערכים הבאים בנקודות החשובות לנו:

// Prop 8 (61) in the paper.

$ b(0) = 0, b(sqrt(2)) = 0 $

#pagebreak()

== בדיקת החסמים המתאימים <proof-g-satisfies-lin-bounds>

נגדיר את

$ g(x) := (pi i) / 8640 a(x) + i / (240 pi) b(x) $

ונוכיח כי היא פונקציית הקסם הדרושה לנו, ומקיימת כל הדרישות של
@lin-bounds.

/*
1. $f(0) = hat(f)(0) > 0$
2. $hat(f)(y) >= 0$ לכל $y in RR^n$
3. $f(x) <= 0$ לכל $|x| >= r$
*/

נתחיל בהוכחת הדרישה השלישית, קרי ש
$g(x) <= 0$
לכל
$abs(x) > sqrt(2)$
(אנו יודעים כי
$abs(x) = sqrt(2) => g(x) = 0$).

אנו יודעים כי במקרה זה, נוכל להציג את הפונקציה כך

$
g(r) = pi / 2160 sin^2(pi r^2 \/ 2) integral_0^(infinity) A(t) e^(- pi r^2 t) dif t \

A(t) = -t^2 phi0(i \/ t) - 36/pi^2 psiI(i t) \
$

אם נראה ש-
$A(t) < 0$
בקטע האינטגרציה, נוכל להסיק כי 
$g$
אינה מקבלת ערכים חיוביים לכל
$r>sqrt(2)$.

נשתמש בשתי הצגות שונות של
$A(t)$,
אשר יאפשרו לנו להעריך אותה בדיוק מספיק בקטעים
$(0,1]$ ו-
$[1, infinity)$
בהתאמה:

$

A(t) &= -t^2 phi0(i \/ t) + 36/pi^2 t^2 psiS(i \/ t) \

A(t) &= -t^2  phi0(i t) - t (12i) / pi phi.alt_(-2)(i t) - 36 / (pi^2) phi.alt_(-4) (i t) - 36/pi^2 psiI(i t)

$

#let A0 = $A_0^((n))$
#let A0m = $A_0^((m))$
#let A06 = $A_0^((6))$
#let Ainf = $A_infinity^((n))$
#let Ainfm = $A_infinity^((m))$
#let Ainf6 = $A_infinity^((6))$

כאשר
$t -> 0$,
נסמן:
$ A(t) = A0(t) + O(t^2 e^(- pi n \/ t)) $
כלומר,
$A0(t)$
היא פונקציה המקרבת את 
$A(t)$
בסביבת 0, עד כדי גורם
$t^2 e^(- pi n \/ t)$.

באופן דומה, כאשר
$t -> infinity$
נסמן:
$ A(t) = Ainf(t) + O(t^2 e^(- pi n t)) $


כפי שהזכרנו בפרק
@modular-forms,
נוכל למצוא חסמים אסימפטוטיים על המקדמים בפיתוח פורייה של תבניות מודלריות הולומרפיות בצורה חלשה.
בפרט, המקדם ה
$n$-י
בפיתוח פורייה של
$psiI$,
שאותו נסמן
$c_(psiI)(n)$,
מקיים:

$ |c_(psiI)(n)| <= e^(4 pi sqrt(n)) &space.quad n in 1/2 ZZ_(>0) $

באופן דומה, ישנם חסמים עבור המקדמים של כל אחת מהפונקציות
$psiS, phi0, phi.alt_(-2), phi.alt_(-4)$:

$ 
|c_(psiS)(n)| <= 2e^(4 pi sqrt(n)) &space.quad n in 1/2 ZZ_(>0) \
|c_(phi0)(n)| <= 2e^(4 pi sqrt(n)) &space.quad n in ZZ_(>0) \
|c_(phi.alt_(-2))(n)| <= e^(4 pi sqrt(n)) &space.quad n in ZZ_(>0) \
|c_(phi.alt_(-4))(n)| <= e^(4 pi sqrt(n)) &space.quad n in ZZ_(>0) \
$

#pagebreak()

נוכל להשתמש בחסמים אלו על מנת לחסום את השגיאה שנקבל אם נשתמש בהערכות
$A0$ ו- $Ainf$:

#let R0(m) = $(t^2 + 36/pi^2) sum_(n=#m)^infinity 2 e^(2 sqrt(2) pi sqrt(n)) e^ (-pi n \/ t)$
#let Rinf(m) = $(t^2 + 12/pi t + 36/pi^2) sum_(n=#m)^infinity 2 e^(2 sqrt(2) pi sqrt(n)) e^ (-pi n t)$
$

abs( A(t) - A0m(t) ) &<= R0(m) \
abs( A(t) - Ainfm(t) ) &<= Rinf(m)
$

באמצעות פיתוחי פורייה שקיבלנו 
ב- @eqt:phi0-fourier
ו- @eqt:psi-i-fourier,
נוכל לחשב את
$A06$
ו-
$Ainf6$.
עבור 
$A06$
נקבל:
#let A06Expansion = $&t^2 (- (368640) / (pi^2) e^(-pi \/ t) - 518400 e^(-2 pi \/ t) - (45121536) / (pi^2) e^(-3 pi \/ t) - 31104000 e^(-4 pi \/ t) - (1739833344) / (pi^2) e^(-5 pi \/ t))$

#let Ainf6Expanson = $
&- (72) / (pi^2) e^(2 pi t) - (23328) / (pi^2) + \
&(184320) / (pi^2) e^(-pi t) - (5194368) / (pi^2) e^(-2 pi t) + (22560768) / (pi^2) e^(-3 pi t) - (250583040) / (pi^2) e^(-4 pi t) + (869916672) / (pi^2) e^(-5 pi t) \ &+ 
t ((8640) / (pi) + (2436480) / (pi) e^(-2 pi t) + (113011200) / (pi) e^(-4 pi t)) \
&-t^2 (518400 e^(-2 pi t) + 31104000 e^(-4 pi t))
$

$
A06(t) = #A06Expansion \
// Ainf6(t) = #Ainf6Expanson
$

הפיתוח של
$Ainf6$
מתקבל בדרך דומה אך ארוך אף יותר ולא נביאו כאן.


קל לראות שלכל
$t in (0,1]$,
מתקיים
$A06(t) < 0$.

בנוסף, בקטע זה ניתן לחשב כי

$ abs( A(t) - A06(t) ) &<= abs(R0(6)) &<= abs(A06(t)) $

באופן דומה, גם עבור
$Ainf6$
מתקיים לכל
$t in [1,infinity)$
כי
$Ainf6(t) < 0$ וכן ש-
$ 
// Less obvious. 
abs( A(t) - Ainf6(t) ) <= abs(Rinf(6)) <= abs(Ainf6(t)) 
$

כלומר,
$A(t) < 0$
כאשר
$t in (0,infinity)$.
לכן, הדרישה השלישית מתקיימת, כפי שרצינו להוכיח.

עבור התמרת פורייה של
$g$,
המקבלת את הצורה

$
hat(g)(r) = pi / 2160 sin^2(pi r^2 \/ 2) integral_0^(infinity) B(t) e^(- pi r^2 t) dif t \

B(t) = -t^2 phi0(i \/ t) + 36/pi^2 psiI(i t) \
$
הערכות דומות מאפשרות להראות כי 
$B(t) > 0$
כאשר
$t in (0,infinity)$,
ולכן הדרישה השניה, קרי
$hat(f)(y) >= 0$ לכל $y in RR^n$,
מתקיימת גם היא.

לבסוף, מכיוון ש
$a(0) = (-i 8640) / pi$
ו-
$b(0) = 0$,
נקבל גם כי
$g(0) = hat(g)(0) = 1 > 0$.

בכך, הראנו כי
$g(x)$
היא פונקציית הקסם הדרושה,
ועל כן הצפיפות המירבית ב-
$RR^8$
הינה
$ vol(B_(sqrt(2) \/ 2)^8) = pi^4 / 384 = 0.2538 ... $

מכיוון שזו הצפיפות שקיבלנו עבור
$E_8$
ב-
@eqt:e8-packing-density,
הוכחנו כי היא אכן אריזה בעלת הצפיפות הגבוהה ביותר האפשרית במימד זה.

#pagebreak()

= ביבליוגרפיה

ההגדרות והתוצאות על פונקציות שוורץ וההוכחה של סכימת פואסון מבוססות על
@stein2011fourier.

ההוכחה של פונקציית הקסם מבוססת כמובן על 
@Viazovska_2017,
וכן על 
@Cohn_2017,
שעליו בנויות גם ההגדרות וההוכחות על סריגים, וההוכחה המרכזית על החסמים לצפיפות אריזות.

ההגדרות הבסיסיות של תבניות מודולריות וכן ההערכה של $K_alpha$ נלקחו מ-
@cohen2018introduction,
והפיתוח של
$E_k$
ושאר התבניות המודולריות מבוסס על
@zagier2008,
כמו גם פיתוח הבסיס ל-
$Lambda_8$.

הוכחת הדואליות של
$E_8$
מבוססת על
@ben2022unimodularselfdual.

#[
  #set text(font: "Linux Libertine", lang: "en")
  #bibliography("works.bib", title: none, style: "springer-basic")
]

